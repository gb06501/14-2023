

Running test1 (global 1/5)...

2023-05-11 20:47:35 (1683838055) test started

2023-05-11 20:47:35 (1683838055) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/2, repeat=1/1, global 1/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683838057.log
Error: database "ais_data" already exists

create_postgres_tables

2023-05-11 20:47:42 (1683838062) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/2, repeat=1/1, global 1/5) in 7.530 seconds



2023-05-11 20:47:42 (1683838062) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/2, repeat=1/1, global 1/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683838072.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f59bfcd5e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:37<18:39, 37.30s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:18<19:09, 39.63s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:07<20:34, 44.10s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:50<19:29, 43.32s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:36<19:14, 44.39s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:22<18:43, 44.96s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [05:05<17:44, 44.34s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:44<16:18, 42.55s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:30<16:05, 43.87s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:17<15:40, 44.80s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [08:04<15:06, 45.34s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:47<14:10, 44.75s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:28<13:03, 43.55s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:11<12:14, 43.21s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:50<11:13, 42.09s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:32<10:29, 41.96s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:17<10:02, 43.03s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [13:04<09:33, 44.15s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:49<08:51, 44.28s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:29<07:54, 43.10s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [15:10<07:05, 42.54s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:53<06:23, 42.62s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:32<05:33, 41.66s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:10<04:43, 40.45s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:51<04:04, 40.72s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:38<03:31, 42.35s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:26<02:56, 44.10s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [20:15<02:16, 45.55s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [21:01<01:31, 45.93s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:49<00:46, 46.51s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:31<00:00, 44.97s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:31<00:00, 43.59s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:08,  3.60it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:07,  3.94it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:06,  4.11it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:00<00:06,  4.14it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:06,  4.16it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:05,  4.21it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:01<00:05,  4.25it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:01<00:05,  4.31it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:05,  4.34it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:02<00:04,  4.38it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:02<00:04,  4.39it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:02<00:04,  4.36it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:04,  4.36it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:03<00:03,  4.34it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:03<00:03,  4.35it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:03<00:03,  4.42it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:03<00:03,  4.43it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:04<00:02,  4.44it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:04<00:02,  4.44it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:04<00:02,  4.43it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:04<00:02,  4.40it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:05<00:02,  4.34it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:05<00:01,  4.34it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:05<00:01,  4.41it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:05<00:01,  4.42it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:06<00:01,  4.41it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:06<00:00,  4.38it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:06<00:00,  4.39it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:06<00:00,  4.43it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:06<00:00,  4.44it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:07<00:00,  4.49it/s]Importing vessels data: 100%|██████████| 31/31 [00:07<00:00,  4.35it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00, 16.01it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00, 16.18it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00, 15.93it/s]
postgres_copy_csv

2023-05-11 21:10:46 (1683839446) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/2, repeat=1/1, global 1/5) in 1383.470 seconds


2023-05-11 21:10:46 (1683839446) Executed test1 (1/1, global 1/5) in 1391.000 seconds



Running test2 (global 1/5)...

2023-05-11 21:10:46 (1683839446) test started

2023-05-11 21:10:46 (1683839446) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=1/1, repeat=1/1, global 1/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683839451.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-11 21:10:57 (1683839457) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=1/1, repeat=1/1, global 1/5) in 11.546 seconds


2023-05-11 21:10:57 (1683839457) Executed test2 (1/1, global 1/5) in 11.546 seconds



Running test3 (global 1/5)...

2023-05-11 21:10:57 (1683839457) test started

2023-05-11 21:10:57 (1683839457) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=1/3, global 1/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683839459.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-11 21:11:04 (1683839464) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=1/3, global 1/5) in 7.067 seconds



2023-05-11 21:11:04 (1683839464) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=1/3, global 1/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683839475.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f59bfcd5e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:37<18:33, 37.11s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:18<19:11, 39.69s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:02<19:26, 41.66s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:48<19:28, 43.26s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:34<19:12, 44.34s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:21<18:47, 45.10s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [05:04<17:45, 44.38s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:51<17:22, 45.32s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:35<16:27, 44.91s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:16<15:16, 43.65s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:58<14:27, 43.38s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:48<14:17, 45.11s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:39<14:08, 47.16s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:22<12:58, 45.78s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [11:01<11:41, 43.87s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:41<10:38, 42.56s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:23<09:53, 42.40s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [13:08<09:19, 43.04s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:56<08:54, 44.57s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:41<08:11, 44.71s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [15:23<07:18, 43.87s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [16:06<06:32, 43.63s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:45<05:38, 42.28s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:22<04:46, 40.90s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [18:04<04:05, 40.94s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:56<03:41, 44.31s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:44<03:02, 45.64s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [20:33<02:19, 46.58s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [21:24<01:35, 47.73s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [22:06<00:46, 46.12s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:45<00:00, 44.11s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:45<00:00, 44.06s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:08,  3.73it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:07,  3.99it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:06,  4.18it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:00<00:06,  4.23it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:06,  4.25it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:05,  4.30it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:01<00:05,  4.32it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:01<00:05,  4.33it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:05,  4.35it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:02<00:04,  4.37it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:02<00:04,  4.37it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:02<00:04,  4.34it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:04,  4.34it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:03<00:03,  4.32it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:03<00:03,  4.34it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:03<00:03,  4.39it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:03<00:03,  4.45it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:04<00:02,  4.47it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:04<00:02,  4.41it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:04<00:02,  4.20it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:04<00:02,  4.15it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:05<00:02,  3.83it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:05<00:02,  3.62it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:05<00:01,  3.63it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:06<00:01,  3.64it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:06<00:01,  3.58it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:06<00:01,  3.58it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:06<00:00,  3.55it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:07<00:00,  3.74it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:07<00:00,  3.97it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:07<00:00,  4.16it/s]Importing vessels data: 100%|██████████| 31/31 [00:07<00:00,  4.09it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00, 16.29it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00, 16.21it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00, 16.01it/s]
postgres_copy_csv

2023-05-11 21:34:23 (1683840863) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=1/3, global 1/5) in 1398.633 seconds



2023-05-11 21:34:23 (1683840863) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=1/3, global 1/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683840869.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-11 21:34:34 (1683840874) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=1/3, global 1/5) in 11.133 seconds


2023-05-11 21:34:34 (1683840874) Executed test3 (1/3, global 1/5) in 1416.833 seconds

2023-05-11 21:34:34 (1683840874) test started

2023-05-11 21:34:34 (1683840874) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=2/3, global 1/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683840875.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-11 21:34:41 (1683840881) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=2/3, global 1/5) in 6.835 seconds



2023-05-11 21:34:41 (1683840881) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=2/3, global 1/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683840891.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f59bfcd5e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:37<18:30, 37.02s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:17<19:00, 39.32s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:02<19:27, 41.70s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:49<19:39, 43.68s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:34<19:13, 44.35s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:21<18:47, 45.12s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [05:04<17:46, 44.45s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:51<17:18, 45.17s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:35<16:30, 45.02s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:17<15:20, 43.84s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:59<14:29, 43.50s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:48<14:18, 45.19s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:36<13:48, 46.00s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:20<12:52, 45.44s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:59<11:33, 43.35s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:37<10:28, 41.89s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:17<09:35, 41.13s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [13:01<09:08, 42.19s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:45<08:30, 42.53s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:29<07:55, 43.18s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [15:13<07:13, 43.36s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:56<06:29, 43.33s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:35<05:36, 42.02s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:12<04:41, 40.29s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:53<04:03, 40.53s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:40<03:32, 42.41s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:28<02:56, 44.10s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [20:15<02:15, 45.21s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:58<01:28, 44.35s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:45<00:45, 45.29s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:25<00:00, 43.70s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:25<00:00, 43.41s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:08,  3.69it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:07,  4.02it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:06,  4.19it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:00<00:06,  4.24it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:06,  4.28it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:05,  4.30it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:01<00:05,  4.31it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:01<00:05,  4.35it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:05,  4.39it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:02<00:04,  4.40it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:02<00:04,  4.38it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:02<00:04,  4.36it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:04,  4.36it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:03<00:03,  4.34it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:03<00:03,  4.37it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:03<00:03,  4.44it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:03<00:03,  4.48it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:04<00:02,  4.51it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:04<00:02,  4.50it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:04<00:02,  4.38it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:04<00:02,  4.19it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:05<00:02,  4.11it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:05<00:01,  4.22it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:05<00:01,  4.33it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:05<00:01,  4.40it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:05<00:01,  4.41it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:06<00:00,  4.40it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:06<00:00,  4.42it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:06<00:00,  4.43it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:06<00:00,  4.43it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:07<00:00,  4.46it/s]Importing vessels data: 100%|██████████| 31/31 [00:07<00:00,  4.35it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00, 15.87it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00, 15.82it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00, 15.54it/s]
postgres_copy_csv

2023-05-11 21:57:39 (1683842259) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=2/3, global 1/5) in 1377.968 seconds



2023-05-11 21:57:39 (1683842259) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=2/3, global 1/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683842264.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-11 21:57:50 (1683842270) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=2/3, global 1/5) in 11.204 seconds


2023-05-11 21:57:50 (1683842270) Executed test3 (2/3, global 1/5) in 1396.008 seconds

2023-05-11 21:57:50 (1683842270) test started

2023-05-11 21:57:50 (1683842270) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=3/3, global 1/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683842271.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-11 21:57:57 (1683842277) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=3/3, global 1/5) in 6.902 seconds



2023-05-11 21:57:57 (1683842277) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=3/3, global 1/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683842287.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f59bfcd5e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:07, 36.24s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:14<17:59, 37.22s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [01:59<19:07, 41.00s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:45<19:14, 42.77s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:30<18:57, 43.75s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:13<18:03, 43.34s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [05:02<18:05, 45.21s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:41<16:36, 43.33s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:22<15:36, 42.56s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:03<14:41, 41.98s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:47<14:17, 42.88s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:34<13:55, 43.95s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:23<13:37, 45.43s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:04<12:31, 44.19s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:43<11:22, 42.64s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:22<10:21, 41.42s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:08<09:59, 42.82s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:51<09:18, 42.97s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:34<08:34, 42.91s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:14<07:43, 42.16s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:56<06:58, 41.88s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:38<06:19, 42.12s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:16<05:27, 40.97s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [16:54<04:38, 39.80s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:35<04:01, 40.25s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:24<03:34, 42.83s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:13<02:59, 44.86s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [19:59<02:15, 45.24s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:43<01:29, 44.81s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:29<00:45, 45.07s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:08<00:00, 43.30s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:08<00:00, 42.86s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:08,  3.70it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:07,  4.02it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:06,  4.19it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:00<00:06,  4.23it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:06,  4.27it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:05,  4.29it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:01<00:05,  4.31it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:01<00:05,  4.32it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:05,  4.17it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:02<00:04,  4.24it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:02<00:04,  4.29it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:02<00:04,  4.30it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:04,  4.31it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:03<00:03,  4.31it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:03<00:03,  4.35it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:03<00:03,  4.43it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:03<00:03,  4.47it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:04<00:02,  4.50it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:04<00:02,  4.48it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:04<00:02,  4.48it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:04<00:02,  4.42it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:05<00:02,  4.37it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:05<00:01,  4.38it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:05<00:01,  4.42it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:05<00:01,  4.41it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:05<00:01,  4.37it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:06<00:00,  4.36it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:06<00:00,  4.38it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:06<00:00,  4.42it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:06<00:00,  4.44it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:07<00:00,  4.46it/s]Importing vessels data: 100%|██████████| 31/31 [00:07<00:00,  4.36it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00, 15.90it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00, 15.81it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00, 15.79it/s]
postgres_copy_csv

2023-05-11 22:20:38 (1683843638) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=3/3, global 1/5) in 1360.625 seconds



2023-05-11 22:20:38 (1683843638) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=3/3, global 1/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683843643.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-11 22:20:49 (1683843649) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=3/3, global 1/5) in 11.142 seconds


2023-05-11 22:20:49 (1683843649) Executed test3 (3/3, global 1/5) in 1378.670 seconds



Running test4 (global 1/5)...

2023-05-11 22:20:49 (1683843649) test started

2023-05-11 22:20:49 (1683843649) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 1/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683843650.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-11 22:20:56 (1683843656) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 1/5) in 6.793 seconds



2023-05-11 22:20:56 (1683843656) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 1/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683843666.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f59bfcd5e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:02, 36.07s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:16<18:47, 38.90s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:00<19:06, 40.94s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:45<19:13, 42.71s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:30<18:50, 43.48s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:15<18:23, 44.12s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:58<17:28, 43.67s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:42<16:45, 43.73s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:26<16:06, 43.92s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:06<14:56, 42.71s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:48<14:09, 42.46s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:35<13:53, 43.84s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:22<13:26, 44.78s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:09<12:50, 45.31s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:48<11:35, 43.48s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:27<10:29, 41.99s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:04<09:29, 40.68s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:43<08:40, 40.06s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:27<08:16, 41.36s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:13<07:50, 42.78s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [15:00<07:20, 44.04s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:51<06:54, 46.08s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:30<05:51, 43.88s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:07<04:53, 41.91s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:48<04:08, 41.45s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:29<03:27, 41.40s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:11<02:46, 41.67s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [19:52<02:03, 41.32s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:35<01:23, 41.87s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:27<00:45, 45.05s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:12<00:00, 45.03s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:12<00:00, 42.99s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:08,  3.72it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:07,  4.05it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:06,  4.06it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:00<00:06,  4.11it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:06,  4.17it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:05,  4.19it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:01<00:05,  4.24it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:01<00:05,  4.29it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:05,  4.33it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:02<00:04,  4.31it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:02<00:04,  4.29it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:02<00:04,  4.26it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:04,  4.24it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:03<00:03,  4.27it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:03<00:03,  4.30it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:03<00:03,  4.37it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:03<00:03,  4.43it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:04<00:02,  4.47it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:04<00:02,  4.40it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:04<00:02,  4.41it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:04<00:02,  4.39it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:05<00:02,  4.35it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:05<00:01,  4.31it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:05<00:01,  4.38it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:05<00:01,  4.40it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:06<00:01,  4.37it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:06<00:00,  4.36it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:06<00:00,  4.35it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:06<00:00,  4.34it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:06<00:00,  4.33it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:07<00:00,  4.36it/s]Importing vessels data: 100%|██████████| 31/31 [00:07<00:00,  4.31it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00, 16.39it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00, 16.26it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00, 16.48it/s]
postgres_copy_csv

2023-05-11 22:43:41 (1683845021) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 1/5) in 1364.948 seconds



2023-05-11 22:43:41 (1683845021) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_update_simple) (function=3/4, repeat=1/1, global 1/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683845038.log
Execution time:  259.635794878006
execute_postgres_query

2023-05-11 22:48:27 (1683845307) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_update_simple) (function=3/4, repeat=1/1, global 1/5) in 286.792 seconds



2023-05-11 22:48:27 (1683845307) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 1/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683845312.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-11 22:48:38 (1683845318) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 1/5) in 10.311 seconds


2023-05-11 22:48:38 (1683845318) Executed test4 (1/1, global 1/5) in 1668.845 seconds



Running test5 (global 1/5)...

2023-05-11 22:48:38 (1683845318) test started

2023-05-11 22:48:38 (1683845318) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 1/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683845319.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-11 22:48:45 (1683845325) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 1/5) in 6.843 seconds



2023-05-11 22:48:45 (1683845325) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 1/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683845335.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f59bfcd5e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:35<17:57, 35.92s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:13<17:56, 37.13s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [01:59<19:06, 40.96s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:44<19:09, 42.56s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:28<18:41, 43.13s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:11<18:00, 43.23s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:59<17:54, 44.77s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:40<16:38, 43.39s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:21<15:37, 42.63s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:02<14:44, 42.11s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:47<14:22, 43.10s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:35<14:08, 44.65s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:22<13:37, 45.41s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:04<12:30, 44.13s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:42<11:17, 42.32s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:22<10:23, 41.55s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:05<09:47, 42.00s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:47<09:06, 42.07s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:36<08:49, 44.10s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:16<07:52, 42.97s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:57<07:04, 42.49s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:40<06:22, 42.49s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:18<05:30, 41.29s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [16:55<04:38, 39.85s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:39<04:07, 41.20s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:27<03:35, 43.18s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:14<02:57, 44.37s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [20:03<02:16, 45.66s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:48<01:31, 45.62s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:30<00:44, 44.42s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:09<00:00, 42.66s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:09<00:00, 42.87s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:08,  3.67it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:07,  3.96it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:06,  4.11it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:00<00:06,  4.15it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:06,  4.20it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:05,  4.22it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:01<00:05,  4.25it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:01<00:05,  4.32it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:05,  4.38it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:02<00:04,  4.42it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:02<00:04,  4.43it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:02<00:04,  4.42it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:04,  4.41it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:03<00:03,  4.38it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:03<00:03,  4.42it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:03<00:03,  4.47it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:03<00:03,  4.51it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:04<00:02,  4.54it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:04<00:02,  4.52it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:04<00:02,  4.52it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:04<00:02,  4.47it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:05<00:02,  4.41it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:05<00:01,  4.44it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:05<00:01,  4.51it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:05<00:01,  4.52it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:05<00:01,  4.48it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:06<00:00,  4.45it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:06<00:00,  4.46it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:06<00:00,  4.47it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:06<00:00,  4.48it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:07<00:00,  4.52it/s]Importing vessels data: 100%|██████████| 31/31 [00:07<00:00,  4.41it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00, 16.38it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00, 16.27it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00, 15.97it/s]
postgres_copy_csv

2023-05-11 23:11:26 (1683846686) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 1/5) in 1361.133 seconds



2023-05-11 23:11:26 (1683846686) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_update_complex) (function=3/4, repeat=1/1, global 1/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683846695.log
Execution time:  92.60870552062988
execute_postgres_query

2023-05-11 23:13:17 (1683846797) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_update_complex) (function=3/4, repeat=1/1, global 1/5) in 111.411 seconds



2023-05-11 23:13:17 (1683846797) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 1/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683846820.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-11 23:13:46 (1683846826) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 1/5) in 28.466 seconds


2023-05-11 23:13:46 (1683846826) Executed test5 (1/1, global 1/5) in 1507.853 seconds



Running test6 (global 1/5)...

2023-05-11 23:13:46 (1683846826) test started

2023-05-11 23:13:46 (1683846826) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 1/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683846827.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-11 23:13:53 (1683846833) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 1/5) in 7.039 seconds



2023-05-11 23:13:53 (1683846833) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 1/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683846843.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f59bfcd5e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:06, 36.20s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:15<18:23, 38.05s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [01:59<19:06, 40.96s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:41<18:28, 41.05s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:24<18:13, 42.05s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:12<18:20, 44.03s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:57<17:43, 44.31s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:40<16:49, 43.87s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:24<16:07, 43.97s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:05<14:59, 42.81s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:46<14:08, 42.41s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:32<13:46, 43.53s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:21<13:32, 45.15s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:07<12:49, 45.27s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:46<11:37, 43.60s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:24<10:29, 41.97s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:02<09:27, 40.52s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:41<08:40, 40.06s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:23<08:08, 40.67s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:08<07:41, 41.93s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:54<07:12, 43.28s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:45<06:51, 45.69s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:24<05:48, 43.55s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:01<04:51, 41.66s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:40<04:05, 40.97s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:22<03:26, 41.21s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:04<02:44, 41.24s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [19:49<02:07, 42.38s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:33<01:25, 42.92s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:25<00:45, 45.70s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:11<00:00, 45.67s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:11<00:00, 42.94s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:08,  3.64it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:07,  3.90it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:06,  4.12it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:00<00:06,  4.12it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:06,  4.17it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:05,  4.17it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:01<00:05,  4.24it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:01<00:05,  4.23it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:05,  4.27it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:02<00:04,  4.28it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:02<00:04,  4.27it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:02<00:04,  4.24it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:04,  4.27it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:03<00:03,  4.26it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:03<00:03,  4.27it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:03<00:03,  4.34it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:04<00:03,  4.43it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:04<00:02,  4.50it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:04<00:02,  4.51it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:04<00:02,  4.50it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:04<00:02,  4.44it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:05<00:02,  4.42it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:05<00:01,  4.41it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:05<00:01,  4.48it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:05<00:01,  4.50it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:06<00:01,  4.49it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:06<00:00,  4.49it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:06<00:00,  4.47it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:06<00:00,  4.44it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:06<00:00,  4.42it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:07<00:00,  4.48it/s]Importing vessels data: 100%|██████████| 31/31 [00:07<00:00,  4.35it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00, 15.87it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00, 16.08it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00, 15.85it/s]
postgres_copy_csv

2023-05-11 23:36:36 (1683848196) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 1/5) in 1363.224 seconds



2023-05-11 23:36:36 (1683848196) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_single) (function=3/4, repeat=1/1, global 1/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683848211.log
Execution time:  8.0592782497406
execute_postgres_query

2023-05-11 23:37:25 (1683848245) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_single) (function=3/4, repeat=1/1, global 1/5) in 48.987 seconds



2023-05-11 23:37:25 (1683848245) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 1/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683848246.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-11 23:37:32 (1683848252) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 1/5) in 7.298 seconds


2023-05-11 23:37:32 (1683848252) Executed test6 (1/1, global 1/5) in 1426.548 seconds



Running test7 (global 1/5)...

2023-05-11 23:37:32 (1683848252) test started

2023-05-11 23:37:32 (1683848252) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 1/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683848253.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-11 23:37:39 (1683848259) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 1/5) in 7.041 seconds



2023-05-11 23:37:39 (1683848259) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 1/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683848269.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f59bfcd5e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:12, 36.43s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:17<18:59, 39.28s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:01<19:15, 41.25s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:47<19:22, 43.05s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:32<19:05, 44.04s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:17<18:29, 44.39s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [05:00<17:34, 43.93s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:46<17:02, 44.44s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:30<16:13, 44.26s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:11<15:11, 43.39s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:54<14:25, 43.26s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:44<14:18, 45.17s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:29<13:35, 45.32s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:15<12:51, 45.35s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:53<11:32, 43.30s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:31<10:22, 41.48s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:10<09:31, 40.80s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:55<09:07, 42.14s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:41<08:37, 43.15s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:24<07:56, 43.29s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [15:08<07:13, 43.35s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:50<06:26, 42.91s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:29<05:34, 41.80s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:05<04:40, 40.10s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:46<04:01, 40.22s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:29<03:26, 41.23s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:17<02:53, 43.33s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [20:06<02:14, 44.99s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:52<01:30, 45.14s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:37<00:45, 45.20s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:17<00:00, 43.61s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:17<00:00, 43.14s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:11,  2.62it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:10,  2.75it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:01<00:09,  3.01it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.14it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:08,  3.23it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.23it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:06,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:04<00:05,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.50it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:06<00:03,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:08<00:01,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.48it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.37it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.91it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.89it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.92it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.90it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.79it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.77it/s]
postgres_copy_csv

2023-05-12 00:00:31 (1683849631) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 1/5) in 1371.933 seconds



2023-05-12 00:00:31 (1683849631) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_multi) (function=3/4, repeat=1/1, global 1/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683849640.log
Execution time:  151.31992745399475
execute_postgres_query

2023-05-12 00:03:21 (1683849801) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_multi) (function=3/4, repeat=1/1, global 1/5) in 170.136 seconds



2023-05-12 00:03:21 (1683849801) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 1/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683849816.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-12 00:03:42 (1683849822) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 1/5) in 20.845 seconds


2023-05-12 00:03:42 (1683849822) Executed test7 (1/1, global 1/5) in 1569.956 seconds



Running test8 (global 1/5)...

2023-05-12 00:03:42 (1683849822) test started

2023-05-12 00:03:42 (1683849822) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 1/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683849823.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-12 00:03:49 (1683849829) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 1/5) in 6.966 seconds



2023-05-12 00:03:49 (1683849829) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 1/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683849839.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f59bfcd5e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:21, 36.73s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:15<18:22, 38.01s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:02<19:33, 41.91s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:48<19:42, 43.81s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:35<19:22, 44.72s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:19<18:30, 44.42s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [05:09<18:33, 46.41s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:49<16:56, 44.19s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:31<15:58, 43.59s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:14<15:09, 43.32s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:59<14:42, 44.11s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:49<14:31, 45.85s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:33<13:34, 45.28s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:15<12:33, 44.30s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:55<11:25, 42.81s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:36<10:33, 42.26s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:19<09:57, 42.68s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [13:09<09:42, 44.81s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:54<08:57, 44.75s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:35<08:01, 43.73s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [15:16<07:10, 43.03s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [16:00<06:29, 43.22s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:44<05:48, 43.54s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:25<04:58, 42.64s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [18:15<04:29, 44.95s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [19:03<03:48, 45.70s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:45<02:59, 44.80s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [20:27<02:11, 43.85s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [21:07<01:25, 42.64s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:50<00:42, 42.72s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:30<00:00, 42.07s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:30<00:00, 43.57s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.95it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.15it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.26it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:05<00:03,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:08<00:01,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.44it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.36it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.82it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.80it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.60it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.58it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  6.73it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  6.71it/s]
postgres_copy_csv

2023-05-12 00:26:54 (1683851214) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 1/5) in 1385.308 seconds



2023-05-12 00:26:54 (1683851214) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_aggregate) (function=3/4, repeat=1/1, global 1/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683851224.log
Execution time:  92.06123280525208
execute_postgres_query

2023-05-12 00:28:45 (1683851325) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_aggregate) (function=3/4, repeat=1/1, global 1/5) in 110.968 seconds



2023-05-12 00:28:45 (1683851325) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 1/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683851346.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-12 00:29:13 (1683851353) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 1/5) in 27.829 seconds


2023-05-12 00:29:13 (1683851353) Executed test8 (1/1, global 1/5) in 1531.071 seconds



Running test9 (global 1/5)...

2023-05-12 00:29:13 (1683851353) test started

2023-05-12 00:29:13 (1683851353) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 1/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683851354.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-12 00:29:20 (1683851360) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 1/5) in 7.011 seconds



2023-05-12 00:29:20 (1683851360) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 1/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683851370.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f59bfcd5e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:37<18:36, 37.22s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:15<18:20, 37.94s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:02<19:32, 41.86s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:49<19:43, 43.84s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:33<19:04, 44.01s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:16<18:14, 43.77s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [05:06<18:19, 45.83s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:47<16:55, 44.17s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:29<15:55, 43.43s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:11<15:08, 43.24s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:57<14:41, 44.08s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:45<14:17, 45.13s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:33<13:46, 45.90s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:16<12:47, 45.17s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:56<11:38, 43.67s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:37<10:42, 42.82s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:23<10:10, 43.61s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [13:09<09:37, 44.43s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:53<08:50, 44.17s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:33<07:54, 43.09s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [15:16<07:08, 42.87s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:59<06:28, 43.12s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:43<05:47, 43.44s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:23<04:56, 42.42s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [18:12<04:25, 44.31s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:59<03:46, 45.21s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:42<02:57, 44.44s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [20:24<02:11, 43.80s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [21:04<01:25, 42.63s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:48<00:42, 42.84s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:28<00:00, 42.15s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:28<00:00, 43.51s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.93it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.14it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.24it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.27it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:05<00:03,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:08<00:01,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.45it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.36it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.52it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.50it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.36it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.34it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.28it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.26it/s]
postgres_copy_csv

2023-05-12 00:52:24 (1683852744) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 1/5) in 1383.642 seconds



2023-05-12 00:52:24 (1683852744) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_conditions) (function=3/4, repeat=1/1, global 1/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683852753.log
Execution time:  200.03092527389526
execute_postgres_query

2023-05-12 00:56:03 (1683852963) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_conditions) (function=3/4, repeat=1/1, global 1/5) in 219.385 seconds



2023-05-12 00:56:03 (1683852963) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 1/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683852967.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-12 00:56:13 (1683852973) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 1/5) in 9.836 seconds


2023-05-12 00:56:13 (1683852973) Executed test9 (1/1, global 1/5) in 1619.875 seconds



Running test1 (global 2/5)...

2023-05-12 00:56:13 (1683852973) test started

2023-05-12 00:56:13 (1683852973) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/2, repeat=1/1, global 2/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683852974.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-12 00:56:20 (1683852980) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/2, repeat=1/1, global 2/5) in 6.951 seconds



2023-05-12 00:56:20 (1683852980) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/2, repeat=1/1, global 2/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683852990.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f59bfcd5e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:37<18:33, 37.12s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:19<19:21, 40.07s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:03<19:37, 42.04s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:48<19:28, 43.27s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:31<18:39, 43.07s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:17<18:17, 43.90s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [05:08<18:35, 46.47s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:48<17:02, 44.46s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:30<16:01, 43.70s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:12<15:03, 43.03s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [08:05<15:22, 46.13s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:53<14:49, 46.80s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:35<13:34, 45.25s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:17<12:30, 44.15s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:57<11:27, 42.96s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:43<10:58, 43.91s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:28<10:18, 44.16s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [13:13<09:38, 44.49s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:54<08:42, 43.50s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:34<07:45, 42.33s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [15:16<07:03, 42.31s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:58<06:20, 42.29s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:38<05:31, 41.50s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:19<04:49, 41.42s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [18:07<04:20, 43.44s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:54<03:42, 44.52s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:43<03:02, 45.67s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [20:33<02:21, 47.10s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [21:14<01:30, 45.30s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:56<00:44, 44.31s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:36<00:00, 42.96s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:36<00:00, 43.76s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.93it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.14it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.25it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:05<00:03,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:08<00:01,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.45it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.38it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.78it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.75it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.72it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.70it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.85it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.83it/s]
postgres_copy_csv

2023-05-12 01:19:31 (1683854371) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/2, repeat=1/1, global 2/5) in 1391.346 seconds


2023-05-12 01:19:31 (1683854371) Executed test1 (1/1, global 2/5) in 1398.297 seconds



Running test2 (global 2/5)...

2023-05-12 01:19:31 (1683854371) test started

2023-05-12 01:19:31 (1683854371) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=1/1, repeat=1/1, global 2/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683854377.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-12 01:19:43 (1683854383) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=1/1, repeat=1/1, global 2/5) in 11.448 seconds


2023-05-12 01:19:43 (1683854383) Executed test2 (1/1, global 2/5) in 11.448 seconds



Running test3 (global 2/5)...

2023-05-12 01:19:43 (1683854383) test started

2023-05-12 01:19:43 (1683854383) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=1/3, global 2/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683854384.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-12 01:19:50 (1683854390) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=1/3, global 2/5) in 7.062 seconds



2023-05-12 01:19:50 (1683854390) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=1/3, global 2/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683854400.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f59bfcd5e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:29, 37.00s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:17<18:45, 38.80s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:02<19:37, 42.06s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:44<18:52, 41.93s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:29<18:36, 42.94s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:17<18:34, 44.59s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [05:01<17:50, 44.58s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:45<16:57, 44.24s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:29<16:14, 44.30s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:10<15:08, 43.28s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:53<14:23, 43.20s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:41<14:07, 44.63s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:28<13:37, 45.42s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:16<13:02, 46.04s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:55<11:44, 44.05s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:34<10:38, 42.54s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:14<09:41, 41.54s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:53<08:52, 40.96s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:35<08:13, 41.10s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:23<07:56, 43.35s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [15:12<07:30, 45.06s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:57<06:45, 45.08s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:37<05:48, 43.60s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:15<04:51, 41.68s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:55<04:07, 41.21s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:37<03:28, 41.64s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:19<02:46, 41.52s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [20:00<02:04, 41.34s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:42<01:23, 41.79s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:32<00:44, 44.04s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:18<00:00, 44.75s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:18<00:00, 43.18s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.80it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.05it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.14it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.17it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:08,  3.22it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.23it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.19it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:07,  3.23it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:06<00:03,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:03,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:08<00:01,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:09<00:00,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.42it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.32it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.98it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.96it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  8.00it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.98it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.83it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.81it/s]
postgres_copy_csv

2023-05-12 01:42:43 (1683855763) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=1/3, global 2/5) in 1373.551 seconds



2023-05-12 01:42:43 (1683855763) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=1/3, global 2/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683855776.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-12 01:43:03 (1683855783) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=1/3, global 2/5) in 19.536 seconds


2023-05-12 01:43:03 (1683855783) Executed test3 (1/3, global 2/5) in 1400.149 seconds

2023-05-12 01:43:03 (1683855783) test started

2023-05-12 01:43:03 (1683855783) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=2/3, global 2/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683855784.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-12 01:43:10 (1683855790) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=2/3, global 2/5) in 7.096 seconds



2023-05-12 01:43:10 (1683855790) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=2/3, global 2/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683855800.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f59bfcd5e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:06, 36.22s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:14<18:04, 37.39s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:00<19:20, 41.44s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:46<19:24, 43.11s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:31<18:55, 43.69s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:13<18:04, 43.39s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [05:03<18:06, 45.28s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:44<16:51, 43.98s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:26<15:53, 43.34s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:07<14:59, 42.82s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:52<14:29, 43.47s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:39<14:02, 44.36s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:27<13:37, 45.44s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:08<12:30, 44.12s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:47<11:21, 42.62s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:25<10:21, 41.41s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:11<09:59, 42.79s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:53<09:13, 42.55s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:40<08:44, 43.71s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:20<07:50, 42.77s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [15:02<07:02, 42.29s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:44<06:21, 42.36s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:23<05:30, 41.31s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:01<04:42, 40.30s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:47<04:11, 41.92s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:38<03:43, 44.76s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:25<03:02, 45.51s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [20:14<02:19, 46.63s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [21:02<01:33, 46.88s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:44<00:45, 45.49s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:24<00:00, 43.75s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:24<00:00, 43.37s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.89it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.12it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.24it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.26it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:06,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:06<00:03,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:03,  3.21it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.23it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.27it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:08<00:01,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:09<00:00,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.39it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.33it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.54it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.52it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.48it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.46it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.54it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.52it/s]
postgres_copy_csv

2023-05-12 02:06:09 (1683857169) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=2/3, global 2/5) in 1379.066 seconds



2023-05-12 02:06:09 (1683857169) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=2/3, global 2/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683857174.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-12 02:06:20 (1683857180) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=2/3, global 2/5) in 11.040 seconds


2023-05-12 02:06:20 (1683857180) Executed test3 (2/3, global 2/5) in 1397.202 seconds

2023-05-12 02:06:20 (1683857180) test started

2023-05-12 02:06:20 (1683857180) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=3/3, global 2/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683857181.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-12 02:06:27 (1683857187) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=3/3, global 2/5) in 6.952 seconds



2023-05-12 02:06:27 (1683857187) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=3/3, global 2/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683857197.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f59bfcd5e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:37<18:44, 37.49s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:18<19:08, 39.61s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:03<19:38, 42.10s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:49<19:39, 43.69s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:36<19:20, 44.63s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:20<18:34, 44.56s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [05:03<17:40, 44.19s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:50<17:15, 45.04s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:34<16:23, 44.72s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:16<15:21, 43.87s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:59<14:28, 43.41s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:47<14:12, 44.88s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:34<13:38, 45.45s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:20<12:59, 45.84s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:59<11:40, 43.76s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:38<10:35, 42.36s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:19<09:46, 41.91s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [13:05<09:19, 43.02s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:49<08:38, 43.24s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:36<08:08, 44.41s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [15:19<07:20, 44.08s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [16:02<06:34, 43.80s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:42<05:39, 42.45s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:20<04:49, 41.32s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [18:01<04:07, 41.20s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:50<03:38, 43.62s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:39<02:59, 44.99s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [20:26<02:17, 45.79s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [21:14<01:32, 46.40s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:57<00:45, 45.26s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:37<00:00, 43.77s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:37<00:00, 43.79s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.97it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.17it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.24it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.26it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:06,  3.22it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.25it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.27it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:06<00:03,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:08<00:01,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:09<00:00,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.36it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.33it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.64it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.62it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.62it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.59it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.62it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.60it/s]
postgres_copy_csv

2023-05-12 02:29:40 (1683858580) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=3/3, global 2/5) in 1392.429 seconds



2023-05-12 02:29:40 (1683858580) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=3/3, global 2/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683858585.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-12 02:29:51 (1683858591) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=3/3, global 2/5) in 11.215 seconds


2023-05-12 02:29:51 (1683858591) Executed test3 (3/3, global 2/5) in 1410.596 seconds



Running test4 (global 2/5)...

2023-05-12 02:29:51 (1683858591) test started

2023-05-12 02:29:51 (1683858591) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 2/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683858592.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-12 02:29:58 (1683858598) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 2/5) in 6.951 seconds



2023-05-12 02:29:58 (1683858598) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 2/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683858608.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f59bfcd5e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:37<18:42, 37.43s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:17<18:43, 38.75s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:03<19:37, 42.05s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:45<18:58, 42.18s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:30<18:45, 43.31s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:17<18:34, 44.60s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [05:04<18:09, 45.38s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:43<16:34, 43.22s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:27<15:57, 43.52s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:16<15:48, 45.19s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [08:02<15:11, 45.56s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:47<14:19, 45.25s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:30<13:22, 44.60s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:20<13:03, 46.06s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [11:03<12:03, 45.23s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:43<10:53, 43.58s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:21<09:49, 42.07s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [13:01<08:59, 41.49s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:45<08:26, 42.20s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:34<08:05, 44.11s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [15:23<07:35, 45.54s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [16:06<06:43, 44.84s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:45<05:45, 43.22s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:23<04:51, 41.64s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [18:04<04:08, 41.42s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:47<03:29, 41.96s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:34<02:54, 43.51s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [20:22<02:14, 44.83s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [21:11<01:31, 45.88s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [22:01<00:47, 47.26s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:45<00:00, 46.24s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:45<00:00, 44.05s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.89it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.00it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:09,  3.08it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.12it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:08,  3.16it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.23it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.27it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:06,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:06<00:03,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:07<00:02,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:08<00:01,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:09<00:00,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.39it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.31it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.20it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.18it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.33it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.31it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.37it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.35it/s]
postgres_copy_csv

2023-05-12 02:53:18 (1683859998) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 2/5) in 1400.243 seconds



2023-05-12 02:53:18 (1683859998) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_update_simple) (function=3/4, repeat=1/1, global 2/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683860007.log
Execution time:  243.9825348854065
execute_postgres_query

2023-05-12 02:57:41 (1683860261) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_update_simple) (function=3/4, repeat=1/1, global 2/5) in 262.918 seconds



2023-05-12 02:57:41 (1683860261) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 2/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683860265.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-12 02:57:51 (1683860271) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 2/5) in 10.287 seconds


2023-05-12 02:57:51 (1683860271) Executed test4 (1/1, global 2/5) in 1680.400 seconds



Running test5 (global 2/5)...

2023-05-12 02:57:51 (1683860271) test started

2023-05-12 02:57:51 (1683860271) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 2/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683860272.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-12 02:57:58 (1683860278) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 2/5) in 6.908 seconds



2023-05-12 02:57:58 (1683860278) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 2/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683860288.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f59bfcd5e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:37<18:34, 37.16s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:15<18:23, 38.06s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:02<19:40, 42.18s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:45<18:59, 42.21s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:30<18:47, 43.37s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:18<18:45, 45.02s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [05:05<18:15, 45.66s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:44<16:41, 43.56s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:30<16:13, 44.26s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:15<15:33, 44.45s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [08:05<15:23, 46.17s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:48<14:18, 45.19s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:33<13:33, 45.20s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:19<12:52, 45.45s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [11:03<11:58, 44.92s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:42<10:47, 43.16s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:21<09:48, 42.00s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [13:01<08:56, 41.26s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:45<08:24, 42.02s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:30<07:54, 43.14s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [15:20<07:29, 45.00s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [16:03<06:40, 44.54s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:43<05:44, 43.02s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:20<04:49, 41.41s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [18:02<04:08, 41.35s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:43<03:26, 41.40s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:26<02:46, 41.72s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [20:08<02:05, 41.83s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:53<01:25, 42.79s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:45<00:45, 45.68s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:30<00:00, 45.47s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:30<00:00, 43.57s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.99it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.10it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:09,  3.10it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.10it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:08,  3.12it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.17it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.17it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:07,  3.22it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.24it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.23it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:06,  3.23it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.19it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:04<00:05,  3.22it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.21it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.24it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:05<00:04,  3.25it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.25it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.25it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.25it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:06<00:03,  3.23it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:03,  3.24it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.21it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:07<00:02,  3.22it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.27it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.26it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:08<00:01,  3.27it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:08<00:01,  3.24it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.24it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:09<00:00,  3.25it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:09<00:00,  3.22it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.16it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.21it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  6.94it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  6.92it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  5.77it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  5.75it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  6.64it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  6.62it/s]
postgres_copy_csv

2023-05-12 03:21:04 (1683861664) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 2/5) in 1385.983 seconds



2023-05-12 03:21:04 (1683861664) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_update_complex) (function=3/4, repeat=1/1, global 2/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683861679.log
Execution time:  91.7460503578186
execute_postgres_query

2023-05-12 03:23:00 (1683861780) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_update_complex) (function=3/4, repeat=1/1, global 2/5) in 116.118 seconds



2023-05-12 03:23:00 (1683861780) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 2/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683861787.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-12 03:23:13 (1683861793) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 2/5) in 12.741 seconds


2023-05-12 03:23:13 (1683861793) Executed test5 (1/1, global 2/5) in 1521.751 seconds



Running test6 (global 2/5)...

2023-05-12 03:23:13 (1683861793) test started

2023-05-12 03:23:13 (1683861793) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 2/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683861794.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-12 03:23:20 (1683861800) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 2/5) in 7.135 seconds



2023-05-12 03:23:20 (1683861800) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 2/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683861810.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f59bfcd5e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:37<18:37, 37.26s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:15<18:24, 38.09s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:02<19:33, 41.89s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:49<19:42, 43.81s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:35<19:19, 44.61s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:18<18:28, 44.35s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [05:08<18:28, 46.18s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:48<16:52, 44.04s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:30<15:57, 43.52s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:13<15:09, 43.32s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:59<14:40, 44.02s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:47<14:21, 45.36s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:36<13:53, 46.31s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:18<12:47, 45.13s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:57<11:33, 43.34s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:38<10:36, 42.47s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:24<10:12, 43.73s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [13:06<09:21, 43.16s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:56<09:01, 45.10s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:36<08:01, 43.75s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [15:19<07:13, 43.34s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [16:02<06:30, 43.38s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:44<05:44, 43.00s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:29<05:03, 43.41s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [18:16<04:28, 44.70s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [19:04<03:47, 45.44s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:46<02:58, 44.51s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [20:28<02:11, 43.85s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [21:09<01:25, 42.79s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:51<00:42, 42.71s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:31<00:00, 41.85s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:31<00:00, 43.60s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.91it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.14it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.24it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.25it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:08,  3.22it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.20it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.23it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:07,  3.25it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.26it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:06,  3.27it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.27it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:04<00:05,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:06<00:03,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:08<00:01,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:09<00:00,  3.22it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.26it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.30it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.49it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.47it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.53it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.51it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.51it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.49it/s]
postgres_copy_csv

2023-05-12 03:46:27 (1683863187) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 2/5) in 1386.457 seconds



2023-05-12 03:46:27 (1683863187) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_single) (function=3/4, repeat=1/1, global 2/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683863196.log
Execution time:  8.240152835845947
execute_postgres_query

2023-05-12 03:47:11 (1683863231) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_single) (function=3/4, repeat=1/1, global 2/5) in 44.346 seconds



2023-05-12 03:47:11 (1683863231) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 2/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683863239.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-12 03:47:26 (1683863246) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 2/5) in 15.565 seconds


2023-05-12 03:47:26 (1683863246) Executed test6 (1/1, global 2/5) in 1453.504 seconds



Running test7 (global 2/5)...

2023-05-12 03:47:26 (1683863246) test started

2023-05-12 03:47:26 (1683863246) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 2/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683863248.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-12 03:47:33 (1683863253) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 2/5) in 7.042 seconds



2023-05-12 03:47:33 (1683863253) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 2/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683863264.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f59bfcd5e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:37<18:48, 37.62s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:17<18:54, 39.13s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:05<19:59, 42.84s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:47<19:07, 42.51s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:33<18:58, 43.77s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:19<18:34, 44.59s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [05:04<17:58, 44.94s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:49<17:10, 44.81s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:34<16:24, 44.74s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:16<15:25, 44.06s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:58<14:29, 43.50s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:46<14:12, 44.85s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:34<13:41, 45.64s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:20<12:59, 45.84s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [11:00<11:46, 44.14s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:40<10:41, 42.74s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:21<09:50, 42.17s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [13:06<09:22, 43.25s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:51<08:43, 43.64s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:34<07:59, 43.57s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [15:17<07:13, 43.40s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [16:00<06:29, 43.33s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:40<05:38, 42.27s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:17<04:45, 40.77s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:59<04:06, 41.04s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:44<03:30, 42.18s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:35<02:58, 44.69s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [20:24<02:18, 46.03s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [21:09<01:31, 45.78s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:55<00:45, 45.81s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:35<00:00, 44.09s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:35<00:00, 43.72s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.91it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.09it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.21it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.24it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:08,  3.21it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.20it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.23it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:07,  3.27it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:06,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.16it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:04,  3.23it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.27it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:06<00:03,  3.27it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:03,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:07<00:02,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:08<00:01,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:09<00:00,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.40it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.30it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.53it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.51it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.60it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.58it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.52it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.50it/s]
postgres_copy_csv

2023-05-12 04:10:44 (1683864644) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 2/5) in 1390.183 seconds



2023-05-12 04:10:44 (1683864644) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_multi) (function=3/4, repeat=1/1, global 2/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683864653.log
Execution time:  146.94937944412231
execute_postgres_query

2023-05-12 04:13:30 (1683864810) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_multi) (function=3/4, repeat=1/1, global 2/5) in 165.863 seconds



2023-05-12 04:13:30 (1683864810) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 2/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683864822.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-12 04:13:48 (1683864828) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 2/5) in 18.146 seconds


2023-05-12 04:13:48 (1683864828) Executed test7 (1/1, global 2/5) in 1581.234 seconds



Running test8 (global 2/5)...

2023-05-12 04:13:48 (1683864828) test started

2023-05-12 04:13:48 (1683864828) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 2/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683864829.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-12 04:13:56 (1683864836) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 2/5) in 8.058 seconds



2023-05-12 04:13:56 (1683864836) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 2/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683864846.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f59bfcd5e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:37<18:42, 37.42s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:18<19:06, 39.52s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:03<19:34, 41.95s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:45<18:53, 42.00s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:31<18:52, 43.55s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:19<18:45, 45.02s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [05:04<18:00, 45.03s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:49<17:16, 45.05s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:34<16:32, 45.11s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:16<15:24, 44.01s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:59<14:35, 43.75s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:48<14:20, 45.31s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:37<13:53, 46.30s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:22<13:00, 45.90s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [11:00<11:39, 43.74s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:39<10:33, 42.20s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:19<09:43, 41.68s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [13:04<09:14, 42.64s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:48<08:35, 42.99s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:35<08:05, 44.14s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [15:16<07:13, 43.34s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:59<06:27, 43.00s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:37<05:33, 41.71s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:14<04:42, 40.36s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:55<04:02, 40.34s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:42<03:31, 42.36s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:31<02:57, 44.41s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [20:16<02:13, 44.54s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [21:02<01:29, 44.90s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:48<00:45, 45.32s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:27<00:00, 43.42s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:27<00:00, 43.46s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.97it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.19it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.26it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.24it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.26it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:04,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.50it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.51it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.50it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:05<00:03,  3.49it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:07<00:01,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.50it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.42it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.89it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.87it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.82it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.80it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.86it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.84it/s]
postgres_copy_csv

2023-05-12 04:36:58 (1683866218) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 2/5) in 1382.339 seconds



2023-05-12 04:36:58 (1683866218) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_aggregate) (function=3/4, repeat=1/1, global 2/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683866227.log
Execution time:  92.22138023376465
execute_postgres_query

2023-05-12 04:38:49 (1683866329) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_aggregate) (function=3/4, repeat=1/1, global 2/5) in 111.289 seconds



2023-05-12 04:38:49 (1683866329) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 2/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683866345.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-12 04:39:12 (1683866352) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 2/5) in 22.199 seconds


2023-05-12 04:39:12 (1683866352) Executed test8 (1/1, global 2/5) in 1523.886 seconds



Running test9 (global 2/5)...

2023-05-12 04:39:12 (1683866352) test started

2023-05-12 04:39:12 (1683866352) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 2/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683866353.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-12 04:39:19 (1683866359) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 2/5) in 6.964 seconds



2023-05-12 04:39:19 (1683866359) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 2/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683866369.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f59bfcd5e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:11, 36.38s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:16<18:39, 38.60s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:01<19:16, 41.29s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:47<19:29, 43.32s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:32<19:04, 44.03s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:18<18:33, 44.55s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [05:00<17:33, 43.90s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:44<16:49, 43.90s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:28<16:07, 43.97s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:09<14:58, 42.80s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:50<14:07, 42.38s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:37<13:54, 43.94s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:24<13:25, 44.74s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:10<12:46, 45.11s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:49<11:33, 43.32s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:28<10:29, 41.96s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:06<09:32, 40.87s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:46<08:44, 40.37s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:27<08:09, 40.76s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:15<07:52, 42.96s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [15:04<07:27, 44.76s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:51<06:48, 45.38s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:30<05:47, 43.45s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:07<04:50, 41.57s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:48<04:08, 41.38s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:30<03:27, 41.46s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:12<02:46, 41.73s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [19:53<02:04, 41.53s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:37<01:24, 42.13s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:30<00:45, 45.36s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:14<00:00, 45.00s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:14<00:00, 43.04s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:18,  1.66it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:12,  2.35it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:01<00:10,  2.69it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:09,  2.87it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:08,  3.01it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:02<00:08,  3.08it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.15it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:07,  3.21it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:03<00:06,  3.27it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:04<00:05,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.26it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:05<00:04,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:06<00:03,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:06<00:03,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:03,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:07<00:02,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:08<00:01,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:08<00:01,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:09<00:00,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.41it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.24it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  8.01it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.99it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.89it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.86it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.84it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.82it/s]
postgres_copy_csv

2023-05-12 05:02:08 (1683867728) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 2/5) in 1369.369 seconds



2023-05-12 05:02:08 (1683867728) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_conditions) (function=3/4, repeat=1/1, global 2/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683867743.log
Execution time:  90.79051613807678
execute_postgres_query

2023-05-12 05:04:04 (1683867844) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_conditions) (function=3/4, repeat=1/1, global 2/5) in 116.135 seconds



2023-05-12 05:04:04 (1683867844) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 2/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683867860.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-12 05:04:26 (1683867866) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 2/5) in 22.007 seconds


2023-05-12 05:04:26 (1683867866) Executed test9 (1/1, global 2/5) in 1514.475 seconds



Running test1 (global 3/5)...

2023-05-12 05:04:26 (1683867866) test started

2023-05-12 05:04:26 (1683867866) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/2, repeat=1/1, global 3/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683867867.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-12 05:04:33 (1683867873) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/2, repeat=1/1, global 3/5) in 6.880 seconds



2023-05-12 05:04:33 (1683867873) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/2, repeat=1/1, global 3/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683867883.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f59bfcd5e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:24, 36.82s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:14<18:10, 37.59s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:00<19:19, 41.43s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:43<18:49, 41.85s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:29<18:44, 43.26s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:14<18:16, 43.84s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:57<17:31, 43.83s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:44<17:07, 44.65s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:28<16:19, 44.51s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:08<15:05, 43.14s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:51<14:22, 43.11s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:39<14:05, 44.50s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:28<13:46, 45.93s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:10<12:39, 44.71s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:48<11:25, 42.82s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:26<10:20, 41.35s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:08<09:41, 41.56s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:52<09:07, 42.10s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:42<08:54, 44.50s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:24<08:01, 43.77s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [15:05<07:08, 42.87s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:47<06:24, 42.75s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:26<05:31, 41.50s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:03<04:41, 40.14s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:43<04:01, 40.31s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:35<03:38, 43.67s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:23<02:59, 44.94s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [20:09<02:16, 45.35s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:58<01:33, 46.52s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:39<00:44, 44.86s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:19<00:00, 43.29s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:19<00:00, 43.21s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.99it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.19it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.24it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.23it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.26it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:04,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.49it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.50it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.50it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:05<00:03,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:07<00:01,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.48it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.41it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.99it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.97it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.93it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.91it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.98it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.95it/s]
postgres_copy_csv

2023-05-12 05:27:27 (1683869247) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/2, repeat=1/1, global 3/5) in 1374.047 seconds


2023-05-12 05:27:27 (1683869247) Executed test1 (1/1, global 3/5) in 1380.927 seconds



Running test2 (global 3/5)...

2023-05-12 05:27:27 (1683869247) test started

2023-05-12 05:27:27 (1683869247) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=1/1, repeat=1/1, global 3/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683869252.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-12 05:27:38 (1683869258) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=1/1, repeat=1/1, global 3/5) in 11.015 seconds


2023-05-12 05:27:38 (1683869258) Executed test2 (1/1, global 3/5) in 11.015 seconds



Running test3 (global 3/5)...

2023-05-12 05:27:38 (1683869258) test started

2023-05-12 05:27:38 (1683869258) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=1/3, global 3/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683869259.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-12 05:27:45 (1683869265) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=1/3, global 3/5) in 6.833 seconds



2023-05-12 05:27:45 (1683869265) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=1/3, global 3/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683869275.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f59bfcd5e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:13, 36.43s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:16<18:36, 38.50s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:03<19:46, 42.38s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:44<18:49, 41.82s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:28<18:29, 42.65s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:17<18:40, 44.84s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [05:02<17:56, 44.87s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:45<16:59, 44.34s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:30<16:18, 44.47s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:10<15:08, 43.25s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:52<14:15, 42.76s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:40<14:01, 44.31s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:27<13:32, 45.14s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:14<12:56, 45.65s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:53<11:39, 43.75s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:33<10:36, 42.46s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:11<09:38, 41.31s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:51<08:51, 40.86s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:33<08:12, 41.04s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:20<07:52, 42.97s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [15:10<07:30, 45.01s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:56<06:49, 45.47s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:37<05:51, 43.95s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:14<04:53, 41.97s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:55<04:09, 41.58s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:36<03:28, 41.61s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:18<02:46, 41.54s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [19:59<02:04, 41.57s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:43<01:24, 42.03s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:35<00:45, 45.22s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:21<00:00, 45.26s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:21<00:00, 43.26s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.98it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.10it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.18it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.17it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:08,  3.22it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.20it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.25it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:07,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:06<00:03,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:08<00:01,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:09<00:00,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.10it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.28it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.51it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.49it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.55it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.53it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.57it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.55it/s]
postgres_copy_csv

2023-05-12 05:50:41 (1683870641) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=1/3, global 3/5) in 1376.014 seconds



2023-05-12 05:50:41 (1683870641) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=1/3, global 3/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683870653.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-12 05:51:00 (1683870660) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=1/3, global 3/5) in 19.172 seconds


2023-05-12 05:51:00 (1683870660) Executed test3 (1/3, global 3/5) in 1402.020 seconds

2023-05-12 05:51:00 (1683870660) test started

2023-05-12 05:51:00 (1683870660) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=2/3, global 3/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683870661.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-12 05:51:07 (1683870667) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=2/3, global 3/5) in 7.042 seconds



2023-05-12 05:51:07 (1683870667) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=2/3, global 3/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683870677.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f59bfcd5e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:15, 36.50s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:15<18:27, 38.19s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:01<19:26, 41.65s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:42<18:36, 41.37s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:26<18:22, 42.40s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:13<18:19, 43.97s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:58<17:41, 44.21s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:42<16:56, 44.20s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:26<16:09, 44.05s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:08<15:11, 43.42s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:49<14:12, 42.61s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:35<13:51, 43.75s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:24<13:36, 45.35s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:11<12:57, 45.75s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:50<11:38, 43.65s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:29<10:34, 42.30s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:06<09:32, 40.88s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:45<08:43, 40.28s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:28<08:13, 41.08s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:14<07:47, 42.49s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [15:02<07:20, 44.03s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:52<06:53, 45.96s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:32<05:53, 44.14s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:09<04:54, 42.09s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:50<04:09, 41.56s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:31<03:27, 41.52s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:12<02:46, 41.52s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [19:53<02:03, 41.21s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:36<01:23, 41.86s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:28<00:44, 44.85s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:14<00:00, 45.29s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:14<00:00, 43.06s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:11,  2.71it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  2.99it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.12it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.15it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:08,  3.16it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.21it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.22it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:07,  3.26it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.25it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.27it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:06,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:04<00:05,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:04,  3.18it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.24it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:06<00:03,  3.27it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:03,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:07<00:02,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:08<00:01,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:09<00:00,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.40it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.29it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.93it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.91it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.91it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.89it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.69it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.67it/s]
postgres_copy_csv

2023-05-12 06:13:57 (1683872037) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=2/3, global 3/5) in 1369.849 seconds



2023-05-12 06:13:57 (1683872037) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=2/3, global 3/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683872048.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-12 06:14:15 (1683872055) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=2/3, global 3/5) in 18.052 seconds


2023-05-12 06:14:15 (1683872055) Executed test3 (2/3, global 3/5) in 1394.943 seconds

2023-05-12 06:14:15 (1683872055) test started

2023-05-12 06:14:15 (1683872055) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=3/3, global 3/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683872056.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-12 06:14:22 (1683872062) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=3/3, global 3/5) in 6.964 seconds



2023-05-12 06:14:22 (1683872062) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=3/3, global 3/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683872072.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f59bfcd5e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:16, 36.54s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:14<18:03, 37.36s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:00<19:14, 41.25s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:45<19:20, 42.97s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:31<19:05, 44.05s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:14<18:10, 43.60s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [05:03<18:08, 45.33s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:44<16:49, 43.87s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:26<15:50, 43.21s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:06<14:49, 42.36s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:52<14:26, 43.33s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:40<14:12, 44.85s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:29<13:48, 46.02s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:10<12:39, 44.69s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:49<11:26, 42.91s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:29<10:28, 41.89s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:16<10:11, 43.67s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:58<09:21, 43.16s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:44<08:46, 43.85s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:24<07:49, 42.68s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [15:05<07:01, 42.17s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:47<06:19, 42.17s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:25<05:28, 41.04s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:02<04:38, 39.73s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:47<04:07, 41.20s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:37<03:39, 43.89s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:23<02:58, 44.72s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [20:11<02:16, 45.63s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [21:00<01:33, 46.56s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:42<00:45, 45.29s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:21<00:00, 43.38s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:21<00:00, 43.28s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.85it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.10it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.21it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.26it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:02<00:06,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:04,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.49it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:04<00:03,  3.53it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.54it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.53it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:05<00:03,  3.52it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.49it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.51it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:07<00:01,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.49it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.49it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.40it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.43it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.90it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.88it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.79it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.77it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.84it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.82it/s]
postgres_copy_csv

2023-05-12 06:37:18 (1683873438) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=3/3, global 3/5) in 1376.297 seconds



2023-05-12 06:37:18 (1683873438) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=3/3, global 3/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683873443.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-12 06:37:29 (1683873449) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=3/3, global 3/5) in 11.195 seconds


2023-05-12 06:37:29 (1683873449) Executed test3 (3/3, global 3/5) in 1394.455 seconds



Running test4 (global 3/5)...

2023-05-12 06:37:29 (1683873449) test started

2023-05-12 06:37:29 (1683873449) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 3/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683873451.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-12 06:37:36 (1683873456) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 3/5) in 6.956 seconds



2023-05-12 06:37:36 (1683873456) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 3/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683873467.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f59bfcd5e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:05, 36.19s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:15<18:28, 38.23s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:02<19:32, 41.87s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:43<18:44, 41.64s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:27<18:23, 42.45s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:13<18:17, 43.88s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:58<17:39, 44.15s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:41<16:46, 43.75s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:25<16:01, 43.71s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:07<15:08, 43.24s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:48<14:11, 42.55s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:33<13:45, 43.45s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:23<13:35, 45.29s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:10<13:00, 45.91s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:49<11:39, 43.70s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:28<10:33, 42.26s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:06<09:34, 41.05s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:45<08:46, 40.51s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:25<08:05, 40.42s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:13<07:47, 42.51s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [15:00<07:18, 43.82s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:52<06:56, 46.26s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:31<05:52, 44.08s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:08<04:54, 42.08s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:49<04:10, 41.74s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:31<03:28, 41.73s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:13<02:47, 41.85s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [19:55<02:05, 41.99s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:38<01:24, 42.13s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:27<00:44, 44.40s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:14<00:00, 45.12s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:14<00:00, 43.05s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.89it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.08it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.13it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.18it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:08,  3.19it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.25it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.26it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:07,  3.24it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:06,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:04<00:05,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.24it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:06<00:03,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:08<00:01,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:09<00:00,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.41it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.31it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.80it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.78it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.61it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.59it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.82it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.80it/s]
postgres_copy_csv

2023-05-12 07:00:26 (1683874826) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 3/5) in 1369.489 seconds



2023-05-12 07:00:26 (1683874826) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_update_simple) (function=3/4, repeat=1/1, global 3/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683874841.log
Execution time:  256.28256845474243
execute_postgres_query

2023-05-12 07:05:08 (1683875108) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_update_simple) (function=3/4, repeat=1/1, global 3/5) in 281.820 seconds



2023-05-12 07:05:08 (1683875108) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 3/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683875112.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-12 07:05:18 (1683875118) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 3/5) in 10.699 seconds


2023-05-12 07:05:18 (1683875118) Executed test4 (1/1, global 3/5) in 1668.965 seconds



Running test5 (global 3/5)...

2023-05-12 07:05:18 (1683875118) test started

2023-05-12 07:05:18 (1683875118) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 3/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683875120.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-12 07:05:26 (1683875126) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 3/5) in 7.205 seconds



2023-05-12 07:05:26 (1683875126) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 3/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683875136.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f59bfcd5e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:15, 36.51s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:17<19:00, 39.31s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:00<19:07, 41.00s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:46<19:16, 42.82s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:32<19:01, 43.89s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:17<18:26, 44.27s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:59<17:27, 43.63s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:46<17:05, 44.58s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:30<16:20, 44.58s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:11<15:08, 43.26s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:53<14:18, 42.91s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:41<14:09, 44.71s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:29<13:42, 45.68s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:14<12:51, 45.36s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:53<11:34, 43.38s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:31<10:29, 41.97s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:12<09:39, 41.39s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:56<09:11, 42.46s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:41<08:35, 42.95s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:28<08:06, 44.25s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [15:10<07:16, 43.66s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:52<06:29, 43.27s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:31<05:35, 41.96s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:09<04:44, 40.58s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:49<04:02, 40.44s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:36<03:31, 42.37s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:26<02:58, 44.59s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [20:12<02:15, 45.14s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:59<01:31, 45.58s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:45<00:45, 45.76s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:24<00:00, 43.73s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:24<00:00, 43.36s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.98it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.19it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:02<00:06,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:05<00:03,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:07<00:01,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.49it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.51it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.42it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.94it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.92it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  8.00it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.98it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.94it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.92it/s]
postgres_copy_csv

2023-05-12 07:28:25 (1683876505) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 3/5) in 1379.122 seconds



2023-05-12 07:28:25 (1683876505) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_update_complex) (function=3/4, repeat=1/1, global 3/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683876514.log
Execution time:  92.40022778511047
execute_postgres_query

2023-05-12 07:30:16 (1683876616) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_update_complex) (function=3/4, repeat=1/1, global 3/5) in 111.284 seconds



2023-05-12 07:30:16 (1683876616) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 3/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683876632.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-12 07:30:38 (1683876638) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 3/5) in 22.116 seconds


2023-05-12 07:30:38 (1683876638) Executed test5 (1/1, global 3/5) in 1519.728 seconds



Running test6 (global 3/5)...

2023-05-12 07:30:38 (1683876638) test started

2023-05-12 07:30:38 (1683876638) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 3/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683876639.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-12 07:30:45 (1683876645) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 3/5) in 6.980 seconds



2023-05-12 07:30:45 (1683876645) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 3/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683876655.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f59bfcd5e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:14, 36.50s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:17<19:00, 39.33s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:01<19:19, 41.41s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:47<19:24, 43.14s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:31<18:47, 43.35s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:19<18:48, 45.12s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [05:02<17:44, 44.37s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:45<16:52, 44.01s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:33<16:30, 45.03s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:13<15:14, 43.55s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:55<14:22, 43.13s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:41<13:54, 43.91s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:28<13:27, 44.85s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:15<12:55, 45.62s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:54<11:35, 43.46s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:32<10:29, 42.00s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:10<09:30, 40.72s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:49<08:43, 40.26s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:31<08:08, 40.68s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:14<07:37, 41.58s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [15:04<07:18, 43.87s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:53<06:48, 45.43s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:35<05:54, 44.37s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:12<04:55, 42.21s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:52<04:09, 41.53s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:34<03:28, 41.64s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:16<02:47, 41.83s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [19:57<02:04, 41.63s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:40<01:23, 41.89s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:29<00:44, 44.14s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:16<00:00, 45.14s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:16<00:00, 43.13s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.78it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.01it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.15it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.19it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:08,  3.17it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:08,  3.04it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:08,  2.96it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:07,  2.94it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:03<00:07,  2.86it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:07,  2.99it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:06,  3.07it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:06,  3.10it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:04<00:05,  3.16it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.21it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:05<00:04,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:06<00:03,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:06<00:03,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:07<00:02,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:08<00:01,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:08<00:01,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:09<00:00,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:09<00:00,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.37it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.23it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.16it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.14it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.15it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.13it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.45it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.43it/s]
postgres_copy_csv

2023-05-12 07:53:37 (1683878017) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 3/5) in 1371.815 seconds



2023-05-12 07:53:37 (1683878017) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_single) (function=3/4, repeat=1/1, global 3/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683878031.log
Execution time:  8.699055671691895
execute_postgres_query

2023-05-12 07:54:26 (1683878066) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_single) (function=3/4, repeat=1/1, global 3/5) in 49.222 seconds



2023-05-12 07:54:26 (1683878066) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 3/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683878073.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-12 07:54:40 (1683878080) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 3/5) in 13.804 seconds


2023-05-12 07:54:40 (1683878080) Executed test6 (1/1, global 3/5) in 1441.821 seconds



Running test7 (global 3/5)...

2023-05-12 07:54:40 (1683878080) test started

2023-05-12 07:54:40 (1683878080) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 3/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683878081.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-12 07:54:47 (1683878087) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 3/5) in 7.138 seconds



2023-05-12 07:54:47 (1683878087) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 3/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683878097.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f59bfcd5e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:08, 36.27s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:17<18:55, 39.16s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:00<19:05, 40.92s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:46<19:22, 43.07s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:33<19:15, 44.44s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:16<18:20, 44.01s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:59<17:24, 43.51s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:46<17:09, 44.75s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:31<16:22, 44.68s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:12<15:15, 43.60s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:54<14:22, 43.11s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:43<14:14, 44.95s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:32<13:50, 46.14s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:14<12:45, 45.03s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:53<11:31, 43.22s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:32<10:27, 41.86s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:12<09:38, 41.32s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:56<09:07, 42.09s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:39<08:29, 42.47s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:27<08:04, 44.03s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [15:09<07:13, 43.35s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:51<06:27, 43.04s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:30<05:33, 41.66s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:07<04:43, 40.44s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:48<04:02, 40.44s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:34<03:31, 42.34s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:24<02:58, 44.54s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [20:13<02:17, 45.88s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:59<01:31, 45.91s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:45<00:45, 45.95s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:24<00:00, 43.89s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:24<00:00, 43.38s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.91it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.10it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.20it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.23it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.26it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:05<00:03,  3.51it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:07<00:01,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.47it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.40it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.87it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.85it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.73it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.71it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.87it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.85it/s]
postgres_copy_csv

2023-05-12 08:17:46 (1683879467) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 3/5) in 1379.472 seconds



2023-05-12 08:17:46 (1683879467) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_multi) (function=3/4, repeat=1/1, global 3/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683879476.log
Execution time:  144.32915949821472
execute_postgres_query

2023-05-12 08:20:30 (1683879630) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_multi) (function=3/4, repeat=1/1, global 3/5) in 163.369 seconds



2023-05-12 08:20:30 (1683879630) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 3/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683879642.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-12 08:20:48 (1683879648) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 3/5) in 18.140 seconds


2023-05-12 08:20:48 (1683879648) Executed test7 (1/1, global 3/5) in 1568.120 seconds



Running test8 (global 3/5)...

2023-05-12 08:20:48 (1683879648) test started

2023-05-12 08:20:48 (1683879648) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 3/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683879649.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-12 08:20:55 (1683879655) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 3/5) in 7.041 seconds



2023-05-12 08:20:55 (1683879655) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 3/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683879665.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f59bfcd5e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:21, 36.70s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:14<18:00, 37.26s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:00<19:12, 41.15s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:45<19:19, 42.95s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:31<19:02, 43.96s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:14<18:11, 43.67s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [05:02<18:01, 45.07s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:43<16:43, 43.65s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:25<15:51, 43.23s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:06<14:52, 42.52s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:52<14:29, 43.49s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:38<14:04, 44.47s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:28<13:48, 46.00s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:10<12:40, 44.76s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:49<11:27, 42.94s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:28<10:26, 41.74s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:16<10:13, 43.82s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:59<09:25, 43.47s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:45<08:49, 44.15s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:26<07:55, 43.19s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [15:07<07:06, 42.65s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:50<06:25, 42.88s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:30<05:34, 41.82s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:07<04:42, 40.34s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:51<04:09, 41.66s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:42<03:42, 44.43s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:29<03:01, 45.29s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [20:16<02:16, 45.59s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [21:04<01:32, 46.30s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:46<00:44, 44.97s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:25<00:00, 43.15s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:25<00:00, 43.39s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.97it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.22it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:02<00:06,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:05<00:03,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:07<00:01,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.50it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.41it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.89it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.86it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.91it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.88it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.59it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.58it/s]
postgres_copy_csv

2023-05-12 08:43:55 (1683881035) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 3/5) in 1379.502 seconds



2023-05-12 08:43:55 (1683881035) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_aggregate) (function=3/4, repeat=1/1, global 3/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683881044.log
Execution time:  92.29444622993469
execute_postgres_query

2023-05-12 08:45:46 (1683881146) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_aggregate) (function=3/4, repeat=1/1, global 3/5) in 111.335 seconds



2023-05-12 08:45:46 (1683881146) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 3/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683881167.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-12 08:46:13 (1683881173) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 3/5) in 27.536 seconds


2023-05-12 08:46:13 (1683881173) Executed test8 (1/1, global 3/5) in 1525.414 seconds



Running test9 (global 3/5)...

2023-05-12 08:46:13 (1683881173) test started

2023-05-12 08:46:13 (1683881173) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 3/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683881175.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-12 08:46:21 (1683881181) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 3/5) in 7.430 seconds



2023-05-12 08:46:21 (1683881181) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 3/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683881191.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f59bfcd5e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:19, 36.65s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:17<18:58, 39.24s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:01<19:10, 41.10s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:44<18:51, 41.89s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:30<18:50, 43.47s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:14<18:12, 43.71s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:57<17:25, 43.54s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:42<16:52, 44.01s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:26<16:08, 44.03s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:08<15:10, 43.35s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:50<14:15, 42.79s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:39<14:08, 44.65s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:27<13:41, 45.67s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:13<13:00, 45.91s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:52<11:38, 43.66s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:30<10:33, 42.24s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:10<09:40, 41.50s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:55<09:12, 42.47s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:39<08:34, 42.84s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:27<08:08, 44.42s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [15:08<07:13, 43.38s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:51<06:28, 43.22s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:30<05:36, 42.11s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:07<04:43, 40.45s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:47<04:02, 40.49s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:35<03:33, 42.77s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:24<02:58, 44.68s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [20:12<02:16, 45.39s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:57<01:30, 45.34s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:43<00:45, 45.59s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:23<00:00, 43.80s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:23<00:00, 43.32s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.89it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.12it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.21it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.25it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.49it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:05<00:03,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:07<00:01,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.45it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.40it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.88it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.86it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.82it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.80it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.59it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.57it/s]
postgres_copy_csv

2023-05-12 09:09:18 (1683882558) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 3/5) in 1377.585 seconds



2023-05-12 09:09:18 (1683882558) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_conditions) (function=3/4, repeat=1/1, global 3/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683882568.log
Execution time:  92.11297392845154
execute_postgres_query

2023-05-12 09:11:10 (1683882670) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_conditions) (function=3/4, repeat=1/1, global 3/5) in 111.343 seconds



2023-05-12 09:11:10 (1683882670) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 3/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683882689.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-12 09:11:35 (1683882695) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 3/5) in 25.545 seconds


2023-05-12 09:11:35 (1683882695) Executed test9 (1/1, global 3/5) in 1521.903 seconds



Running test1 (global 4/5)...

2023-05-12 09:11:35 (1683882695) test started

2023-05-12 09:11:35 (1683882695) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/2, repeat=1/1, global 4/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683882697.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-12 09:11:42 (1683882702) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/2, repeat=1/1, global 4/5) in 6.949 seconds



2023-05-12 09:11:42 (1683882702) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/2, repeat=1/1, global 4/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683882712.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f59bfcd5e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:23, 36.78s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:17<18:59, 39.29s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:01<19:18, 41.37s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:45<19:04, 42.40s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:27<18:18, 42.26s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:11<17:51, 42.84s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [05:02<18:11, 45.46s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:42<16:47, 43.79s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:24<15:50, 43.19s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:06<15:00, 42.90s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:55<14:53, 44.67s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:43<14:26, 45.63s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:25<13:21, 44.55s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:07<12:26, 43.93s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:46<11:16, 42.29s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:29<10:37, 42.53s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:13<10:03, 43.08s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:55<09:16, 42.77s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:38<08:32, 42.73s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:18<07:42, 42.02s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:59<06:56, 41.67s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:42<06:18, 42.03s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:26<05:40, 42.53s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:08<04:57, 42.54s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:56<04:24, 44.06s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:46<03:49, 45.85s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:29<02:59, 44.95s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [20:11<02:12, 44.01s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:50<01:25, 42.66s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:33<00:42, 42.58s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:12<00:00, 41.66s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:12<00:00, 42.99s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.93it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.19it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:02<00:06,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:04,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:04<00:04,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.49it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.49it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:05<00:03,  3.49it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:07<00:01,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.45it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.42it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.89it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.86it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.96it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.94it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  8.06it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  8.03it/s]
postgres_copy_csv

2023-05-12 09:34:29 (1683884069) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/2, repeat=1/1, global 4/5) in 1367.043 seconds


2023-05-12 09:34:29 (1683884069) Executed test1 (1/1, global 4/5) in 1373.992 seconds



Running test2 (global 4/5)...

2023-05-12 09:34:29 (1683884069) test started

2023-05-12 09:34:29 (1683884069) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=1/1, repeat=1/1, global 4/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683884074.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-12 09:34:40 (1683884081) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=1/1, repeat=1/1, global 4/5) in 11.183 seconds


2023-05-12 09:34:40 (1683884081) Executed test2 (1/1, global 4/5) in 11.183 seconds



Running test3 (global 4/5)...

2023-05-12 09:34:40 (1683884081) test started

2023-05-12 09:34:40 (1683884081) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=1/3, global 4/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683884082.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-12 09:34:47 (1683884087) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=1/3, global 4/5) in 6.917 seconds



2023-05-12 09:34:47 (1683884087) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=1/3, global 4/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683884098.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f59bfcd5e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:16, 36.56s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:14<18:04, 37.40s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [01:59<19:07, 40.97s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:45<19:13, 42.73s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:29<18:41, 43.14s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:11<17:54, 42.98s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:58<17:43, 44.33s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:40<16:42, 43.58s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:22<15:45, 42.98s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:04<14:56, 42.68s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:49<14:26, 43.31s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:38<14:19, 45.22s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:27<13:54, 46.38s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:09<12:45, 45.03s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:48<11:28, 43.01s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:26<10:24, 41.66s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:12<10:02, 43.06s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:55<09:18, 42.96s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:41<08:46, 43.90s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:22<07:51, 42.82s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [15:03<07:04, 42.45s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:46<06:22, 42.48s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:25<05:31, 41.38s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:02<04:40, 40.08s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:46<04:07, 41.27s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:37<03:41, 44.40s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:24<03:00, 45.20s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [20:13<02:18, 46.17s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [21:00<01:33, 46.51s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:42<00:45, 45.01s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:21<00:00, 43.22s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:21<00:00, 43.26s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.96it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.19it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:02<00:06,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:05<00:03,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:07<00:01,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.48it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.41it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  6.97it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  6.95it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.04it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.03it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.74it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.72it/s]
postgres_copy_csv

2023-05-12 09:57:43 (1683885463) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=1/3, global 4/5) in 1375.608 seconds



2023-05-12 09:57:43 (1683885463) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=1/3, global 4/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683885468.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-12 09:57:54 (1683885474) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=1/3, global 4/5) in 11.294 seconds


2023-05-12 09:57:54 (1683885474) Executed test3 (1/3, global 4/5) in 1393.819 seconds

2023-05-12 09:57:54 (1683885474) test started

2023-05-12 09:57:54 (1683885474) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=2/3, global 4/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683885476.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-12 09:58:01 (1683885481) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=2/3, global 4/5) in 6.881 seconds



2023-05-12 09:58:01 (1683885481) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=2/3, global 4/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683885491.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f59bfcd5e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:23, 36.79s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:16<18:37, 38.54s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:02<19:39, 42.11s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:44<18:46, 41.73s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:29<18:36, 42.93s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:15<18:23, 44.14s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [05:00<17:46, 44.43s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:44<16:55, 44.17s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:27<16:02, 43.75s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:08<15:06, 43.18s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:50<14:11, 42.57s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:36<13:50, 43.68s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:25<13:33, 45.20s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:11<12:53, 45.49s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:51<11:42, 43.91s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:30<10:36, 42.44s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:08<09:35, 41.14s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:47<08:47, 40.54s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:32<08:23, 41.94s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:17<07:48, 42.62s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [15:02<07:13, 43.37s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:54<06:53, 45.91s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:33<05:51, 43.95s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:10<04:53, 41.98s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:51<04:08, 41.49s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:32<03:27, 41.45s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:14<02:46, 41.71s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [19:56<02:05, 41.72s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:40<01:24, 42.44s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:31<00:45, 45.02s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:17<00:00, 45.12s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:17<00:00, 43.13s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.97it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.08it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.21it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.24it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:08,  3.20it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.20it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.24it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:07,  3.27it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:06,  3.27it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.27it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:04<00:05,  3.24it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.22it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.25it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:06<00:03,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:03,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:07<00:02,  3.26it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:08<00:01,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:09<00:00,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.37it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.29it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.86it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.84it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.55it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.53it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.48it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.46it/s]
postgres_copy_csv

2023-05-12 10:20:53 (1683886853) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=2/3, global 4/5) in 1372.119 seconds



2023-05-12 10:20:53 (1683886853) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=2/3, global 4/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683886866.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-12 10:21:14 (1683886874) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=2/3, global 4/5) in 20.350 seconds


2023-05-12 10:21:14 (1683886874) Executed test3 (2/3, global 4/5) in 1399.350 seconds

2023-05-12 10:21:14 (1683886874) test started

2023-05-12 10:21:14 (1683886874) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=3/3, global 4/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683886875.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-12 10:21:21 (1683886881) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=3/3, global 4/5) in 7.036 seconds



2023-05-12 10:21:21 (1683886881) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=3/3, global 4/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683886891.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f59bfcd5e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:23, 36.80s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:14<18:02, 37.32s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:00<19:14, 41.22s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:45<19:19, 42.95s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:29<18:46, 43.31s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:12<17:56, 43.07s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:59<17:41, 44.22s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:39<16:32, 43.16s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:21<15:37, 42.63s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:02<14:48, 42.29s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:49<14:28, 43.44s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:36<14:06, 44.56s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:24<13:45, 45.86s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:06<12:38, 44.62s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:46<11:28, 43.04s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:24<10:25, 41.71s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:11<10:04, 43.15s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:54<09:21, 43.21s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:39<08:45, 43.77s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:20<07:51, 42.84s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [15:01<07:04, 42.43s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:44<06:23, 42.63s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:23<05:32, 41.57s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:00<04:41, 40.18s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:44<04:08, 41.33s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:35<03:39, 43.95s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:22<03:00, 45.00s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [20:09<02:16, 45.62s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:55<01:31, 45.71s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:36<00:44, 44.40s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:15<00:00, 42.71s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:15<00:00, 43.08s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.94it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.17it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:02<00:06,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:04,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:05<00:03,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:07<00:01,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.47it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.40it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  8.07it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  8.05it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.98it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.96it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.97it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.95it/s]
postgres_copy_csv

2023-05-12 10:44:11 (1683888251) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=3/3, global 4/5) in 1369.982 seconds



2023-05-12 10:44:11 (1683888251) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=3/3, global 4/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683888256.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-12 10:44:22 (1683888262) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=3/3, global 4/5) in 11.045 seconds


2023-05-12 10:44:22 (1683888262) Executed test3 (3/3, global 4/5) in 1388.064 seconds



Running test4 (global 4/5)...

2023-05-12 10:44:22 (1683888262) test started

2023-05-12 10:44:22 (1683888262) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 4/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683888263.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-12 10:44:29 (1683888269) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 4/5) in 7.109 seconds



2023-05-12 10:44:29 (1683888269) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 4/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683888279.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f59bfcd5e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:04, 36.14s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:14<18:03, 37.36s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [01:59<19:08, 41.01s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:40<18:23, 40.88s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:24<18:09, 41.89s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:12<18:25, 44.21s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:58<17:54, 44.78s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:36<16:19, 42.58s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:20<15:43, 42.87s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:04<15:13, 43.48s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:53<14:57, 44.89s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:38<14:13, 44.94s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:18<13:05, 43.65s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:01<12:14, 43.22s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:43<11:29, 43.12s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:27<10:47, 43.16s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:14<10:21, 44.40s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:55<09:22, 43.27s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:34<08:24, 42.00s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:13<07:33, 41.25s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:54<06:50, 41.04s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:41<06:27, 43.07s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:26<05:47, 43.47s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:08<05:01, 43.05s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:53<04:22, 43.68s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:39<03:41, 44.25s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:20<02:53, 43.35s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [20:01<02:08, 42.73s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:41<01:23, 41.81s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:22<00:41, 41.75s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:03<00:00, 41.42s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:03<00:00, 42.70s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:09,  3.02it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.22it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:02<00:06,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:04,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:04<00:04,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:05<00:03,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:07<00:01,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.48it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.43it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.91it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.89it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.99it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.96it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.87it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.85it/s]
postgres_copy_csv

2023-05-12 11:07:07 (1683889627) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 4/5) in 1358.405 seconds



2023-05-12 11:07:07 (1683889627) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_update_simple) (function=3/4, repeat=1/1, global 4/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683889636.log
Execution time:  285.2359654903412
execute_postgres_query

2023-05-12 11:12:11 (1683889931) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_update_simple) (function=3/4, repeat=1/1, global 4/5) in 304.152 seconds



2023-05-12 11:12:11 (1683889931) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 4/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683889948.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-12 11:12:35 (1683889955) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 4/5) in 23.551 seconds


2023-05-12 11:12:35 (1683889955) Executed test4 (1/1, global 4/5) in 1693.216 seconds



Running test5 (global 4/5)...

2023-05-12 11:12:35 (1683889955) test started

2023-05-12 11:12:35 (1683889955) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 4/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683889956.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-12 11:12:42 (1683889962) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 4/5) in 7.005 seconds



2023-05-12 11:12:42 (1683889962) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 4/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683889972.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f59bfcd5e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:07, 36.25s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:18<19:05, 39.51s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:01<19:16, 41.29s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:46<19:16, 42.83s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:32<19:03, 43.99s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:17<18:28, 44.36s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [05:00<17:32, 43.86s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:48<17:18, 45.16s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:30<16:13, 44.26s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:11<15:03, 43.05s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:53<14:14, 42.72s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:41<14:04, 44.43s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:32<13:58, 46.57s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:14<12:45, 45.05s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:54<11:34, 43.39s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:32<10:29, 41.93s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:14<09:46, 41.92s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:56<09:06, 42.01s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:41<08:35, 42.95s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:28<08:03, 43.97s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [15:10<07:13, 43.34s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:52<06:26, 42.99s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:30<05:32, 41.61s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:08<04:42, 40.35s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:48<04:02, 40.35s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:35<03:32, 42.43s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:21<02:54, 43.60s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [20:12<02:16, 45.62s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:58<01:31, 45.68s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:42<00:45, 45.41s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:22<00:00, 43.58s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:22<00:00, 43.30s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.88it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.11it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.25it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:02<00:06,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:05<00:03,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:07<00:01,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.39it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.39it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.44it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.41it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.42it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.41it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.37it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.35it/s]
postgres_copy_csv

2023-05-12 11:35:39 (1683891339) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 4/5) in 1376.910 seconds



2023-05-12 11:35:39 (1683891339) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_update_complex) (function=3/4, repeat=1/1, global 4/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683891348.log
Execution time:  92.543790102005
execute_postgres_query

2023-05-12 11:37:30 (1683891450) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_update_complex) (function=3/4, repeat=1/1, global 4/5) in 111.416 seconds



2023-05-12 11:37:30 (1683891450) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 4/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683891470.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-12 11:37:56 (1683891476) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 4/5) in 26.043 seconds


2023-05-12 11:37:56 (1683891476) Executed test5 (1/1, global 4/5) in 1521.375 seconds



Running test6 (global 4/5)...

2023-05-12 11:37:56 (1683891476) test started

2023-05-12 11:37:56 (1683891476) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 4/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683891478.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-12 11:38:03 (1683891483) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 4/5) in 6.916 seconds



2023-05-12 11:38:03 (1683891483) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 4/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683891493.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f59bfcd5e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:16, 36.53s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:18<19:10, 39.66s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:02<19:25, 41.63s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:46<19:08, 42.55s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:28<18:20, 42.34s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:12<17:54, 42.98s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [05:02<18:03, 45.15s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:42<16:41, 43.53s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:23<15:44, 42.95s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:04<14:46, 42.20s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:53<14:49, 44.46s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:42<14:27, 45.66s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:23<13:15, 44.18s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:05<12:21, 43.64s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:43<11:12, 42.02s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:27<10:36, 42.42s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:11<10:01, 42.99s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:53<09:15, 42.73s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:38<08:39, 43.26s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:17<07:43, 42.09s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:59<07:00, 42.04s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:42<06:21, 42.36s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:24<05:37, 42.14s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:09<05:01, 43.06s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:58<04:30, 45.04s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:42<03:42, 44.49s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:26<02:57, 44.50s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [20:08<02:10, 43.60s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:48<01:24, 42.50s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:29<00:42, 42.06s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:08<00:00, 41.23s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:08<00:00, 42.85s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.99it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.20it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.19it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.21it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.49it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.51it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.51it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:05<00:03,  3.50it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.50it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.50it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.49it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:07<00:01,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.50it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.52it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.41it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.96it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.94it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  8.17it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  8.15it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  8.06it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  8.04it/s]
postgres_copy_csv

2023-05-12 12:00:47 (1683892847) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 4/5) in 1363.470 seconds



2023-05-12 12:00:47 (1683892847) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_single) (function=3/4, repeat=1/1, global 4/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683892856.log
Execution time:  7.993616819381714
execute_postgres_query

2023-05-12 12:01:31 (1683892891) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_single) (function=3/4, repeat=1/1, global 4/5) in 44.116 seconds



2023-05-12 12:01:31 (1683892891) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 4/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683892899.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-12 12:01:47 (1683892907) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 4/5) in 15.679 seconds


2023-05-12 12:01:47 (1683892907) Executed test6 (1/1, global 4/5) in 1430.181 seconds



Running test7 (global 4/5)...

2023-05-12 12:01:47 (1683892907) test started

2023-05-12 12:01:47 (1683892907) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 4/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683892908.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-12 12:01:54 (1683892914) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 4/5) in 6.994 seconds



2023-05-12 12:01:54 (1683892914) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 4/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683892924.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f59bfcd5e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:14, 36.47s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:16<18:41, 38.68s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:02<19:36, 42.02s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:44<18:48, 41.78s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:28<18:34, 42.87s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:15<18:22, 44.11s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [05:00<17:44, 44.37s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:43<16:50, 43.92s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:26<15:59, 43.61s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:07<15:02, 42.99s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:49<14:13, 42.67s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:35<13:50, 43.69s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:23<13:29, 44.95s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:10<12:56, 45.68s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:51<11:45, 44.09s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:30<10:38, 42.55s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:09<09:40, 41.44s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:48<08:49, 40.71s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:33<08:24, 42.07s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:17<07:48, 42.61s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [15:02<07:14, 43.45s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:55<06:55, 46.15s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:34<05:53, 44.17s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:11<04:53, 41.98s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:51<04:07, 41.32s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:33<03:27, 41.41s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:15<02:47, 41.78s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [19:56<02:04, 41.46s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:42<01:25, 42.95s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:28<00:43, 43.72s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:16<00:00, 44.98s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:16<00:00, 43.11s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.99it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.11it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.20it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.21it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.25it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.27it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:06,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.26it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.09it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:05,  3.12it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.21it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:06<00:03,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:07<00:02,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:08<00:01,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:09<00:00,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.37it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.31it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.66it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.64it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.76it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.73it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.65it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.63it/s]
postgres_copy_csv

2023-05-12 12:24:45 (1683894285) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 4/5) in 1371.426 seconds



2023-05-12 12:24:45 (1683894285) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_multi) (function=3/4, repeat=1/1, global 4/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683894302.log
Execution time:  144.60146403312683
execute_postgres_query

2023-05-12 12:27:36 (1683894456) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_multi) (function=3/4, repeat=1/1, global 4/5) in 171.451 seconds



2023-05-12 12:27:36 (1683894456) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 4/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683894473.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-12 12:28:00 (1683894480) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 4/5) in 23.272 seconds


2023-05-12 12:28:00 (1683894480) Executed test7 (1/1, global 4/5) in 1573.143 seconds



Running test8 (global 4/5)...

2023-05-12 12:28:00 (1683894480) test started

2023-05-12 12:28:00 (1683894480) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 4/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683894481.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-12 12:28:07 (1683894487) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 4/5) in 7.234 seconds



2023-05-12 12:28:07 (1683894487) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 4/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683894497.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f59bfcd5e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:37<18:39, 37.33s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:15<18:14, 37.75s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:01<19:23, 41.57s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:45<19:09, 42.56s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:29<18:42, 43.18s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:11<17:48, 42.72s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:57<17:27, 43.66s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:42<16:52, 44.00s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:24<15:54, 43.38s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:05<14:55, 42.66s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:48<14:17, 42.87s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:38<14:16, 45.06s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:21<13:22, 44.57s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:03<12:24, 43.82s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:42<11:14, 42.14s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:21<10:17, 41.17s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:04<09:44, 41.74s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:50<09:18, 43.00s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:33<08:38, 43.19s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:14<07:46, 42.38s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:54<06:58, 41.83s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:37<06:17, 41.97s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:15<05:27, 40.98s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [16:57<04:47, 41.14s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:45<04:20, 43.38s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:34<03:45, 45.03s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:24<03:05, 46.46s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [20:07<02:15, 45.30s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:45<01:26, 43.29s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:27<00:42, 42.82s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:06<00:00, 41.66s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:06<00:00, 42.79s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.96it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.16it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.26it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.17it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:05,  3.20it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:05<00:03,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.19it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:08<00:01,  3.26it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.47it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.35it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.83it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.81it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.70it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.68it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.56it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.54it/s]
postgres_copy_csv

2023-05-12 12:50:48 (1683895848) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 4/5) in 1361.330 seconds



2023-05-12 12:50:48 (1683895848) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_aggregate) (function=3/4, repeat=1/1, global 4/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683895857.log
Execution time:  92.02053332328796
execute_postgres_query

2023-05-12 12:52:39 (1683895959) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_aggregate) (function=3/4, repeat=1/1, global 4/5) in 110.849 seconds



2023-05-12 12:52:39 (1683895959) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 4/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683895981.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-12 12:53:07 (1683895987) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 4/5) in 27.481 seconds


2023-05-12 12:53:07 (1683895987) Executed test8 (1/1, global 4/5) in 1506.894 seconds



Running test9 (global 4/5)...

2023-05-12 12:53:07 (1683895987) test started

2023-05-12 12:53:07 (1683895987) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 4/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683895988.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-12 12:53:14 (1683895994) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 4/5) in 7.069 seconds



2023-05-12 12:53:14 (1683895994) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 4/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683896004.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f59bfcd5e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:37<18:34, 37.15s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:18<19:02, 39.39s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:01<19:12, 41.16s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:46<19:15, 42.78s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:33<19:05, 44.07s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:18<18:37, 44.71s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [05:01<17:33, 43.88s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:47<17:04, 44.55s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:31<16:18, 44.50s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:11<15:06, 43.16s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:53<14:13, 42.68s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:42<14:08, 44.65s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:31<13:47, 45.98s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:13<12:39, 44.70s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:51<11:26, 42.89s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:30<10:23, 41.57s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:10<09:35, 41.12s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:56<09:12, 42.47s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:40<08:35, 42.99s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:28<08:08, 44.45s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [15:10<07:17, 43.76s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:53<06:32, 43.60s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:32<05:38, 42.29s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:09<04:45, 40.74s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:50<04:04, 40.81s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:39<03:35, 43.04s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:27<02:58, 44.59s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [20:13<02:15, 45.05s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:59<01:30, 45.43s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:44<00:45, 45.21s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:23<00:00, 43.43s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:23<00:00, 43.34s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.99it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.18it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:02<00:06,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:04,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:04<00:04,  3.50it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.51it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.50it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:05<00:03,  3.50it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.49it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:07<00:01,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.48it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.43it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.91it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.89it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  8.02it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  8.00it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.89it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.86it/s]
postgres_copy_csv

2023-05-12 13:16:12 (1683897372) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 4/5) in 1378.879 seconds



2023-05-12 13:16:12 (1683897372) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_conditions) (function=3/4, repeat=1/1, global 4/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683897382.log
Execution time:  92.12064385414124
execute_postgres_query

2023-05-12 13:18:04 (1683897484) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_conditions) (function=3/4, repeat=1/1, global 4/5) in 111.425 seconds



2023-05-12 13:18:04 (1683897484) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 4/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683897504.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-12 13:18:30 (1683897510) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 4/5) in 26.265 seconds


2023-05-12 13:18:30 (1683897510) Executed test9 (1/1, global 4/5) in 1523.639 seconds



Running test1 (global 5/5)...

2023-05-12 13:18:30 (1683897510) test started

2023-05-12 13:18:30 (1683897510) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/2, repeat=1/1, global 5/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683897511.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-12 13:18:37 (1683897517) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/2, repeat=1/1, global 5/5) in 7.084 seconds



2023-05-12 13:18:37 (1683897517) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/2, repeat=1/1, global 5/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683897527.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f59bfcd5e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:14, 36.49s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:15<18:16, 37.80s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:01<19:23, 41.54s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:47<19:34, 43.48s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:31<18:56, 43.71s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:14<18:05, 43.42s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [05:03<18:05, 45.25s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:43<16:39, 43.45s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:24<15:39, 42.72s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:06<14:50, 42.39s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:52<14:30, 43.50s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:40<14:16, 45.08s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:27<13:42, 45.67s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:09<12:34, 44.36s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:48<11:28, 43.01s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:28<10:31, 42.07s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:12<09:56, 42.60s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:59<09:31, 43.98s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:45<08:55, 44.59s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:26<07:56, 43.28s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [15:07<07:07, 42.77s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:50<06:25, 42.86s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:31<05:37, 42.15s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:14<04:56, 42.33s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [18:02<04:25, 44.19s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:47<03:42, 44.52s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:30<02:56, 44.08s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [20:12<02:09, 43.19s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:51<01:23, 41.93s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:33<00:42, 42.18s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:12<00:00, 41.14s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:12<00:00, 42.98s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:09,  3.01it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:08,  3.23it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:02<00:06,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:05<00:03,  3.49it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.49it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.50it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:07<00:01,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.50it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.43it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.96it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.93it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.95it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.93it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.95it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.92it/s]
postgres_copy_csv

2023-05-12 13:41:24 (1683898884) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/2, repeat=1/1, global 5/5) in 1367.207 seconds


2023-05-12 13:41:24 (1683898884) Executed test1 (1/1, global 5/5) in 1374.291 seconds



Running test2 (global 5/5)...

2023-05-12 13:41:24 (1683898884) test started

2023-05-12 13:41:24 (1683898884) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=1/1, repeat=1/1, global 5/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683898890.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-12 13:41:36 (1683898896) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=1/1, repeat=1/1, global 5/5) in 11.371 seconds


2023-05-12 13:41:36 (1683898896) Executed test2 (1/1, global 5/5) in 11.371 seconds



Running test3 (global 5/5)...

2023-05-12 13:41:36 (1683898896) test started

2023-05-12 13:41:36 (1683898896) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=1/3, global 5/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683898897.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-12 13:41:43 (1683898903) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=1/3, global 5/5) in 7.108 seconds



2023-05-12 13:41:43 (1683898903) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=1/3, global 5/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683898913.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f59bfcd5e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:08, 36.29s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:14<18:13, 37.69s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:00<19:13, 41.20s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:41<18:37, 41.38s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:25<18:20, 42.31s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:13<18:20, 44.01s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:59<17:53, 44.73s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:37<16:21, 42.65s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:20<15:38, 42.67s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:06<15:21, 43.88s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:54<14:59, 44.95s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:38<14:11, 44.81s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:19<13:04, 43.59s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:01<12:10, 42.99s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:44<11:29, 43.07s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:27<10:43, 42.91s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:13<10:17, 44.10s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:52<09:11, 42.40s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:32<08:21, 41.76s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:12<07:32, 41.12s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:52<06:49, 40.92s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:40<06:28, 43.11s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:24<05:47, 43.39s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:07<05:01, 43.13s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:55<04:26, 44.46s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:40<03:43, 44.70s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:22<02:55, 43.81s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [20:03<02:09, 43.11s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:43<01:24, 42.10s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:24<00:41, 41.96s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:04<00:00, 41.40s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:04<00:00, 42.74s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.97it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.20it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:02<00:06,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:04,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:04<00:04,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:05<00:03,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:03,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:07<00:01,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.50it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.41it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.87it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.85it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.87it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.85it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.99it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.97it/s]
postgres_copy_csv

2023-05-12 14:04:23 (1683900263) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=1/3, global 5/5) in 1359.770 seconds



2023-05-12 14:04:23 (1683900263) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=1/3, global 5/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683900268.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-12 14:04:34 (1683900274) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=1/3, global 5/5) in 11.093 seconds


2023-05-12 14:04:34 (1683900274) Executed test3 (1/3, global 5/5) in 1377.971 seconds

2023-05-12 14:04:34 (1683900274) test started

2023-05-12 14:04:34 (1683900274) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=2/3, global 5/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683900275.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-12 14:04:41 (1683900281) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=2/3, global 5/5) in 7.345 seconds



2023-05-12 14:04:41 (1683900281) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=2/3, global 5/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683900291.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f59bfcd5e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:24, 36.81s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:15<18:24, 38.08s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:02<19:31, 41.85s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:43<18:43, 41.62s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:27<18:26, 42.54s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:15<18:27, 44.31s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [05:01<17:55, 44.79s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:38<16:18, 42.54s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:21<15:39, 42.71s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:09<15:29, 44.28s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:56<15:01, 45.08s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:41<14:14, 44.99s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:21<13:02, 43.47s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:03<12:09, 42.93s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:48<11:39, 43.72s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:31<10:53, 43.55s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:14<10:07, 43.42s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:58<09:24, 43.46s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:37<08:24, 42.06s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:17<07:36, 41.50s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:57<06:52, 41.22s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:45<06:27, 43.08s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:30<05:49, 43.70s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:13<05:04, 43.52s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [18:00<04:27, 44.55s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:42<03:39, 43.82s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:24<02:53, 43.36s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [20:05<02:07, 42.63s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:44<01:22, 41.50s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:26<00:41, 41.59s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:06<00:00, 40.98s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:06<00:00, 42.78s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.96it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.19it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:02<00:06,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:04,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:05<00:03,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:07<00:01,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.49it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.41it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  8.07it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  8.05it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  8.07it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  8.05it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.83it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.81it/s]
postgres_copy_csv

2023-05-12 14:27:22 (1683901642) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=2/3, global 5/5) in 1360.666 seconds



2023-05-12 14:27:22 (1683901642) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=2/3, global 5/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683901647.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-12 14:27:33 (1683901653) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=2/3, global 5/5) in 11.204 seconds


2023-05-12 14:27:33 (1683901653) Executed test3 (2/3, global 5/5) in 1379.215 seconds

2023-05-12 14:27:33 (1683901653) test started

2023-05-12 14:27:33 (1683901653) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=3/3, global 5/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683901654.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-12 14:27:40 (1683901660) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=3/3, global 5/5) in 7.018 seconds



2023-05-12 14:27:40 (1683901660) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=3/3, global 5/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683901670.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f59bfcd5e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:00, 36.02s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:14<18:02, 37.33s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:00<19:21, 41.50s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:46<19:30, 43.36s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:29<18:35, 42.92s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:11<17:50, 42.81s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [05:01<17:59, 44.99s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:40<16:34, 43.23s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:21<15:36, 42.59s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:03<14:46, 42.22s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:47<14:19, 43.00s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:34<13:58, 44.13s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:21<13:31, 45.09s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:03<12:28, 44.03s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:41<11:17, 42.33s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:20<10:18, 41.22s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:05<09:52, 42.35s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:54<09:35, 44.28s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:36<08:43, 43.61s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:19<07:59, 43.58s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [15:00<07:06, 42.65s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:43<06:24, 42.69s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:22<05:33, 41.64s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [16:59<04:42, 40.33s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:44<04:10, 41.70s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:35<03:42, 44.54s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:22<03:01, 45.30s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [20:10<02:17, 45.97s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:54<01:30, 45.34s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:35<00:44, 44.23s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:15<00:00, 42.79s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:15<00:00, 43.07s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:09,  3.01it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:08,  3.24it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:02<00:06,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:04,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:04<00:04,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:05<00:03,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:07<00:01,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.49it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.43it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.63it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.61it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.66it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.64it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.50it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.48it/s]
postgres_copy_csv

2023-05-12 14:50:30 (1683903030) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=3/3, global 5/5) in 1370.011 seconds



2023-05-12 14:50:30 (1683903030) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=3/3, global 5/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683903035.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-12 14:50:41 (1683903041) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=3/3, global 5/5) in 11.058 seconds


2023-05-12 14:50:41 (1683903041) Executed test3 (3/3, global 5/5) in 1388.087 seconds



Running test4 (global 5/5)...

2023-05-12 14:50:41 (1683903041) test started

2023-05-12 14:50:41 (1683903041) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 5/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683903042.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-12 14:50:48 (1683903048) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 5/5) in 6.896 seconds



2023-05-12 14:50:48 (1683903048) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 5/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683903058.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f59bfcd5e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:27, 36.91s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:17<18:44, 38.79s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:00<19:06, 40.96s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:42<18:36, 41.35s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:28<18:39, 43.04s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:16<18:34, 44.58s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [05:00<17:50, 44.59s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:43<16:51, 43.98s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:27<16:09, 44.07s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:09<15:12, 43.46s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:50<14:14, 42.74s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:38<14:02, 44.33s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:25<13:29, 44.99s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:12<12:56, 45.70s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:52<11:42, 43.90s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:32<10:39, 42.66s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:10<09:39, 41.36s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:50<08:50, 40.85s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:35<08:25, 42.10s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:21<07:56, 43.32s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [15:10<07:29, 44.93s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [16:00<07:00, 46.71s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:40<05:56, 44.56s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:17<04:56, 42.35s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:58<04:11, 41.92s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:39<03:28, 41.70s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:27<02:53, 43.44s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [20:14<02:14, 44.73s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [21:02<01:31, 45.62s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:55<00:47, 47.65s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:39<00:00, 46.54s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:39<00:00, 43.84s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.97it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.19it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.27it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.22it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:08,  3.21it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.25it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:05<00:03,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:08<00:01,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.44it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.37it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.86it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.84it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.71it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.69it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.64it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.62it/s]
postgres_copy_csv

2023-05-12 15:14:02 (1683904442) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 5/5) in 1393.846 seconds



2023-05-12 15:14:02 (1683904442) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_update_simple) (function=3/4, repeat=1/1, global 5/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683904451.log
Execution time:  240.13398146629333
execute_postgres_query

2023-05-12 15:18:21 (1683904701) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_update_simple) (function=3/4, repeat=1/1, global 5/5) in 259.283 seconds



2023-05-12 15:18:21 (1683904701) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 5/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683904706.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-12 15:18:32 (1683904712) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 5/5) in 11.291 seconds


2023-05-12 15:18:32 (1683904712) Executed test4 (1/1, global 5/5) in 1671.316 seconds



Running test5 (global 5/5)...

2023-05-12 15:18:32 (1683904712) test started

2023-05-12 15:18:32 (1683904712) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 5/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683904714.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-12 15:18:39 (1683904719) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 5/5) in 7.057 seconds



2023-05-12 15:18:39 (1683904719) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 5/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683904730.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f59bfcd5e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:37<18:41, 37.37s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:16<18:42, 38.69s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:03<19:47, 42.39s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:45<19:02, 42.31s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:30<18:38, 43.03s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:19<18:49, 45.16s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [05:05<18:13, 45.57s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:44<16:39, 43.46s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:29<16:05, 43.90s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:16<15:38, 44.71s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [08:06<15:27, 46.37s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:50<14:26, 45.63s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:35<13:36, 45.33s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:22<13:04, 46.13s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [11:05<12:01, 45.08s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:44<10:48, 43.23s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:23<09:46, 41.93s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [13:03<08:57, 41.31s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:46<08:21, 41.75s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:33<07:59, 43.55s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [15:23<07:32, 45.28s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [16:06<06:41, 44.59s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:45<05:45, 43.13s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:24<04:52, 41.85s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [18:06<04:11, 41.89s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:48<03:29, 41.96s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:36<02:54, 43.52s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [20:23<02:14, 44.79s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [21:14<01:33, 46.54s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [22:02<00:46, 46.98s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:46<00:00, 46.16s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:46<00:00, 44.09s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.86it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.07it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.16it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.19it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:08,  3.21it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.24it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.26it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:06,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.27it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:04<00:05,  3.15it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.22it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.26it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:06<00:03,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:03,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:07<00:02,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:08<00:01,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:09<00:00,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.37it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.29it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.53it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.51it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.39it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.37it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.34it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.32it/s]
postgres_copy_csv

2023-05-12 15:42:01 (1683906121) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 5/5) in 1401.451 seconds



2023-05-12 15:42:01 (1683906121) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_update_complex) (function=3/4, repeat=1/1, global 5/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683906130.log
Execution time:  92.35862708091736
execute_postgres_query

2023-05-12 15:43:52 (1683906232) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_update_complex) (function=3/4, repeat=1/1, global 5/5) in 111.237 seconds



2023-05-12 15:43:52 (1683906232) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 5/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683906249.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-12 15:44:15 (1683906255) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 5/5) in 23.137 seconds


2023-05-12 15:44:15 (1683906255) Executed test5 (1/1, global 5/5) in 1542.882 seconds



Running test6 (global 5/5)...

2023-05-12 15:44:15 (1683906255) test started

2023-05-12 15:44:15 (1683906255) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 5/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683906257.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-12 15:44:22 (1683906262) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 5/5) in 7.003 seconds



2023-05-12 15:44:22 (1683906262) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 5/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683906273.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f59bfcd5e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:37<18:42, 37.42s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:17<18:46, 38.83s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:03<19:43, 42.27s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:45<18:57, 42.13s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:30<18:43, 43.23s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:18<18:42, 44.88s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [05:04<18:06, 45.28s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:48<17:09, 44.76s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:34<16:33, 45.15s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:15<15:23, 43.99s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:58<14:32, 43.63s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:46<14:13, 44.92s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:32<13:34, 45.26s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:19<12:56, 45.65s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:58<11:40, 43.75s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:38<10:37, 42.52s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:17<09:40, 41.47s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:57<08:55, 41.18s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:41<08:25, 42.10s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:28<07:58, 43.50s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [15:18<07:33, 45.35s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [16:04<06:48, 45.42s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:42<05:47, 43.41s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:20<04:51, 41.69s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [18:01<04:09, 41.55s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:44<03:29, 41.98s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:27<02:49, 42.29s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [20:09<02:06, 42.18s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:56<01:27, 43.56s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:45<00:45, 45.14s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:30<00:00, 45.12s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:30<00:00, 43.56s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:11,  2.60it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:10,  2.85it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:01<00:09,  3.00it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.11it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:08,  3.12it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.17it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.17it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:07,  3.17it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.25it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.27it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:06,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:04<00:05,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.27it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:06<00:03,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:07<00:02,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:08<00:01,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:09<00:00,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.37it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.28it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.58it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.56it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.69it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.66it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.43it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.41it/s]
postgres_copy_csv

2023-05-12 16:07:28 (1683907648) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 5/5) in 1385.331 seconds



2023-05-12 16:07:28 (1683907648) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_single) (function=3/4, repeat=1/1, global 5/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683907659.log
Execution time:  8.707451343536377
execute_postgres_query

2023-05-12 16:08:15 (1683907695) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_single) (function=3/4, repeat=1/1, global 5/5) in 46.943 seconds



2023-05-12 16:08:15 (1683907695) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 5/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683907699.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-12 16:08:25 (1683907705) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 5/5) in 10.349 seconds


2023-05-12 16:08:25 (1683907705) Executed test6 (1/1, global 5/5) in 1449.627 seconds



Running test7 (global 5/5)...

2023-05-12 16:08:25 (1683907705) test started

2023-05-12 16:08:25 (1683907705) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 5/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683907706.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-12 16:08:32 (1683907712) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 5/5) in 6.910 seconds



2023-05-12 16:08:32 (1683907712) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 5/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683907722.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f59bfcd5e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:37<18:31, 37.06s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:18<19:01, 39.36s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:01<19:20, 41.45s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:47<19:25, 43.18s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:33<19:09, 44.19s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:20<18:43, 44.93s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [05:03<17:43, 44.31s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:48<17:07, 44.66s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:34<16:30, 45.02s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:15<15:17, 43.69s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:58<14:30, 43.51s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:48<14:23, 45.46s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:36<13:55, 46.43s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:19<12:50, 45.31s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:58<11:36, 43.52s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:37<10:31, 42.12s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:18<09:45, 41.85s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [13:03<09:14, 42.67s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:47<08:38, 43.18s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:36<08:13, 44.88s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [15:18<07:18, 43.86s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [16:00<06:31, 43.51s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:39<05:36, 42.06s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:17<04:46, 40.86s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:58<04:05, 40.89s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:48<03:38, 43.63s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:37<03:01, 45.32s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [20:26<02:18, 46.23s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [21:12<01:32, 46.31s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:55<00:45, 45.20s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:34<00:00, 43.47s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:34<00:00, 43.70s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.93it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.13it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.25it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:05<00:03,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:08<00:01,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.41it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.35it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.70it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.68it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.74it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.72it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.80it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.78it/s]
postgres_copy_csv

2023-05-12 16:31:41 (1683909101) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 5/5) in 1389.458 seconds



2023-05-12 16:31:41 (1683909101) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_multi) (function=3/4, repeat=1/1, global 5/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683909111.log
Execution time:  148.07663321495056
execute_postgres_query

2023-05-12 16:34:28 (1683909268) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_multi) (function=3/4, repeat=1/1, global 5/5) in 166.967 seconds



2023-05-12 16:34:28 (1683909268) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 5/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683909281.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-12 16:34:47 (1683909287) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 5/5) in 18.355 seconds


2023-05-12 16:34:47 (1683909287) Executed test7 (1/1, global 5/5) in 1581.689 seconds



Running test8 (global 5/5)...

2023-05-12 16:34:47 (1683909287) test started

2023-05-12 16:34:47 (1683909287) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 5/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683909288.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-12 16:34:54 (1683909294) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 5/5) in 6.940 seconds



2023-05-12 16:34:54 (1683909294) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 5/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683909304.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f59bfcd5e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:37<18:40, 37.35s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:19<19:19, 39.99s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:03<19:39, 42.12s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:50<19:46, 43.96s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:33<18:50, 43.49s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:18<18:18, 43.94s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [05:10<18:38, 46.61s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:49<16:59, 44.35s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:32<16:02, 43.75s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:13<15:04, 43.07s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [08:05<15:16, 45.84s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:53<14:42, 46.46s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:34<13:24, 44.69s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:16<12:28, 44.00s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:55<11:19, 42.49s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:40<10:46, 43.09s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:24<10:07, 43.37s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [13:09<09:33, 44.10s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:52<08:43, 43.59s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:32<07:48, 42.60s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [15:14<07:02, 42.22s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:56<06:21, 42.40s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:43<05:48, 43.62s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:26<05:03, 43.42s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [18:14<04:29, 44.93s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [19:02<03:48, 45.78s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:45<02:59, 44.90s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [20:27<02:12, 44.06s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [21:07<01:25, 42.87s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:49<00:42, 42.64s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:30<00:00, 42.16s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:30<00:00, 43.57s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.92it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.10it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.19it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.22it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:08,  3.24it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.27it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:06<00:03,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:08<00:01,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.34it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.34it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.50it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.49it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.37it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.35it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.03it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.01it/s]
postgres_copy_csv

2023-05-12 16:58:00 (1683910680) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 5/5) in 1385.968 seconds



2023-05-12 16:58:00 (1683910680) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_aggregate) (function=3/4, repeat=1/1, global 5/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683910689.log
Execution time:  90.50226283073425
execute_postgres_query

2023-05-12 16:59:49 (1683910789) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_aggregate) (function=3/4, repeat=1/1, global 5/5) in 109.775 seconds



2023-05-12 16:59:49 (1683910789) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 5/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683910811.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-12 17:00:18 (1683910818) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 5/5) in 28.944 seconds


2023-05-12 17:00:18 (1683910818) Executed test8 (1/1, global 5/5) in 1531.628 seconds



Running test9 (global 5/5)...

2023-05-12 17:00:18 (1683910818) test started

2023-05-12 17:00:18 (1683910818) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 5/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683910819.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-12 17:00:27 (1683910827) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 5/5) in 8.699 seconds



2023-05-12 17:00:27 (1683910827) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 5/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683910837.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f59bfcd5e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:37<18:33, 37.12s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:17<18:53, 39.07s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:04<19:56, 42.72s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:46<19:07, 42.49s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:31<18:46, 43.34s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:20<18:51, 45.26s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [05:04<17:58, 44.93s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:49<17:08, 44.71s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:34<16:28, 44.94s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:15<15:19, 43.76s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:58<14:30, 43.51s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:47<14:15, 45.01s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:34<13:45, 45.84s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:21<13:04, 46.18s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [11:00<11:44, 44.02s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:39<10:38, 42.57s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:20<09:47, 41.95s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [13:05<09:17, 42.90s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:49<08:40, 43.33s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:36<08:08, 44.45s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [15:18<07:17, 43.71s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [16:02<06:32, 43.57s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:41<05:38, 42.29s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:19<04:46, 40.96s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [18:00<04:05, 40.92s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:48<03:35, 43.04s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:36<02:58, 44.68s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [20:25<02:17, 45.90s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [21:11<01:31, 45.81s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:57<00:46, 46.06s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:37<00:00, 44.06s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:37<00:00, 43.78s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.95it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.14it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.21it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.26it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:06,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:06,  2.94it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:04<00:05,  3.02it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.10it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:05,  3.17it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.24it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:06<00:03,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:03,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.25it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:07<00:02,  3.25it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:08<00:01,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:08<00:01,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:09<00:00,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.33it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.26it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.25it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.23it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.16it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.14it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  6.97it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  6.95it/s]
postgres_copy_csv

2023-05-12 17:23:39 (1683912219) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 5/5) in 1391.902 seconds



2023-05-12 17:23:39 (1683912219) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_conditions) (function=3/4, repeat=1/1, global 5/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683912228.log
Execution time:  92.38221716880798
execute_postgres_query

2023-05-12 17:25:31 (1683912331) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_conditions) (function=3/4, repeat=1/1, global 5/5) in 111.653 seconds



2023-05-12 17:25:31 (1683912331) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 5/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683912347.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-12 17:25:53 (1683912353) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 5/5) in 22.475 seconds


2023-05-12 17:25:53 (1683912353) Executed test9 (1/1, global 5/5) in 1534.730 seconds



2023-05-12 17:25:53 (1683912353) Executed script in 74298.122 seconds
