

Running test1 (global 1/5)...

2023-05-10 13:04:32 (1683723872) test started

2023-05-10 13:04:32 (1683723872) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/2, repeat=1/1, global 1/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683723873.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-10 13:04:39 (1683723879) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/2, repeat=1/1, global 1/5) in 7.104 seconds



2023-05-10 13:04:39 (1683723879) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/2, repeat=1/1, global 1/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683723889.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f2b84985e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:35<17:57, 35.90s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:13<17:49, 36.87s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [01:59<19:06, 40.93s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:44<19:09, 42.56s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:29<18:50, 43.47s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:12<18:03, 43.36s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:58<17:41, 44.23s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:40<16:39, 43.48s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:21<15:42, 42.84s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:03<14:50, 42.40s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:47<14:17, 42.89s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:36<14:14, 44.96s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:24<13:41, 45.63s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:06<12:37, 44.56s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:45<11:28, 43.01s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:24<10:27, 41.81s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:06<09:47, 41.98s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:52<09:21, 43.18s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:36<08:37, 43.16s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:15<07:42, 42.01s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:56<06:56, 41.69s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:39<06:19, 42.16s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:18<05:29, 41.21s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [16:54<04:38, 39.74s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:36<04:02, 40.34s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:22<03:30, 42.03s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:12<02:57, 44.32s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [19:58<02:14, 44.95s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:44<01:30, 45.06s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:28<00:44, 44.95s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:08<00:00, 43.31s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:08<00:00, 42.84s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:07,  3.80it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:07,  4.04it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:06,  4.16it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:00<00:06,  4.19it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:06,  4.23it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:05,  4.26it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:01<00:05,  4.28it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:01<00:05,  4.35it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:05,  4.38it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:02<00:04,  4.41it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:02<00:04,  4.39it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:02<00:04,  4.38it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:04,  4.40it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:03<00:03,  4.40it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:03<00:03,  4.42it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:03<00:03,  4.45it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:03<00:03,  4.49it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:04<00:02,  4.45it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:04<00:02,  4.44it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:04<00:02,  4.42it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:04<00:02,  4.35it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:05<00:02,  4.35it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:05<00:01,  4.38it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:05<00:01,  4.46it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:05<00:01,  4.47it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:05<00:01,  4.44it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:06<00:00,  4.43it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:06<00:00,  4.45it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:06<00:00,  4.46it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:06<00:00,  4.46it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:07<00:00,  4.49it/s]Importing vessels data: 100%|██████████| 31/31 [00:07<00:00,  4.39it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00, 16.31it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00, 15.64it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00, 16.19it/s]
postgres_copy_csv

2023-05-10 13:27:19 (1683725239) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/2, repeat=1/1, global 1/5) in 1360.166 seconds


2023-05-10 13:27:19 (1683725239) Executed test1 (1/1, global 1/5) in 1367.270 seconds



Running test2 (global 1/5)...

2023-05-10 13:27:19 (1683725239) test started

2023-05-10 13:27:19 (1683725239) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=1/1, repeat=1/1, global 1/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683725245.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-10 13:27:30 (1683725250) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=1/1, repeat=1/1, global 1/5) in 11.012 seconds


2023-05-10 13:27:30 (1683725250) Executed test2 (1/1, global 1/5) in 11.012 seconds



Running test3 (global 1/5)...

2023-05-10 13:27:30 (1683725250) test started

2023-05-10 13:27:30 (1683725250) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=1/3, global 1/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683725252.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-10 13:27:37 (1683725257) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=1/3, global 1/5) in 6.770 seconds



2023-05-10 13:27:37 (1683725257) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=1/3, global 1/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683725267.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f2b84985e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:35<17:57, 35.90s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:16<18:32, 38.37s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [01:58<18:51, 40.40s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:43<19:00, 42.23s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:28<18:38, 43.01s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:12<18:07, 43.48s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:54<17:07, 42.80s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:36<16:25, 42.84s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:20<15:45, 42.95s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:01<14:50, 42.42s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:42<13:59, 41.99s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:28<13:42, 43.31s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:15<13:18, 44.36s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:03<12:54, 45.55s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:42<11:37, 43.62s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:21<10:33, 42.22s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [11:59<09:32, 40.86s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:38<08:44, 40.36s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:20<08:07, 40.64s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:05<07:44, 42.19s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:52<07:15, 43.51s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:42<06:48, 45.42s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:21<05:49, 43.64s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [16:59<04:52, 41.83s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:39<04:08, 41.35s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:21<03:27, 41.46s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:03<02:46, 41.56s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [19:43<02:03, 41.21s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:25<01:22, 41.41s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:12<00:42, 42.98s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [21:57<00:00, 43.83s/it]Importing basestationreport data: 100%|██████████| 31/31 [21:57<00:00, 42.51s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:07,  3.79it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:07,  4.12it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:06,  4.18it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:00<00:06,  4.15it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:06,  4.21it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:05,  4.26it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:01<00:05,  4.29it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:01<00:05,  4.32it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:05,  4.36it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:02<00:04,  4.37it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:02<00:04,  4.34it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:02<00:04,  4.29it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:04,  4.31it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:03<00:03,  4.26it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:03<00:03,  4.24it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:03<00:03,  3.95it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:04<00:03,  3.84it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:04<00:03,  3.77it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:04<00:03,  3.86it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:04<00:02,  3.99it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:05<00:02,  4.07it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:05<00:02,  4.09it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:05<00:01,  4.18it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:05<00:01,  4.25it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:06<00:01,  4.27it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:06<00:01,  4.26it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:06<00:00,  4.26it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:06<00:00,  4.28it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:06<00:00,  4.28it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:07<00:00,  4.27it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:07<00:00,  4.29it/s]Importing vessels data: 100%|██████████| 31/31 [00:07<00:00,  4.19it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00, 15.70it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00, 15.55it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00, 15.40it/s]
postgres_copy_csv

2023-05-10 13:50:08 (1683726608) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=1/3, global 1/5) in 1350.629 seconds



2023-05-10 13:50:08 (1683726608) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=1/3, global 1/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683726616.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-10 13:50:23 (1683726623) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=1/3, global 1/5) in 15.531 seconds


2023-05-10 13:50:23 (1683726623) Executed test3 (1/3, global 1/5) in 1372.930 seconds

2023-05-10 13:50:23 (1683726623) test started

2023-05-10 13:50:23 (1683726623) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=2/3, global 1/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683726624.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-10 13:50:30 (1683726630) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=2/3, global 1/5) in 6.796 seconds



2023-05-10 13:50:30 (1683726630) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=2/3, global 1/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683726640.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f2b84985e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:02, 36.09s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:14<18:01, 37.30s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [01:58<18:56, 40.57s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:44<19:15, 42.81s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:30<18:55, 43.66s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:11<17:56, 43.05s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:58<17:38, 44.09s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:36<16:10, 42.20s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:19<15:33, 42.45s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:02<14:56, 42.67s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:50<14:43, 44.18s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:33<13:51, 43.78s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:13<12:51, 42.86s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [09:55<12:01, 42.43s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:37<11:19, 42.46s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:22<10:45, 43.06s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:06<10:07, 43.38s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:46<09:11, 42.44s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:26<08:19, 41.64s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:05<07:29, 40.84s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:45<06:46, 40.68s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:32<06:22, 42.45s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:13<05:38, 42.25s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [16:58<04:59, 42.85s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:44<04:23, 43.88s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:27<03:38, 43.77s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:08<02:51, 42.93s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [19:49<02:06, 42.12s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:27<01:22, 41.13s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:09<00:41, 41.21s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [21:48<00:00, 40.48s/it]Importing basestationreport data: 100%|██████████| 31/31 [21:48<00:00, 42.20s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:07,  3.81it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:07,  4.10it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:06,  4.24it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:00<00:06,  4.28it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:06,  4.32it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:05,  4.34it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:01<00:05,  4.37it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:01<00:05,  4.40it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:05,  4.27it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:02<00:04,  4.28it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:02<00:04,  4.28it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:02<00:04,  4.30it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:04,  4.33it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:03<00:03,  4.34it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:03<00:03,  4.38it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:03<00:03,  4.44it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:03<00:03,  4.50it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:04<00:02,  4.52it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:04<00:02,  4.51it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:04<00:02,  4.50it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:04<00:02,  4.44it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:05<00:02,  4.38it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:05<00:01,  4.39it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:05<00:01,  4.44it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:05<00:01,  4.44it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:05<00:01,  4.40it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:06<00:00,  4.40it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:06<00:00,  4.44it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:06<00:00,  4.47it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:06<00:00,  4.48it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:07<00:00,  4.52it/s]Importing vessels data: 100%|██████████| 31/31 [00:07<00:00,  4.39it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00, 16.52it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00, 15.66it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00, 16.47it/s]
postgres_copy_csv

2023-05-10 14:12:50 (1683727970) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=2/3, global 1/5) in 1340.365 seconds



2023-05-10 14:12:50 (1683727970) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=2/3, global 1/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683727979.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-10 14:13:05 (1683727985) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=2/3, global 1/5) in 15.062 seconds


2023-05-10 14:13:05 (1683727985) Executed test3 (2/3, global 1/5) in 1362.223 seconds

2023-05-10 14:13:05 (1683727985) test started

2023-05-10 14:13:05 (1683727985) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=3/3, global 1/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683727987.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-10 14:13:12 (1683727992) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=3/3, global 1/5) in 6.797 seconds



2023-05-10 14:13:12 (1683727992) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=3/3, global 1/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683728002.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f2b84985e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:00, 36.00s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:15<18:23, 38.04s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:01<19:24, 41.60s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:42<18:33, 41.26s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:25<18:10, 41.94s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:12<18:18, 43.94s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:59<17:55, 44.83s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:36<16:15, 42.40s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:19<15:36, 42.56s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:05<15:17, 43.68s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:54<15:02, 45.12s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:37<14:08, 44.67s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:18<12:58, 43.26s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [09:59<12:04, 42.61s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:41<11:21, 42.59s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:23<10:36, 42.40s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:08<10:03, 43.08s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:47<09:05, 41.99s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:26<08:12, 41.07s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:05<07:26, 40.55s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:45<06:43, 40.39s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:31<06:17, 41.99s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:15<05:39, 42.44s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [16:56<04:54, 42.14s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:45<04:24, 44.12s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:29<03:41, 44.25s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:10<02:52, 43.20s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [19:51<02:07, 42.43s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:29<01:22, 41.15s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:10<00:41, 41.16s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [21:49<00:00, 40.53s/it]Importing basestationreport data: 100%|██████████| 31/31 [21:49<00:00, 42.25s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:07,  3.77it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:07,  3.86it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:06,  4.03it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:00<00:06,  4.10it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:06,  4.20it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:05,  4.26it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:01<00:05,  4.32it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:01<00:05,  4.37it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:04,  4.40it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:02<00:04,  4.44it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:02<00:04,  4.44it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:02<00:04,  4.43it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:04,  4.43it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:03<00:03,  4.42it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:03<00:03,  4.44it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:03<00:03,  4.50it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:03<00:03,  4.55it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:04<00:02,  4.57it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:04<00:02,  4.55it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:04<00:02,  4.53it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:04<00:02,  4.46it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:05<00:02,  4.40it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:05<00:01,  4.42it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:05<00:01,  4.48it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:05<00:01,  4.49it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:05<00:01,  4.45it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:06<00:00,  4.43it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:06<00:00,  4.44it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:06<00:00,  4.46it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:06<00:00,  4.48it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:07<00:00,  4.51it/s]Importing vessels data: 100%|██████████| 31/31 [00:07<00:00,  4.41it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00, 15.94it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00, 16.00it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00, 15.62it/s]
postgres_copy_csv

2023-05-10 14:35:34 (1683729334) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=3/3, global 1/5) in 1342.133 seconds



2023-05-10 14:35:34 (1683729334) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=3/3, global 1/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683729344.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-10 14:35:51 (1683729351) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=3/3, global 1/5) in 16.639 seconds


2023-05-10 14:35:51 (1683729351) Executed test3 (3/3, global 1/5) in 1365.570 seconds



Running test4 (global 1/5)...

2023-05-10 14:35:51 (1683729351) test started

2023-05-10 14:35:51 (1683729351) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 1/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683729352.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-10 14:35:58 (1683729358) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 1/5) in 6.802 seconds



2023-05-10 14:35:58 (1683729358) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 1/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683729368.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f2b84985e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:35<17:58, 35.93s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:15<18:26, 38.17s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [01:58<18:51, 40.40s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:44<19:12, 42.67s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:29<18:43, 43.23s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:14<18:18, 43.93s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:55<17:14, 43.10s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:39<16:34, 43.23s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:22<15:50, 43.22s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:03<14:52, 42.48s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:43<13:55, 41.79s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:29<13:40, 43.16s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:17<13:23, 44.65s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:03<12:44, 44.97s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:42<11:30, 43.15s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:20<10:24, 41.66s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [11:58<09:26, 40.49s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:37<08:39, 39.93s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:19<08:07, 40.66s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:02<07:35, 41.41s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:50<07:14, 43.40s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:39<06:44, 44.92s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:19<05:48, 43.56s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [16:55<04:49, 41.37s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:36<04:06, 41.16s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:17<03:25, 41.02s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [18:58<02:44, 41.06s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [19:38<02:02, 40.69s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:21<01:22, 41.39s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:07<00:42, 42.81s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [21:53<00:00, 43.77s/it]Importing basestationreport data: 100%|██████████| 31/31 [21:53<00:00, 42.36s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:08,  3.71it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:07,  4.05it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:06,  4.14it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:00<00:06,  4.10it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:06,  4.17it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:06,  4.16it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:01<00:05,  4.13it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:01<00:05,  4.15it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:05,  4.23it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:02<00:04,  4.28it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:02<00:04,  4.31it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:02<00:04,  4.31it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:04,  4.32it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:03<00:03,  4.32it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:03<00:03,  4.29it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:03<00:03,  4.38it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:03<00:03,  4.44it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:04<00:02,  4.46it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:04<00:02,  4.39it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:04<00:02,  4.35it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:04<00:02,  4.30it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:05<00:02,  4.29it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:05<00:01,  4.30it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:05<00:01,  4.37it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:05<00:01,  4.39it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:06<00:01,  4.37it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:06<00:00,  4.35it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:06<00:00,  4.36it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:06<00:00,  4.39it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:06<00:00,  4.35it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:07<00:00,  4.38it/s]Importing vessels data: 100%|██████████| 31/31 [00:07<00:00,  4.30it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00, 15.21it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00, 14.58it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00, 15.26it/s]
postgres_copy_csv

2023-05-10 14:58:23 (1683730703) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 1/5) in 1345.550 seconds



2023-05-10 14:58:23 (1683730703) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_update_simple) (function=3/4, repeat=1/1, global 1/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683730715.log
Execution time:  261.1375138759613
execute_postgres_query

2023-05-10 15:03:06 (1683730986) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_update_simple) (function=3/4, repeat=1/1, global 1/5) in 283.003 seconds



2023-05-10 15:03:06 (1683730986) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 1/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683730991.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-10 15:03:17 (1683730997) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 1/5) in 10.487 seconds


2023-05-10 15:03:17 (1683730997) Executed test4 (1/1, global 1/5) in 1645.841 seconds



Running test5 (global 1/5)...

2023-05-10 15:03:17 (1683730997) test started

2023-05-10 15:03:17 (1683730997) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 1/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683730998.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-10 15:03:24 (1683731004) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 1/5) in 6.889 seconds



2023-05-10 15:03:24 (1683731004) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 1/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683731014.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f2b84985e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:35<17:57, 35.93s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:16<18:47, 38.88s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [01:59<18:54, 40.53s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:44<18:58, 42.16s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:29<18:47, 43.38s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:13<18:11, 43.66s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:55<17:11, 42.98s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:40<16:41, 43.54s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:24<16:02, 43.76s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:04<14:54, 42.59s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:45<14:02, 42.11s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:32<13:48, 43.60s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:18<13:20, 44.47s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:04<12:44, 44.97s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:43<11:26, 42.92s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:21<10:22, 41.47s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [11:58<09:23, 40.24s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:37<08:38, 39.88s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:18<08:00, 40.03s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:06<07:48, 42.63s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:55<07:23, 44.37s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:40<06:41, 44.61s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:21<05:47, 43.48s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [16:57<04:48, 41.29s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:37<04:06, 41.04s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:17<03:23, 40.73s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [18:58<02:42, 40.70s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [19:38<02:01, 40.59s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:19<01:21, 40.78s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:07<00:42, 42.82s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [21:54<00:00, 43.96s/it]Importing basestationreport data: 100%|██████████| 31/31 [21:54<00:00, 42.39s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:08,  3.69it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:07,  3.95it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:06,  4.12it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:00<00:06,  4.19it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:06,  4.24it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:06,  4.15it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:01<00:06,  4.00it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:01<00:05,  4.09it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:05,  4.16it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:02<00:04,  4.26it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:02<00:04,  4.29it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:02<00:04,  4.25it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:04,  4.21it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:03<00:04,  4.22it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:03<00:03,  4.22it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:03<00:03,  4.31it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:04<00:03,  4.36it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:04<00:02,  4.42it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:04<00:02,  4.42it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:04<00:02,  4.42it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:04<00:02,  4.34it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:05<00:02,  4.31it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:05<00:01,  4.32it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:05<00:01,  4.38it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:05<00:01,  4.35it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:06<00:01,  4.20it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:06<00:00,  4.16it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:06<00:00,  4.19it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:06<00:00,  4.24it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:07<00:00,  4.26it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:07<00:00,  4.32it/s]Importing vessels data: 100%|██████████| 31/31 [00:07<00:00,  4.25it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00, 15.64it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00, 16.01it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00, 15.90it/s]
postgres_copy_csv

2023-05-10 15:25:50 (1683732350) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 1/5) in 1346.480 seconds



2023-05-10 15:25:50 (1683732350) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_update_complex) (function=3/4, repeat=1/1, global 1/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683732364.log
Execution time:  92.57869029045105
execute_postgres_query

2023-05-10 15:27:46 (1683732466) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_update_complex) (function=3/4, repeat=1/1, global 1/5) in 115.840 seconds



2023-05-10 15:27:46 (1683732466) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 1/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683732481.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-10 15:28:07 (1683732487) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 1/5) in 20.829 seconds


2023-05-10 15:28:07 (1683732487) Executed test5 (1/1, global 1/5) in 1490.039 seconds



Running test6 (global 1/5)...

2023-05-10 15:28:07 (1683732487) test started

2023-05-10 15:28:07 (1683732487) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 1/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683732488.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-10 15:28:14 (1683732494) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 1/5) in 6.769 seconds



2023-05-10 15:28:14 (1683732494) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 1/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683732504.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f2b84985e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:35<17:55, 35.85s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:15<18:21, 37.98s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:01<19:31, 41.83s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:42<18:39, 41.45s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:26<18:18, 42.24s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:14<18:26, 44.28s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:59<17:51, 44.63s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:37<16:13, 42.31s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:19<15:28, 42.19s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:04<15:09, 43.31s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:52<14:49, 44.48s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:36<14:03, 44.39s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:16<12:54, 43.05s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [09:57<12:03, 42.53s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:43<11:34, 43.42s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:26<10:49, 43.33s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:09<10:08, 43.47s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:51<09:18, 42.96s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:30<08:21, 41.77s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:10<07:31, 41.04s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:50<06:47, 40.78s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:37<06:23, 42.58s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:20<05:42, 42.83s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:02<04:58, 42.68s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:50<04:25, 44.17s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:33<03:39, 43.83s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:16<02:54, 43.58s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [19:57<02:08, 42.73s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:36<01:23, 41.66s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:18<00:41, 41.77s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [21:57<00:00, 40.90s/it]Importing basestationreport data: 100%|██████████| 31/31 [21:57<00:00, 42.49s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:07,  3.75it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:07,  4.05it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:06,  4.18it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:00<00:06,  4.17it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:06,  4.14it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:06,  4.10it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:01<00:05,  4.14it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:01<00:05,  4.20it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:05,  4.23it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:02<00:04,  4.23it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:02<00:04,  4.21it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:02<00:04,  4.21it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:04,  4.20it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:03<00:04,  4.19it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:03<00:03,  4.26it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:03<00:03,  4.34it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:04<00:03,  4.37it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:04<00:02,  4.41it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:04<00:02,  4.42it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:04<00:02,  4.37it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:04<00:02,  4.34it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:05<00:02,  4.30it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:05<00:01,  4.28it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:05<00:01,  4.35it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:05<00:01,  4.38it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:06<00:01,  4.34it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:06<00:00,  4.28it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:06<00:00,  4.27it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:06<00:00,  4.29it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:07<00:00,  4.35it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:07<00:00,  4.42it/s]Importing vessels data: 100%|██████████| 31/31 [00:07<00:00,  4.28it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00, 15.81it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00, 15.62it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00, 15.39it/s]
postgres_copy_csv

2023-05-10 15:50:43 (1683733843) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 1/5) in 1349.309 seconds



2023-05-10 15:50:43 (1683733843) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_single) (function=3/4, repeat=1/1, global 1/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683733858.log
Execution time:  8.79013442993164
execute_postgres_query

2023-05-10 15:51:33 (1683733893) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_single) (function=3/4, repeat=1/1, global 1/5) in 49.777 seconds



2023-05-10 15:51:33 (1683733893) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 1/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683733897.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-10 15:51:44 (1683733904) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 1/5) in 11.568 seconds


2023-05-10 15:51:44 (1683733904) Executed test6 (1/1, global 1/5) in 1417.423 seconds



Running test7 (global 1/5)...

2023-05-10 15:51:44 (1683733904) test started

2023-05-10 15:51:44 (1683733904) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 1/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683733906.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-10 15:51:51 (1683733911) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 1/5) in 6.822 seconds



2023-05-10 15:51:51 (1683733911) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 1/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683733921.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f2b84985e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:35<17:55, 35.85s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:13<17:50, 36.90s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [01:58<18:51, 40.41s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:44<19:15, 42.78s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:28<18:42, 43.18s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:10<17:51, 42.86s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:59<17:56, 44.84s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:39<16:34, 43.22s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:20<15:34, 42.47s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:00<14:37, 41.79s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:46<14:21, 43.10s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:35<14:11, 44.81s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:18<13:18, 44.38s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [09:59<12:15, 43.29s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:37<11:10, 41.88s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:15<10:10, 40.71s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:00<09:45, 41.84s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:45<09:16, 42.79s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:28<08:34, 42.88s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:12<07:54, 43.17s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:52<07:03, 42.37s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:35<06:21, 42.37s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:13<05:29, 41.17s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [16:49<04:38, 39.73s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:33<04:04, 40.78s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:23<03:38, 43.70s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:10<02:58, 44.55s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [19:56<02:15, 45.20s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:42<01:30, 45.36s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:25<00:44, 44.56s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:03<00:00, 42.78s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:03<00:00, 42.71s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:09,  3.06it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:08,  3.27it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:02<00:06,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:04,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.50it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:04<00:03,  3.52it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.53it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.52it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:05<00:03,  3.52it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.49it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:06<00:02,  3.49it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:07<00:01,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.49it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:08<00:00,  3.50it/s]Importing vessels data: 100%|██████████| 31/31 [00:08<00:00,  3.46it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  8.17it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  8.15it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  8.20it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  8.17it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  8.04it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  8.02it/s]
postgres_copy_csv

2023-05-10 16:14:29 (1683735269) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 1/5) in 1358.293 seconds



2023-05-10 16:14:29 (1683735269) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_multi) (function=3/4, repeat=1/1, global 1/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683735279.log
Execution time:  143.34195017814636
execute_postgres_query

2023-05-10 16:17:12 (1683735432) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_multi) (function=3/4, repeat=1/1, global 1/5) in 162.171 seconds



2023-05-10 16:17:12 (1683735432) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 1/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683735444.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-10 16:17:30 (1683735450) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 1/5) in 18.367 seconds


2023-05-10 16:17:30 (1683735450) Executed test7 (1/1, global 1/5) in 1545.654 seconds



Running test8 (global 1/5)...

2023-05-10 16:17:30 (1683735450) test started

2023-05-10 16:17:30 (1683735450) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 1/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683735451.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-10 16:17:37 (1683735457) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 1/5) in 6.792 seconds



2023-05-10 16:17:37 (1683735457) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 1/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683735467.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f2b84985e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:08, 36.28s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:15<18:23, 38.07s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:01<19:24, 41.58s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:42<18:34, 41.29s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:26<18:17, 42.20s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:12<18:15, 43.82s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:57<17:36, 44.03s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:40<16:49, 43.87s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:24<16:03, 43.79s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:05<14:58, 42.78s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:46<14:05, 42.27s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:32<13:44, 43.41s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:20<13:28, 44.94s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:07<12:52, 45.45s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:45<11:33, 43.33s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:23<10:26, 41.79s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:01<09:28, 40.58s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:40<08:40, 40.07s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:19<07:57, 39.76s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:08<07:48, 42.57s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:55<07:18, 43.89s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:42<06:42, 44.74s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:23<05:48, 43.58s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:00<04:51, 41.58s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:39<04:06, 41.01s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:21<03:26, 41.30s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:03<02:44, 41.25s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [19:43<02:02, 40.97s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:24<01:21, 40.98s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:11<00:42, 42.86s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [21:58<00:00, 44.04s/it]Importing basestationreport data: 100%|██████████| 31/31 [21:58<00:00, 42.53s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:09,  3.02it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.21it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.21it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:08,  3.23it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.26it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.16it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:07,  3.18it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.24it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:06,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:06<00:03,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:08<00:01,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:09<00:00,  3.18it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.09it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.29it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  6.04it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  6.02it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.57it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.55it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  6.93it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  6.91it/s]
postgres_copy_csv

2023-05-10 16:40:10 (1683736810) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 1/5) in 1353.034 seconds



2023-05-10 16:40:10 (1683736810) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_aggregate) (function=3/4, repeat=1/1, global 1/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683736822.log
Execution time:  90.5770468711853
execute_postgres_query

2023-05-10 16:42:02 (1683736922) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_aggregate) (function=3/4, repeat=1/1, global 1/5) in 112.551 seconds



2023-05-10 16:42:02 (1683736922) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 1/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683736938.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-10 16:42:24 (1683736944) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 1/5) in 21.334 seconds


2023-05-10 16:42:24 (1683736944) Executed test8 (1/1, global 1/5) in 1493.711 seconds



Running test9 (global 1/5)...

2023-05-10 16:42:24 (1683736944) test started

2023-05-10 16:42:24 (1683736944) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 1/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683736945.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-10 16:42:31 (1683736951) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 1/5) in 6.834 seconds



2023-05-10 16:42:31 (1683736951) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 1/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683736961.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f2b84985e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:35<17:55, 35.84s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:13<17:50, 36.92s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [01:58<18:57, 40.62s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:45<19:24, 43.15s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:29<18:49, 43.45s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:11<17:55, 43.04s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [05:01<18:02, 45.10s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:39<16:31, 43.11s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:20<15:32, 42.38s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:01<14:37, 41.78s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:46<14:18, 42.90s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:33<13:58, 44.13s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:21<13:36, 45.34s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:03<12:30, 44.13s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:41<11:16, 42.29s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:20<10:20, 41.34s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:06<09:59, 42.81s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:48<09:14, 42.67s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:33<08:40, 43.37s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:13<07:45, 42.31s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:54<06:57, 41.77s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:36<06:17, 41.91s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:14<05:25, 40.70s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [16:50<04:36, 39.49s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:33<04:02, 40.41s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:24<03:38, 43.63s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:13<03:00, 45.09s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [19:59<02:16, 45.45s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:49<01:33, 46.71s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:30<00:45, 45.16s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:09<00:00, 43.22s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:09<00:00, 42.88s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.96it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.20it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.17it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:08,  3.21it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:03,  3.50it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.53it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.53it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:05<00:03,  3.52it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.49it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.49it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:07<00:01,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.50it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.52it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.42it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  8.19it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  8.17it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  8.11it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  8.09it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  8.08it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  8.06it/s]
postgres_copy_csv

2023-05-10 17:05:15 (1683738315) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 1/5) in 1364.105 seconds



2023-05-10 17:05:15 (1683738315) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_conditions) (function=3/4, repeat=1/1, global 1/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683738324.log
Execution time:  222.68906474113464
execute_postgres_query

2023-05-10 17:09:17 (1683738557) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_conditions) (function=3/4, repeat=1/1, global 1/5) in 242.397 seconds



2023-05-10 17:09:17 (1683738557) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 1/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683738560.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-10 17:09:27 (1683738567) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 1/5) in 9.571 seconds


2023-05-10 17:09:27 (1683738567) Executed test9 (1/1, global 1/5) in 1622.908 seconds



Running test1 (global 2/5)...

2023-05-10 17:09:27 (1683738567) test started

2023-05-10 17:09:27 (1683738567) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/2, repeat=1/1, global 2/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683738568.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-10 17:09:34 (1683738574) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/2, repeat=1/1, global 2/5) in 7.034 seconds



2023-05-10 17:09:34 (1683738574) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/2, repeat=1/1, global 2/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683738584.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f2b84985e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:35<17:49, 35.67s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:14<18:00, 37.27s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [01:58<18:57, 40.63s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:45<19:18, 42.91s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:30<19:03, 43.99s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:13<18:07, 43.52s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:57<17:29, 43.74s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:35<16:01, 41.82s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:16<15:16, 41.67s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:02<15:01, 42.94s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:51<14:52, 44.64s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:33<13:56, 44.04s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:13<12:50, 42.79s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [09:54<11:56, 42.17s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:36<11:13, 42.07s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:21<10:43, 42.90s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:05<10:07, 43.38s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:45<09:11, 42.43s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:25<08:20, 41.70s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:05<07:32, 41.14s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:46<06:49, 40.98s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:33<06:24, 42.77s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:16<05:43, 42.93s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:01<05:04, 43.53s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:48<04:27, 44.58s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:29<03:37, 43.51s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:10<02:50, 42.74s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [19:51<02:06, 42.12s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:29<01:22, 41.09s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:11<00:41, 41.34s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [21:50<00:00, 40.62s/it]Importing basestationreport data: 100%|██████████| 31/31 [21:50<00:00, 42.28s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.92it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.14it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.25it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:02<00:06,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:04,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.50it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:04<00:03,  3.53it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.54it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.53it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:05<00:03,  3.53it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.50it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:06<00:01,  3.50it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.52it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.50it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:07<00:01,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.49it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:08<00:00,  3.48it/s]Importing vessels data: 100%|██████████| 31/31 [00:08<00:00,  3.45it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.83it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.81it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  8.03it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  8.01it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.88it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.85it/s]
postgres_copy_csv

2023-05-10 17:31:59 (1683739919) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/2, repeat=1/1, global 2/5) in 1345.198 seconds


2023-05-10 17:31:59 (1683739919) Executed test1 (1/1, global 2/5) in 1352.232 seconds



Running test2 (global 2/5)...

2023-05-10 17:31:59 (1683739919) test started

2023-05-10 17:31:59 (1683739919) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=1/1, repeat=1/1, global 2/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683739929.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-10 17:32:16 (1683739936) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=1/1, repeat=1/1, global 2/5) in 16.871 seconds


2023-05-10 17:32:16 (1683739936) Executed test2 (1/1, global 2/5) in 16.871 seconds



Running test3 (global 2/5)...

2023-05-10 17:32:16 (1683739936) test started

2023-05-10 17:32:16 (1683739936) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=1/3, global 2/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683739937.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-10 17:32:23 (1683739943) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=1/3, global 2/5) in 7.082 seconds



2023-05-10 17:32:23 (1683739943) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=1/3, global 2/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683739953.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f2b84985e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:35<17:59, 35.99s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:16<18:34, 38.43s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [01:58<18:48, 40.30s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:45<19:14, 42.76s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:30<18:51, 43.54s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:14<18:16, 43.85s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:56<17:15, 43.16s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:40<16:40, 43.50s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:25<16:04, 43.84s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:04<14:53, 42.56s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:46<14:03, 42.18s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:33<13:50, 43.69s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:19<13:22, 44.60s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:05<12:42, 44.86s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:44<11:30, 43.13s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:22<10:25, 41.71s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:00<09:26, 40.47s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:39<08:39, 39.95s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:18<07:57, 39.79s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:08<07:51, 42.89s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:56<07:22, 44.29s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:41<06:40, 44.50s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:24<05:53, 44.21s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:01<04:52, 41.78s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:41<04:08, 41.35s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:22<03:26, 41.26s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:03<02:44, 41.08s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [19:43<02:02, 40.87s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:25<01:22, 41.27s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:15<00:43, 43.80s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:00<00:00, 44.23s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:00<00:00, 42.60s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:12,  2.34it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:01<00:18,  1.60it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:01<00:13,  2.02it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:11,  2.28it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:02<00:10,  2.45it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:02<00:09,  2.59it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:08,  2.71it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:03<00:08,  2.79it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:03<00:08,  2.71it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:07,  2.79it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:04<00:07,  2.84it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:04<00:06,  2.85it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:05<00:06,  2.77it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:05<00:05,  2.85it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:05<00:05,  2.95it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:06<00:05,  2.95it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:06<00:04,  2.95it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:06<00:04,  3.06it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:06<00:03,  3.15it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:07<00:03,  3.24it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:07<00:03,  3.26it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:07<00:02,  3.26it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:08<00:02,  3.27it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:08<00:02,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:08<00:01,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:09<00:01,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:09<00:01,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:09<00:00,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:09<00:00,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:10<00:00,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:10<00:00,  3.32it/s]Importing vessels data: 100%|██████████| 31/31 [00:10<00:00,  2.94it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.91it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.89it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  8.08it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  8.06it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  8.09it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  8.07it/s]
postgres_copy_csv

2023-05-10 17:55:00 (1683741300) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=1/3, global 2/5) in 1356.774 seconds



2023-05-10 17:55:00 (1683741300) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=1/3, global 2/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683741310.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-10 17:55:17 (1683741317) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=1/3, global 2/5) in 17.666 seconds


2023-05-10 17:55:17 (1683741317) Executed test3 (1/3, global 2/5) in 1381.522 seconds

2023-05-10 17:55:17 (1683741317) test started

2023-05-10 17:55:17 (1683741317) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=2/3, global 2/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683741318.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-10 17:55:24 (1683741324) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=2/3, global 2/5) in 6.939 seconds



2023-05-10 17:55:24 (1683741324) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=2/3, global 2/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683741334.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f2b84985e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:35<17:52, 35.75s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:16<18:34, 38.43s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [01:58<18:47, 40.27s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:45<19:15, 42.79s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:30<18:55, 43.65s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:15<18:26, 44.24s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:57<17:20, 43.36s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:41<16:45, 43.70s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:24<15:56, 43.47s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:05<14:58, 42.80s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:46<14:02, 42.12s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:33<13:49, 43.68s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:18<13:14, 44.12s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:06<12:48, 45.19s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:45<11:34, 43.39s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:23<10:26, 41.79s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:01<09:26, 40.47s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:39<08:38, 39.86s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:23<08:14, 41.17s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:07<07:41, 41.93s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:54<07:13, 43.37s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:45<06:50, 45.56s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:23<05:47, 43.38s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [16:59<04:49, 41.35s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:39<04:04, 40.71s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:20<03:24, 40.95s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:02<02:44, 41.12s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [19:42<02:02, 40.96s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:25<01:22, 41.34s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:12<00:43, 43.23s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [21:59<00:00, 44.29s/it]Importing basestationreport data: 100%|██████████| 31/31 [21:59<00:00, 42.56s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.85it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.05it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.13it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.16it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:08,  3.19it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.23it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:06<00:03,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:08<00:01,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:09<00:00,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.37it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.33it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.66it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.64it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.93it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.91it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.64it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.61it/s]
postgres_copy_csv

2023-05-10 18:17:58 (1683742678) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=2/3, global 2/5) in 1354.249 seconds



2023-05-10 18:17:58 (1683742678) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=2/3, global 2/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683742689.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-10 18:18:17 (1683742697) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=2/3, global 2/5) in 18.151 seconds


2023-05-10 18:18:17 (1683742697) Executed test3 (2/3, global 2/5) in 1379.339 seconds

2023-05-10 18:18:17 (1683742697) test started

2023-05-10 18:18:17 (1683742697) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=3/3, global 2/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683742698.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-10 18:18:24 (1683742704) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=3/3, global 2/5) in 6.926 seconds



2023-05-10 18:18:24 (1683742704) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=3/3, global 2/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683742714.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f2b84985e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:01, 36.05s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:16<18:48, 38.91s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [01:59<18:58, 40.66s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:45<19:12, 42.70s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:30<18:52, 43.54s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:14<18:13, 43.73s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:56<17:14, 43.11s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:40<16:36, 43.31s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:22<15:48, 43.11s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:03<14:50, 42.40s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:44<13:55, 41.79s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:29<13:37, 43.02s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:17<13:20, 44.46s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:03<12:43, 44.93s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:42<11:28, 43.06s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:21<10:27, 41.84s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [11:58<09:27, 40.50s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:37<08:39, 39.94s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:20<08:11, 40.93s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:04<07:39, 41.80s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:51<07:12, 43.27s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:43<06:53, 45.92s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:21<05:49, 43.72s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [16:58<04:51, 41.58s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:38<04:06, 41.00s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:19<03:26, 41.21s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:02<02:46, 41.54s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [19:43<02:04, 41.38s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:25<01:23, 41.62s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:12<00:43, 43.17s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:00<00:00, 44.71s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:00<00:00, 42.60s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.85it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  2.99it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.14it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.17it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:08,  3.19it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.24it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:06<00:03,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:03,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:08<00:01,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:09<00:00,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.38it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.32it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.77it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.75it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.68it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.66it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.80it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.78it/s]
postgres_copy_csv

2023-05-10 18:40:59 (1683744059) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=3/3, global 2/5) in 1355.252 seconds



2023-05-10 18:40:59 (1683744059) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=3/3, global 2/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683744072.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-10 18:41:19 (1683744079) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=3/3, global 2/5) in 19.958 seconds


2023-05-10 18:41:19 (1683744079) Executed test3 (3/3, global 2/5) in 1382.136 seconds



Running test4 (global 2/5)...

2023-05-10 18:41:19 (1683744079) test started

2023-05-10 18:41:19 (1683744079) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 2/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683744080.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-10 18:41:26 (1683744086) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 2/5) in 7.128 seconds



2023-05-10 18:41:26 (1683744086) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 2/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683744096.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f2b84985e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:10, 36.35s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:17<18:49, 38.96s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [01:58<18:45, 40.21s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:44<19:05, 42.42s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:30<18:56, 43.72s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:15<18:26, 44.24s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:57<17:23, 43.49s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:41<16:40, 43.48s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:25<16:00, 43.67s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:05<14:54, 42.57s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:47<14:04, 42.25s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:33<13:48, 43.63s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:21<13:25, 44.77s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:07<12:47, 45.17s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:46<11:32, 43.25s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:24<10:28, 41.87s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:02<09:28, 40.59s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:41<08:42, 40.17s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:24<08:10, 40.88s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:11<07:51, 42.87s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:59<07:22, 44.24s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:47<06:49, 45.54s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:27<05:50, 43.81s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:04<04:53, 41.86s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:44<04:08, 41.37s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:27<03:28, 41.61s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:08<02:45, 41.43s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [19:49<02:03, 41.32s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:32<01:23, 41.89s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:24<00:44, 44.86s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:09<00:00, 45.04s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:09<00:00, 42.89s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.96it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.14it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.17it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.21it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:08,  3.24it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.27it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.26it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:07,  3.27it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:06,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:06<00:03,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:03,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.25it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.26it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.27it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:08<00:01,  3.26it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.25it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.24it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:09<00:00,  3.25it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.29it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.29it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.97it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.95it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  8.16it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  8.13it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  8.21it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  8.18it/s]
postgres_copy_csv

2023-05-10 19:04:11 (1683745451) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 2/5) in 1364.899 seconds



2023-05-10 19:04:11 (1683745451) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_update_simple) (function=3/4, repeat=1/1, global 2/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683745467.log
Execution time:  256.7111928462982
execute_postgres_query

2023-05-10 19:08:54 (1683745734) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_update_simple) (function=3/4, repeat=1/1, global 2/5) in 283.356 seconds



2023-05-10 19:08:54 (1683745734) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 2/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683745742.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-10 19:09:08 (1683745748) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 2/5) in 13.971 seconds


2023-05-10 19:09:08 (1683745748) Executed test4 (1/1, global 2/5) in 1669.354 seconds



Running test5 (global 2/5)...

2023-05-10 19:09:08 (1683745748) test started

2023-05-10 19:09:08 (1683745748) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 2/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683745749.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-10 19:09:15 (1683745755) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 2/5) in 7.111 seconds



2023-05-10 19:09:15 (1683745755) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 2/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683745765.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f2b84985e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:07, 36.24s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:15<18:23, 38.07s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:01<19:30, 41.81s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:43<18:44, 41.65s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:26<18:22, 42.39s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:14<18:25, 44.22s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:59<17:49, 44.56s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:37<16:15, 42.42s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:20<15:36, 42.58s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:07<15:19, 43.77s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:52<14:44, 44.21s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:37<14:06, 44.54s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:18<12:58, 43.27s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [09:59<12:06, 42.72s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:44<11:33, 43.34s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:27<10:50, 43.36s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:10<10:06, 43.33s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:54<09:25, 43.52s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:33<08:24, 42.03s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:13<07:34, 41.29s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:53<06:49, 40.91s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:40<06:25, 42.82s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:23<05:43, 42.94s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:04<04:56, 42.41s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:51<04:23, 43.84s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:32<03:33, 42.77s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:13<02:49, 42.46s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [19:54<02:05, 41.83s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:33<01:22, 41.03s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:15<00:41, 41.32s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [21:54<00:00, 40.71s/it]Importing basestationreport data: 100%|██████████| 31/31 [21:54<00:00, 42.41s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:09,  3.04it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:08,  3.22it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:02<00:06,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:04<00:04,  3.50it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.50it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:05<00:03,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:07<00:01,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.44it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.40it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  8.01it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.99it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.88it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.86it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  8.04it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  8.02it/s]
postgres_copy_csv

2023-05-10 19:31:45 (1683747105) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 2/5) in 1349.307 seconds



2023-05-10 19:31:45 (1683747105) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_update_complex) (function=3/4, repeat=1/1, global 2/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683747118.log
Execution time:  92.2580509185791
execute_postgres_query

2023-05-10 19:33:40 (1683747220) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_update_complex) (function=3/4, repeat=1/1, global 2/5) in 115.961 seconds



2023-05-10 19:33:40 (1683747220) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 2/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683747239.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-10 19:34:06 (1683747246) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 2/5) in 25.993 seconds


2023-05-10 19:34:06 (1683747246) Executed test5 (1/1, global 2/5) in 1498.373 seconds



Running test6 (global 2/5)...

2023-05-10 19:34:06 (1683747246) test started

2023-05-10 19:34:06 (1683747246) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 2/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683747248.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-10 19:34:13 (1683747253) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 2/5) in 6.954 seconds



2023-05-10 19:34:13 (1683747253) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 2/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683747264.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f2b84985e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:03, 36.13s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:14<18:01, 37.28s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [01:58<18:58, 40.65s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:45<19:23, 43.09s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:29<18:46, 43.34s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:11<17:54, 42.98s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [05:00<17:58, 44.95s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:38<16:22, 42.72s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:19<15:28, 42.22s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:00<14:35, 41.67s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:41<13:52, 41.60s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:31<13:57, 44.09s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:17<13:23, 44.62s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:03<12:45, 45.03s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:41<11:29, 43.07s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:19<10:22, 41.52s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:01<09:42, 41.64s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:45<09:09, 42.24s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:36<08:59, 44.94s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:18<08:04, 44.07s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:59<07:09, 42.99s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:40<06:23, 42.58s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:20<05:33, 41.72s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [16:57<04:41, 40.27s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:39<04:04, 40.78s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:27<03:35, 43.10s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:15<02:58, 44.58s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [20:02<02:15, 45.13s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:49<01:31, 45.79s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:30<00:44, 44.42s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:09<00:00, 42.81s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:09<00:00, 42.90s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.98it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.12it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:09,  3.07it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.15it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:08,  3.21it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.25it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:05<00:03,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:08<00:01,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.45it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.38it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.96it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.94it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  8.09it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  8.07it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.96it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.94it/s]
postgres_copy_csv

2023-05-10 19:56:58 (1683748618) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 2/5) in 1364.400 seconds



2023-05-10 19:56:58 (1683748618) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_single) (function=3/4, repeat=1/1, global 2/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683748627.log
Execution time:  7.8864781856536865
execute_postgres_query

2023-05-10 19:57:40 (1683748660) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_single) (function=3/4, repeat=1/1, global 2/5) in 42.428 seconds



2023-05-10 19:57:40 (1683748660) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 2/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683748661.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-10 19:57:47 (1683748667) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 2/5) in 7.138 seconds


2023-05-10 19:57:47 (1683748667) Executed test6 (1/1, global 2/5) in 1420.920 seconds



Running test7 (global 2/5)...

2023-05-10 19:57:47 (1683748667) test started

2023-05-10 19:57:47 (1683748667) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 2/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683748669.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-10 19:57:54 (1683748674) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 2/5) in 6.978 seconds



2023-05-10 19:57:54 (1683748674) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 2/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683748685.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f2b84985e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:06, 36.22s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:13<17:53, 37.01s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [01:59<19:03, 40.85s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:44<19:13, 42.72s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:29<18:44, 43.26s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:11<17:56, 43.06s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:58<17:42, 44.26s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:40<16:38, 43.43s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:21<15:44, 42.94s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:02<14:47, 42.26s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:46<14:13, 42.65s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:35<14:11, 44.81s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:24<13:49, 46.09s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:05<12:37, 44.55s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:44<11:26, 42.88s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:23<10:24, 41.61s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:08<09:54, 42.48s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:50<09:12, 42.51s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:34<08:35, 42.99s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:14<07:42, 42.03s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:55<06:55, 41.57s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:37<06:16, 41.82s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:15<05:25, 40.65s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [16:52<04:36, 39.53s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:32<03:58, 39.80s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:19<03:29, 41.97s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:11<02:59, 44.84s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [19:57<02:15, 45.09s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:43<01:31, 45.50s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:27<00:44, 44.98s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:07<00:00, 43.48s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:07<00:00, 42.81s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:09,  3.02it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:08,  3.24it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:02<00:06,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:06,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:04<00:03,  3.53it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.57it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.57it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:05<00:03,  3.55it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.50it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:06<00:01,  3.53it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.54it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.53it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:07<00:01,  3.52it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.52it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.53it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.55it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:08<00:00,  3.56it/s]Importing vessels data: 100%|██████████| 31/31 [00:08<00:00,  3.46it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.89it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.87it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.95it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.93it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.88it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.86it/s]
postgres_copy_csv

2023-05-10 20:20:36 (1683750036) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 2/5) in 1361.831 seconds



2023-05-10 20:20:36 (1683750036) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_multi) (function=3/4, repeat=1/1, global 2/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683750045.log
Execution time:  143.23779439926147
execute_postgres_query

2023-05-10 20:23:18 (1683750198) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_multi) (function=3/4, repeat=1/1, global 2/5) in 162.169 seconds



2023-05-10 20:23:18 (1683750198) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 2/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683750211.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-10 20:23:37 (1683750217) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 2/5) in 18.411 seconds


2023-05-10 20:23:37 (1683750217) Executed test7 (1/1, global 2/5) in 1549.389 seconds



Running test8 (global 2/5)...

2023-05-10 20:23:37 (1683750217) test started

2023-05-10 20:23:37 (1683750217) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 2/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683750218.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-10 20:23:44 (1683750224) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 2/5) in 6.921 seconds



2023-05-10 20:23:44 (1683750224) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 2/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683750234.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f2b84985e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:35<17:58, 35.94s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:13<17:44, 36.70s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [01:57<18:40, 40.01s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:44<19:17, 42.87s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:26<18:30, 42.70s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:08<17:40, 42.41s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:55<17:29, 43.74s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:36<16:28, 42.96s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:17<15:33, 42.42s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [06:57<14:36, 41.75s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:43<14:16, 42.83s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:30<13:58, 44.12s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:19<13:42, 45.71s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:00<12:32, 44.27s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:38<11:20, 42.51s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:16<10:17, 41.15s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:02<09:56, 42.60s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:44<09:09, 42.28s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:29<08:37, 43.13s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:08<07:41, 41.93s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:49<06:55, 41.55s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:31<06:14, 41.62s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:09<05:24, 40.51s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [16:46<04:36, 39.51s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:28<04:01, 40.21s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:17<03:34, 42.85s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:05<02:58, 44.53s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [19:51<02:14, 44.80s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:37<01:30, 45.35s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:20<00:44, 44.68s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [21:59<00:00, 43.03s/it]Importing basestationreport data: 100%|██████████| 31/31 [21:59<00:00, 42.58s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.97it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.17it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:07,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:06,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:02<00:06,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.50it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.50it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:04,  3.51it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.53it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.57it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:04<00:03,  3.60it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.61it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.58it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:05<00:03,  3.58it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.56it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.52it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.51it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:06<00:01,  3.56it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.58it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.55it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:07<00:01,  3.55it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:07<00:00,  3.56it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.56it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.56it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:08<00:00,  3.59it/s]Importing vessels data: 100%|██████████| 31/31 [00:08<00:00,  3.51it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  8.18it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  8.16it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  8.08it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  8.06it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.95it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.92it/s]
postgres_copy_csv

2023-05-10 20:46:18 (1683751578) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 2/5) in 1354.738 seconds



2023-05-10 20:46:18 (1683751578) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_aggregate) (function=3/4, repeat=1/1, global 2/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683751588.log
Execution time:  92.1328387260437
execute_postgres_query

2023-05-10 20:48:09 (1683751689) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_aggregate) (function=3/4, repeat=1/1, global 2/5) in 111.021 seconds



2023-05-10 20:48:09 (1683751689) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 2/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683751711.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-10 20:48:36 (1683751716) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 2/5) in 26.992 seconds


2023-05-10 20:48:36 (1683751716) Executed test8 (1/1, global 2/5) in 1499.673 seconds



Running test9 (global 2/5)...

2023-05-10 20:48:36 (1683751716) test started

2023-05-10 20:48:36 (1683751716) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 2/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683751718.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-10 20:48:43 (1683751723) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 2/5) in 6.890 seconds



2023-05-10 20:48:43 (1683751723) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 2/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683751734.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f2b84985e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:02, 36.07s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:13<17:53, 37.01s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [01:58<19:01, 40.77s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:44<19:16, 42.82s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:28<18:37, 42.96s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:10<17:50, 42.82s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:58<17:45, 44.39s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:38<16:32, 43.17s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:20<15:35, 42.54s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:01<14:43, 42.09s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:45<14:12, 42.64s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:33<14:03, 44.42s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:22<13:43, 45.74s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:03<12:32, 44.25s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:41<11:21, 42.58s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:20<10:19, 41.30s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:06<09:59, 42.80s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:50<09:20, 43.08s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:32<08:34, 42.87s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:12<07:43, 42.15s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:53<06:56, 41.68s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:35<06:17, 41.90s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:13<05:25, 40.72s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [16:50<04:37, 39.61s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:32<04:01, 40.28s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:23<03:37, 43.53s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:10<02:58, 44.59s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [19:56<02:14, 44.77s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:40<01:29, 44.77s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:25<00:44, 44.79s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:04<00:00, 43.04s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:04<00:00, 42.73s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:09,  3.04it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:08,  3.25it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:02<00:06,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:04,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.50it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:04<00:04,  3.49it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:05<00:03,  3.16it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:03,  3.26it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:07<00:01,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.49it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.50it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.53it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.42it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  8.17it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  8.14it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  8.20it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  8.18it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  8.16it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  8.14it/s]
postgres_copy_csv

2023-05-10 21:11:22 (1683753082) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 2/5) in 1359.141 seconds



2023-05-10 21:11:22 (1683753082) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_conditions) (function=3/4, repeat=1/1, global 2/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683753092.log
Execution time:  210.91299557685852
execute_postgres_query

2023-05-10 21:15:13 (1683753313) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_conditions) (function=3/4, repeat=1/1, global 2/5) in 230.266 seconds



2023-05-10 21:15:13 (1683753313) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 2/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683753316.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-10 21:15:22 (1683753322) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 2/5) in 9.451 seconds


2023-05-10 21:15:22 (1683753322) Executed test9 (1/1, global 2/5) in 1605.748 seconds



Running test1 (global 3/5)...

2023-05-10 21:15:22 (1683753322) test started

2023-05-10 21:15:22 (1683753322) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/2, repeat=1/1, global 3/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683753323.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-10 21:15:29 (1683753329) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/2, repeat=1/1, global 3/5) in 6.940 seconds



2023-05-10 21:15:29 (1683753329) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/2, repeat=1/1, global 3/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683753339.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f2b84985e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:00, 36.03s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:15<18:17, 37.84s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:00<19:21, 41.47s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:42<18:39, 41.47s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:25<18:12, 42.03s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:12<18:12, 43.72s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:57<17:40, 44.19s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:35<16:09, 42.15s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:17<15:25, 42.06s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:02<15:06, 43.15s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:48<14:40, 44.05s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:34<14:04, 44.44s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:14<12:56, 43.12s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [09:55<12:04, 42.61s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:39<11:27, 42.99s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:23<10:46, 43.13s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:08<10:14, 43.86s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:47<09:11, 42.43s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:27<08:18, 41.57s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:07<07:31, 41.01s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:47<06:49, 40.95s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:34<06:23, 42.66s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:16<05:40, 42.51s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [16:58<04:57, 42.47s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:45<04:22, 43.68s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:28<03:36, 43.34s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:09<02:50, 42.72s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [19:50<02:06, 42.20s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:29<01:22, 41.24s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:10<00:41, 41.26s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [21:49<00:00, 40.60s/it]Importing basestationreport data: 100%|██████████| 31/31 [21:49<00:00, 42.25s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.99it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:08,  3.22it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.24it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:02<00:06,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:04,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:04<00:04,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.49it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:05<00:03,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.49it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.50it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.49it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:07<00:01,  3.49it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.49it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.49it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.49it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.49it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.44it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  8.19it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  8.17it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.94it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.92it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.56it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.54it/s]
postgres_copy_csv

2023-05-10 21:37:53 (1683754673) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/2, repeat=1/1, global 3/5) in 1344.341 seconds


2023-05-10 21:37:53 (1683754673) Executed test1 (1/1, global 3/5) in 1351.280 seconds



Running test2 (global 3/5)...

2023-05-10 21:37:53 (1683754673) test started

2023-05-10 21:37:53 (1683754673) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=1/1, repeat=1/1, global 3/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683754683.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-10 21:38:10 (1683754690) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=1/1, repeat=1/1, global 3/5) in 16.986 seconds


2023-05-10 21:38:10 (1683754690) Executed test2 (1/1, global 3/5) in 16.986 seconds



Running test3 (global 3/5)...

2023-05-10 21:38:10 (1683754690) test started

2023-05-10 21:38:10 (1683754690) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=1/3, global 3/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683754692.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-10 21:38:17 (1683754697) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=1/3, global 3/5) in 6.980 seconds



2023-05-10 21:38:17 (1683754697) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=1/3, global 3/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683754708.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f2b84985e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:35<17:57, 35.90s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:16<18:33, 38.39s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [01:58<18:44, 40.15s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:45<19:18, 42.89s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:30<19:00, 43.86s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:15<18:22, 44.09s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:57<17:18, 43.25s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:42<16:49, 43.87s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:26<16:09, 44.06s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:06<14:57, 42.73s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:47<14:07, 42.36s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:35<13:55, 43.96s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:22<13:25, 44.73s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:08<12:49, 45.24s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:46<11:30, 43.19s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:25<10:25, 41.73s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:02<09:27, 40.52s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:42<08:42, 40.17s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:23<08:04, 40.35s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:10<07:47, 42.46s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:58<07:22, 44.26s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:46<06:48, 45.33s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:27<05:51, 43.90s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:04<04:52, 41.80s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:44<04:07, 41.25s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:25<03:26, 41.33s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:06<02:44, 41.13s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [19:47<02:02, 41.00s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:29<01:22, 41.37s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:20<00:44, 44.42s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:06<00:00, 44.75s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:06<00:00, 42.79s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.86it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.10it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.23it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.23it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:08,  3.22it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.20it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.25it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:05<00:03,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:08<00:01,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.45it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.36it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.98it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.96it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.88it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.86it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.87it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.85it/s]
postgres_copy_csv

2023-05-10 22:00:58 (1683756058) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=1/3, global 3/5) in 1360.992 seconds



2023-05-10 22:00:58 (1683756058) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=1/3, global 3/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683756071.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-10 22:01:18 (1683756078) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=1/3, global 3/5) in 19.305 seconds


2023-05-10 22:01:18 (1683756078) Executed test3 (1/3, global 3/5) in 1387.278 seconds

2023-05-10 22:01:18 (1683756078) test started

2023-05-10 22:01:18 (1683756078) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=2/3, global 3/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683756079.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-10 22:01:25 (1683756085) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=2/3, global 3/5) in 7.092 seconds



2023-05-10 22:01:25 (1683756085) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=2/3, global 3/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683756095.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f2b84985e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:00, 36.02s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:13<17:41, 36.60s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [01:59<19:17, 41.33s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:44<19:05, 42.41s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:30<18:58, 43.80s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:13<18:11, 43.66s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [05:00<17:55, 44.82s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:41<16:43, 43.62s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:23<15:43, 42.87s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:04<14:49, 42.34s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:46<14:08, 42.42s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:37<14:15, 45.01s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:25<13:46, 45.93s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:07<12:39, 44.66s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:46<11:24, 42.80s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:23<10:18, 41.26s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:07<09:46, 41.89s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:52<09:16, 42.82s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:38<08:45, 43.83s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:18<07:50, 42.74s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:58<07:00, 42.04s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:41<06:19, 42.20s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:19<05:28, 41.03s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [16:56<04:38, 39.74s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:39<04:03, 40.61s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:27<03:34, 42.89s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:15<02:58, 44.56s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [20:02<02:15, 45.18s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:47<01:30, 45.26s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:33<00:45, 45.29s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:12<00:00, 43.33s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:12<00:00, 42.97s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:09,  3.04it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:08,  3.23it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:02<00:06,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:04,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.50it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:04<00:03,  3.51it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.54it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.53it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:05<00:03,  3.52it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.49it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:06<00:02,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:07<00:01,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.43it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.43it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  8.02it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  8.00it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.90it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.88it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  8.02it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  8.00it/s]
postgres_copy_csv

2023-05-10 22:24:12 (1683757452) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=2/3, global 3/5) in 1367.109 seconds



2023-05-10 22:24:12 (1683757452) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=2/3, global 3/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683757457.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-10 22:24:23 (1683757463) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=2/3, global 3/5) in 11.062 seconds


2023-05-10 22:24:23 (1683757463) Executed test3 (2/3, global 3/5) in 1385.263 seconds

2023-05-10 22:24:23 (1683757463) test started

2023-05-10 22:24:23 (1683757463) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=3/3, global 3/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683757464.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-10 22:24:30 (1683757470) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=3/3, global 3/5) in 7.186 seconds



2023-05-10 22:24:30 (1683757470) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=3/3, global 3/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683757480.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f2b84985e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:01, 36.04s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:16<18:45, 38.82s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [01:58<18:49, 40.35s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:44<19:03, 42.37s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:29<18:50, 43.47s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:14<18:19, 43.99s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:56<17:17, 43.21s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:40<16:38, 43.40s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:23<15:55, 43.45s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:03<14:46, 42.23s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:44<14:00, 42.04s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:31<13:47, 43.55s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:18<13:20, 44.45s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:05<12:46, 45.08s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:42<11:26, 42.93s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:21<10:24, 41.61s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [11:58<09:24, 40.31s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:38<08:40, 40.03s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:17<07:59, 39.95s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:05<07:43, 42.16s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:54<07:21, 44.16s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:39<06:40, 44.55s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:21<05:51, 43.90s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [16:58<04:51, 41.67s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:38<04:07, 41.24s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:18<03:24, 40.97s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:00<02:44, 41.24s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [19:42<02:03, 41.27s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:25<01:23, 41.92s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:16<00:44, 44.49s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [21:57<00:00, 43.64s/it]Importing basestationreport data: 100%|██████████| 31/31 [21:57<00:00, 42.51s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.91it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.09it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.21it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.24it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:08,  3.17it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:08,  3.00it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:08,  2.94it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:07,  2.90it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:03<00:07,  2.78it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:10,  2.04it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:04<00:08,  2.24it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:04<00:07,  2.40it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:04<00:07,  2.54it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:05<00:06,  2.65it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:05<00:05,  2.71it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:05<00:05,  2.80it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:06<00:05,  2.77it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:06<00:04,  2.66it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:07<00:04,  2.74it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:07<00:03,  2.76it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:07<00:03,  2.66it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:08<00:03,  2.63it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:08<00:02,  2.78it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:08<00:02,  2.95it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:09<00:01,  3.08it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:09<00:01,  3.16it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:09<00:01,  3.23it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:09<00:00,  3.25it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:10<00:00,  3.27it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:10<00:00,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:10<00:00,  3.32it/s]Importing vessels data: 100%|██████████| 31/31 [00:10<00:00,  2.86it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  8.11it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  8.09it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.98it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.96it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.76it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.74it/s]
postgres_copy_csv

2023-05-10 22:47:04 (1683758824) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=3/3, global 3/5) in 1353.785 seconds



2023-05-10 22:47:04 (1683758824) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=3/3, global 3/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683758834.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-10 22:47:21 (1683758841) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=3/3, global 3/5) in 17.118 seconds


2023-05-10 22:47:21 (1683758841) Executed test3 (3/3, global 3/5) in 1378.090 seconds



Running test4 (global 3/5)...

2023-05-10 22:47:21 (1683758841) test started

2023-05-10 22:47:21 (1683758841) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 3/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683758842.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-10 22:47:28 (1683758848) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 3/5) in 6.952 seconds



2023-05-10 22:47:28 (1683758848) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 3/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683758858.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f2b84985e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:06, 36.22s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:17<18:50, 39.00s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:00<19:01, 40.77s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:46<19:21, 43.01s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:32<19:04, 44.01s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:16<18:26, 44.25s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:58<17:22, 43.43s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:41<16:35, 43.30s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:25<15:58, 43.59s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:05<14:50, 42.40s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:47<14:02, 42.11s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:34<13:49, 43.64s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:19<13:16, 44.23s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:07<12:50, 45.33s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:46<11:34, 43.40s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:25<10:30, 42.04s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:03<09:31, 40.84s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:44<08:49, 40.75s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:26<08:14, 41.20s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:12<07:50, 42.81s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [15:01<07:24, 44.47s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:51<06:56, 46.26s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:30<05:52, 44.02s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:07<04:53, 41.98s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:47<04:08, 41.41s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:29<03:27, 41.59s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:11<02:46, 41.67s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [19:52<02:04, 41.52s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:36<01:24, 42.16s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:28<00:45, 45.23s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:14<00:00, 45.45s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:14<00:00, 43.06s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.95it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.12it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.14it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.17it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:08,  3.22it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.24it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:06<00:03,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:08<00:01,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.43it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.36it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.89it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.86it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.90it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.88it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.93it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.90it/s]
postgres_copy_csv

2023-05-10 23:10:18 (1683760218) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 3/5) in 1369.752 seconds



2023-05-10 23:10:18 (1683760218) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_update_simple) (function=3/4, repeat=1/1, global 3/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683760235.log
Execution time:  256.85451459884644
execute_postgres_query

2023-05-10 23:15:02 (1683760502) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_update_simple) (function=3/4, repeat=1/1, global 3/5) in 284.367 seconds



2023-05-10 23:15:02 (1683760502) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 3/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683760507.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-10 23:15:13 (1683760513) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 3/5) in 10.446 seconds


2023-05-10 23:15:13 (1683760513) Executed test4 (1/1, global 3/5) in 1671.517 seconds



Running test5 (global 3/5)...

2023-05-10 23:15:13 (1683760513) test started

2023-05-10 23:15:13 (1683760513) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 3/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683760514.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-10 23:15:20 (1683760520) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 3/5) in 7.189 seconds



2023-05-10 23:15:20 (1683760520) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 3/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683760530.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f2b84985e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:35<17:56, 35.90s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:13<17:51, 36.95s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [01:59<19:07, 41.00s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:40<18:27, 41.02s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:23<18:08, 41.87s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:13<18:28, 44.35s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:59<18:04, 45.19s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:37<16:22, 42.71s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:21<15:49, 43.18s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:06<15:16, 43.65s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:55<15:04, 45.23s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:39<14:14, 44.98s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:19<13:03, 43.53s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:01<12:09, 42.93s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:43<11:26, 42.88s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:26<10:41, 42.76s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:13<10:16, 44.01s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:52<09:13, 42.55s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:31<08:18, 41.52s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:10<07:28, 40.76s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:50<06:46, 40.62s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:39<06:27, 43.01s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:22<05:44, 43.04s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:05<05:01, 43.11s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:53<04:27, 44.57s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:38<03:42, 44.48s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:19<02:53, 43.46s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [19:59<02:07, 42.66s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:40<01:23, 41.89s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:21<00:41, 41.81s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:01<00:00, 41.22s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:01<00:00, 42.63s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  3.00it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:08,  3.22it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:02<00:06,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:03,  3.50it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.52it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.51it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:05<00:03,  3.51it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.49it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.50it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.51it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.50it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:07<00:01,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.46it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.43it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  9.38it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  9.35it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  8.24it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  8.22it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  8.06it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  8.03it/s]
postgres_copy_csv

2023-05-10 23:37:56 (1683761876) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 3/5) in 1356.022 seconds



2023-05-10 23:37:56 (1683761876) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_update_complex) (function=3/4, repeat=1/1, global 3/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683761885.log
Execution time:  93.21772074699402
execute_postgres_query

2023-05-10 23:39:48 (1683761988) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_update_complex) (function=3/4, repeat=1/1, global 3/5) in 111.940 seconds



2023-05-10 23:39:48 (1683761988) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 3/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683762016.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-10 23:40:24 (1683762024) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 3/5) in 35.749 seconds


2023-05-10 23:40:24 (1683762024) Executed test5 (1/1, global 3/5) in 1510.900 seconds



Running test6 (global 3/5)...

2023-05-10 23:40:24 (1683762024) test started

2023-05-10 23:40:24 (1683762024) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 3/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683762025.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-10 23:40:31 (1683762031) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 3/5) in 7.062 seconds



2023-05-10 23:40:31 (1683762031) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 3/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683762041.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f2b84985e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:35<17:56, 35.87s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:16<18:46, 38.85s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [01:59<18:53, 40.48s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:44<19:07, 42.51s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:29<18:47, 43.37s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:14<18:14, 43.80s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:56<17:14, 43.12s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:40<16:40, 43.52s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:24<16:00, 43.67s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:04<14:56, 42.69s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:46<14:05, 42.30s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:33<13:51, 43.76s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:19<13:19, 44.44s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:05<12:41, 44.79s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:43<11:25, 42.85s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:21<10:22, 41.48s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [11:58<09:22, 40.15s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:37<08:35, 39.66s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:21<08:11, 40.99s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:06<07:44, 42.23s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:52<07:15, 43.50s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:42<06:46, 45.22s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:21<05:47, 43.49s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [16:58<04:50, 41.50s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:38<04:05, 40.96s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:19<03:24, 40.95s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:00<02:44, 41.13s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [19:40<02:02, 40.87s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:25<01:23, 41.98s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:09<00:42, 42.69s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [21:56<00:00, 43.80s/it]Importing basestationreport data: 100%|██████████| 31/31 [21:56<00:00, 42.46s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.92it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.14it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.26it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.25it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:08,  3.24it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:06,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:04<00:05,  3.07it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  2.85it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:05,  2.86it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:05<00:05,  2.87it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  2.88it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:04,  2.89it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:06<00:04,  2.88it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:06<00:03,  2.86it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:03,  2.85it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:07<00:03,  2.83it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:07<00:02,  2.80it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  2.94it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:08<00:01,  3.06it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:08<00:01,  3.13it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:08<00:01,  3.16it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:09<00:00,  3.20it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:09<00:00,  3.24it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:09<00:00,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:10<00:00,  3.32it/s]Importing vessels data: 100%|██████████| 31/31 [00:10<00:00,  3.10it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.96it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.94it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.75it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.73it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.70it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.68it/s]
postgres_copy_csv

2023-05-11 00:03:03 (1683763383) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 3/5) in 1352.063 seconds



2023-05-11 00:03:03 (1683763383) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_single) (function=3/4, repeat=1/1, global 3/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683763397.log
Execution time:  8.51396632194519
execute_postgres_query

2023-05-11 00:03:51 (1683763431) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_single) (function=3/4, repeat=1/1, global 3/5) in 48.389 seconds



2023-05-11 00:03:51 (1683763431) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 3/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683763439.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-11 00:04:06 (1683763446) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 3/5) in 15.146 seconds


2023-05-11 00:04:06 (1683763446) Executed test6 (1/1, global 3/5) in 1422.661 seconds



Running test7 (global 3/5)...

2023-05-11 00:04:06 (1683763446) test started

2023-05-11 00:04:06 (1683763446) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 3/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683763447.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-11 00:04:13 (1683763453) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 3/5) in 6.990 seconds



2023-05-11 00:04:13 (1683763453) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 3/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683763463.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f2b84985e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:03, 36.10s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:17<18:50, 39.00s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:00<19:09, 41.06s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:44<19:03, 42.36s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:30<18:51, 43.53s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:13<18:06, 43.45s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:55<17:06, 42.78s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:39<16:35, 43.28s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:23<15:57, 43.50s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:03<14:49, 42.35s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:44<13:59, 42.00s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:32<13:54, 43.92s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:18<13:21, 44.53s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:06<12:54, 45.54s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:45<11:34, 43.40s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:23<10:27, 41.82s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:01<09:29, 40.70s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:40<08:42, 40.22s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:21<08:06, 40.55s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:09<07:49, 42.72s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:57<07:21, 44.20s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:44<06:46, 45.15s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:24<05:49, 43.63s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:01<04:51, 41.67s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:41<04:06, 41.16s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:23<03:26, 41.21s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:04<02:44, 41.17s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [19:45<02:03, 41.08s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:27<01:23, 41.62s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:19<00:44, 44.60s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:06<00:00, 45.18s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:06<00:00, 42.77s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:13,  2.29it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:11,  2.42it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:01<00:10,  2.71it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:10,  2.68it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:10,  2.49it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:02<00:09,  2.62it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:08,  2.67it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:08,  2.83it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:03<00:07,  2.99it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.08it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:06,  3.14it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:04<00:06,  3.16it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:04<00:05,  3.20it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.19it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:05<00:04,  3.24it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:05<00:04,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:06<00:03,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:06<00:03,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:06<00:03,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:03,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:07<00:02,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:07<00:02,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:08<00:01,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:08<00:01,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:08<00:01,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:09<00:00,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:09<00:00,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:09<00:00,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.39it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.13it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  8.04it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  8.02it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.82it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.80it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.86it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.84it/s]
postgres_copy_csv

2023-05-11 00:26:55 (1683764815) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 3/5) in 1361.958 seconds



2023-05-11 00:26:55 (1683764815) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_multi) (function=3/4, repeat=1/1, global 3/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683764830.log
Execution time:  143.42321801185608
execute_postgres_query

2023-05-11 00:29:44 (1683764984) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_multi) (function=3/4, repeat=1/1, global 3/5) in 168.523 seconds



2023-05-11 00:29:44 (1683764984) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 3/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683764996.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-11 00:30:02 (1683765002) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 3/5) in 18.117 seconds


2023-05-11 00:30:02 (1683765002) Executed test7 (1/1, global 3/5) in 1555.588 seconds



Running test8 (global 3/5)...

2023-05-11 00:30:02 (1683765002) test started

2023-05-11 00:30:02 (1683765002) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 3/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683765003.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-11 00:30:09 (1683765009) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 3/5) in 6.969 seconds



2023-05-11 00:30:09 (1683765009) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 3/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683765019.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f2b84985e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:35<17:56, 35.87s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:15<18:29, 38.27s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [01:57<18:40, 40.02s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:44<19:14, 42.76s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:29<18:50, 43.48s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:14<18:20, 44.04s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:56<17:17, 43.22s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:39<16:32, 43.14s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:22<15:51, 43.23s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:04<15:00, 42.87s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:45<14:04, 42.24s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:31<13:42, 43.27s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:20<13:32, 45.12s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:07<12:55, 45.62s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:45<11:34, 43.38s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:23<10:28, 41.89s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:01<09:28, 40.62s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:40<08:41, 40.09s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:22<08:08, 40.70s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:09<07:47, 42.50s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:56<07:17, 43.77s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:47<06:53, 45.98s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:26<05:50, 43.84s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:02<04:52, 41.78s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:43<04:07, 41.31s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:24<03:27, 41.46s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:06<02:45, 41.50s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [19:47<02:03, 41.32s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:29<01:23, 41.60s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:19<00:43, 43.91s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:04<00:00, 44.50s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:04<00:00, 42.74s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.92it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.16it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.19it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.20it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:08,  3.20it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.22it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.24it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:04,  3.19it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.19it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:06<00:03,  3.25it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:03,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:08<00:01,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:09<00:00,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.38it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.31it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  8.04it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  8.02it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.87it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.85it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.60it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.58it/s]
postgres_copy_csv

2023-05-11 00:52:49 (1683766369) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 3/5) in 1359.826 seconds



2023-05-11 00:52:49 (1683766369) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_aggregate) (function=3/4, repeat=1/1, global 3/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683766384.log
Execution time:  90.31035089492798
execute_postgres_query

2023-05-11 00:54:45 (1683766485) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_aggregate) (function=3/4, repeat=1/1, global 3/5) in 116.043 seconds



2023-05-11 00:54:45 (1683766485) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 3/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683766490.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-11 00:54:57 (1683766497) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 3/5) in 12.167 seconds


2023-05-11 00:54:57 (1683766497) Executed test8 (1/1, global 3/5) in 1495.005 seconds



Running test9 (global 3/5)...

2023-05-11 00:54:57 (1683766497) test started

2023-05-11 00:54:57 (1683766497) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 3/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683766498.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-11 00:55:04 (1683766504) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 3/5) in 7.071 seconds



2023-05-11 00:55:04 (1683766504) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 3/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683766514.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f2b84985e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:10, 36.35s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:15<18:17, 37.86s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:00<19:20, 41.43s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:41<18:33, 41.22s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:25<18:16, 42.16s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:13<18:20, 44.01s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:59<17:51, 44.63s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:36<16:11, 42.24s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:18<15:30, 42.31s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:04<15:08, 43.27s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:50<14:46, 44.31s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:34<13:57, 44.08s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:14<12:52, 42.90s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [09:55<12:00, 42.35s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:39<11:23, 42.75s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:23<10:47, 43.14s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:09<10:14, 43.88s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:49<09:17, 42.85s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:28<08:21, 41.81s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:08<07:32, 41.16s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:48<06:48, 40.90s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:35<06:23, 42.65s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:19<05:43, 42.97s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:00<04:57, 42.56s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:47<04:23, 43.89s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:28<03:33, 42.79s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:09<02:50, 42.53s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [19:50<02:05, 41.95s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:29<01:21, 40.95s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:10<00:40, 40.97s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [21:49<00:00, 40.50s/it]Importing basestationreport data: 100%|██████████| 31/31 [21:49<00:00, 42.25s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.93it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.14it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:01<00:09,  2.85it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.09it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:08,  3.20it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.27it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:04,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.52it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:03,  3.53it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.54it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.53it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:05<00:03,  3.53it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:01,  3.51it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.51it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:07<00:01,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.41it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.41it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.87it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.85it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.58it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.56it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.47it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.45it/s]
postgres_copy_csv

2023-05-11 01:17:28 (1683767848) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 3/5) in 1344.202 seconds



2023-05-11 01:17:28 (1683767848) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_conditions) (function=3/4, repeat=1/1, global 3/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683767861.log
Execution time:  200.5822434425354
execute_postgres_query

2023-05-11 01:21:12 (1683768072) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_conditions) (function=3/4, repeat=1/1, global 3/5) in 223.636 seconds



2023-05-11 01:21:12 (1683768072) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 3/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683768075.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-11 01:21:21 (1683768081) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 3/5) in 9.539 seconds


2023-05-11 01:21:21 (1683768081) Executed test9 (1/1, global 3/5) in 1584.448 seconds



Running test1 (global 4/5)...

2023-05-11 01:21:21 (1683768081) test started

2023-05-11 01:21:21 (1683768081) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/2, repeat=1/1, global 4/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683768082.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-11 01:21:29 (1683768089) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/2, repeat=1/1, global 4/5) in 7.510 seconds



2023-05-11 01:21:29 (1683768089) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/2, repeat=1/1, global 4/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683768099.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f2b84985e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:02, 36.07s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:16<18:33, 38.41s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [01:59<18:53, 40.49s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:45<19:12, 42.68s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:29<18:45, 43.30s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:13<18:09, 43.57s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:54<17:07, 42.83s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:38<16:29, 43.01s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:21<15:49, 43.18s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:02<14:50, 42.42s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:43<13:59, 41.98s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:28<13:37, 43.01s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:16<13:20, 44.49s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:05<12:57, 45.75s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:45<11:45, 44.09s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:23<10:34, 42.33s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:01<09:32, 40.86s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:39<08:41, 40.10s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:23<08:14, 41.18s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:06<07:39, 41.75s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:52<07:10, 43.01s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:42<06:45, 45.02s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:21<05:47, 43.45s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [16:58<04:48, 41.27s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:38<04:06, 41.06s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:19<03:24, 40.97s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:01<02:44, 41.17s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [19:41<02:02, 40.86s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:26<01:24, 42.05s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:11<00:42, 42.95s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [21:56<00:00, 43.62s/it]Importing basestationreport data: 100%|██████████| 31/31 [21:56<00:00, 42.46s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:09,  3.03it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.15it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.22it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.22it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.27it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.24it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.23it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:04<00:05,  3.04it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  2.88it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:05,  2.87it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:05<00:05,  2.89it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  2.86it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:04,  2.89it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:06<00:04,  2.89it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:06<00:03,  2.87it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:03,  2.82it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:07<00:03,  2.75it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:07<00:02,  2.80it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  2.83it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:08<00:02,  2.86it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:08<00:01,  3.00it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:08<00:01,  3.13it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:09<00:00,  3.18it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:09<00:00,  3.23it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:09<00:00,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:10<00:00,  3.35it/s]Importing vessels data: 100%|██████████| 31/31 [00:10<00:00,  3.08it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.88it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.86it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  8.07it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  8.04it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.76it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.74it/s]
postgres_copy_csv

2023-05-11 01:44:01 (1683769441) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/2, repeat=1/1, global 4/5) in 1351.787 seconds


2023-05-11 01:44:01 (1683769441) Executed test1 (1/1, global 4/5) in 1359.297 seconds



Running test2 (global 4/5)...

2023-05-11 01:44:01 (1683769441) test started

2023-05-11 01:44:01 (1683769441) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=1/1, repeat=1/1, global 4/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683769450.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-11 01:44:17 (1683769457) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=1/1, repeat=1/1, global 4/5) in 16.290 seconds


2023-05-11 01:44:17 (1683769457) Executed test2 (1/1, global 4/5) in 16.290 seconds



Running test3 (global 4/5)...

2023-05-11 01:44:17 (1683769457) test started

2023-05-11 01:44:17 (1683769457) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=1/3, global 4/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683769458.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-11 01:44:24 (1683769464) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=1/3, global 4/5) in 6.916 seconds



2023-05-11 01:44:24 (1683769464) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=1/3, global 4/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683769474.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f2b84985e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:09, 36.31s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:15<18:19, 37.93s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:00<19:13, 41.20s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:41<18:32, 41.19s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:25<18:16, 42.18s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:11<18:10, 43.61s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:58<17:48, 44.51s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:36<16:16, 42.44s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:19<15:40, 42.76s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:04<15:08, 43.25s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:51<14:48, 44.44s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:35<14:03, 44.41s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:15<12:56, 43.16s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [09:57<12:05, 42.69s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:41<11:27, 42.94s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:24<10:44, 42.97s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:09<10:10, 43.60s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:49<09:15, 42.70s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:27<08:16, 41.36s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:07<07:29, 40.90s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:48<06:47, 40.77s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:34<06:22, 42.44s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:19<05:44, 43.05s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:00<04:58, 42.65s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:46<04:21, 43.62s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:29<03:37, 43.46s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:11<02:51, 42.95s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [19:52<02:06, 42.23s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:31<01:22, 41.25s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:11<00:41, 41.14s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [21:51<00:00, 40.66s/it]Importing basestationreport data: 100%|██████████| 31/31 [21:51<00:00, 42.30s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:09,  3.03it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:08,  3.25it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:07,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:06,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:02<00:06,  3.49it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.49it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:04,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.49it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.53it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:04<00:03,  3.53it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.54it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.54it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:05<00:03,  3.53it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.51it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:06<00:02,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:07<00:01,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.22it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.41it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.06it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.04it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.45it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.44it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.75it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.73it/s]
postgres_copy_csv

2023-05-11 02:06:50 (1683770810) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=1/3, global 4/5) in 1346.298 seconds



2023-05-11 02:06:50 (1683770810) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=1/3, global 4/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683770819.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-11 02:07:07 (1683770827) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=1/3, global 4/5) in 16.582 seconds


2023-05-11 02:07:07 (1683770827) Executed test3 (1/3, global 4/5) in 1369.796 seconds

2023-05-11 02:07:07 (1683770827) test started

2023-05-11 02:07:07 (1683770827) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=2/3, global 4/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683770828.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-11 02:07:14 (1683770834) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=2/3, global 4/5) in 7.143 seconds



2023-05-11 02:07:14 (1683770834) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=2/3, global 4/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683770844.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f2b84985e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:15, 36.51s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:17<18:52, 39.06s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:00<19:01, 40.76s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:45<19:12, 42.67s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:31<18:57, 43.75s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:15<18:20, 44.00s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:58<17:22, 43.42s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:44<16:57, 44.26s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:27<16:10, 44.10s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:08<15:00, 42.89s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:49<14:09, 42.46s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:38<14:01, 44.30s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:25<13:34, 45.24s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:09<12:41, 44.78s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:49<11:35, 43.45s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:27<10:27, 41.81s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:08<09:40, 41.46s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:49<08:57, 41.34s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:35<08:34, 42.85s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:21<07:59, 43.61s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [15:02<07:09, 42.99s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:44<06:23, 42.62s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:23<05:31, 41.50s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [16:59<04:40, 40.05s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:39<04:00, 40.00s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:25<03:29, 41.86s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:13<02:53, 43.49s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [19:56<02:10, 43.39s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:42<01:28, 44.32s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:30<00:45, 45.43s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:10<00:00, 43.65s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:10<00:00, 42.92s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.87it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.10it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.21it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.27it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:02<00:06,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:04,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:04<00:03,  3.51it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.52it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.51it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:05<00:03,  3.50it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:07<00:01,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.49it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.43it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  8.05it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  8.03it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  8.01it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.99it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  8.03it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  8.01it/s]
postgres_copy_csv

2023-05-11 02:29:59 (1683772199) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=2/3, global 4/5) in 1364.855 seconds



2023-05-11 02:29:59 (1683772199) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=2/3, global 4/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683772204.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-11 02:30:10 (1683772210) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=2/3, global 4/5) in 11.254 seconds


2023-05-11 02:30:10 (1683772210) Executed test3 (2/3, global 4/5) in 1383.251 seconds

2023-05-11 02:30:10 (1683772210) test started

2023-05-11 02:30:10 (1683772210) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=3/3, global 4/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683772211.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-11 02:30:17 (1683772217) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=3/3, global 4/5) in 6.982 seconds



2023-05-11 02:30:17 (1683772217) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=3/3, global 4/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683772227.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f2b84985e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:13, 36.45s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:17<18:54, 39.11s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:01<19:14, 41.23s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:44<18:59, 42.20s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:31<18:59, 43.83s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:16<18:26, 44.24s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:59<17:32, 43.87s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:44<16:52, 44.02s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:25<15:52, 43.29s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:09<15:13, 43.52s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:54<14:37, 43.87s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:41<14:13, 44.90s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:22<13:05, 43.65s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:05<12:17, 43.36s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:44<11:12, 42.02s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:25<10:26, 41.75s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:12<10:09, 43.56s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:58<09:33, 44.08s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:40<08:42, 43.56s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:21<07:49, 42.64s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [15:01<07:00, 42.08s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:44<06:20, 42.23s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:29<05:45, 43.13s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:10<04:56, 42.41s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:57<04:22, 43.78s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:42<03:41, 44.28s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:24<02:54, 43.64s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [20:06<02:08, 42.87s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:46<01:24, 42.09s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:27<00:41, 41.89s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:07<00:00, 41.26s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:07<00:00, 42.82s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.96it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.16it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.24it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.16it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:06,  3.21it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.27it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:05<00:03,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:08<00:01,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.51it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.39it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  8.14it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  8.12it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  8.14it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  8.12it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  8.06it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  8.04it/s]
postgres_copy_csv

2023-05-11 02:52:59 (1683773579) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=3/3, global 4/5) in 1361.894 seconds



2023-05-11 02:52:59 (1683773579) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=3/3, global 4/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683773584.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-11 02:53:10 (1683773590) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=3/3, global 4/5) in 11.058 seconds


2023-05-11 02:53:10 (1683773590) Executed test3 (3/3, global 4/5) in 1379.935 seconds



Running test4 (global 4/5)...

2023-05-11 02:53:10 (1683773590) test started

2023-05-11 02:53:10 (1683773590) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 4/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683773591.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-11 02:53:17 (1683773597) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 4/5) in 6.895 seconds



2023-05-11 02:53:17 (1683773597) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 4/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683773607.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f2b84985e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:12, 36.41s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:17<18:56, 39.21s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:00<19:10, 41.09s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:45<19:05, 42.41s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:31<18:59, 43.84s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:14<18:07, 43.51s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:56<17:12, 43.01s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:42<16:49, 43.90s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:26<16:07, 43.97s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:08<15:09, 43.29s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:50<14:16, 42.84s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:38<14:07, 44.61s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:25<13:33, 45.20s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:11<12:54, 45.56s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:50<11:36, 43.50s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:29<10:31, 42.12s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:08<09:38, 41.33s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:53<09:10, 42.32s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:37<08:33, 42.83s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:23<08:01, 43.81s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [15:05<07:12, 43.27s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:48<06:29, 43.30s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:27<05:34, 41.77s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:03<04:41, 40.27s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:43<04:01, 40.17s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:30<03:31, 42.25s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:19<02:56, 44.24s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [20:07<02:15, 45.21s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:52<01:30, 45.24s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:38<00:45, 45.51s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:18<00:00, 43.74s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:18<00:00, 43.17s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:09,  3.02it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.22it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:04,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.49it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:05<00:03,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:07<00:01,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.41it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.40it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  8.23it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  8.21it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  8.27it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  8.25it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  8.10it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  8.08it/s]
postgres_copy_csv

2023-05-11 03:16:09 (1683774969) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 4/5) in 1372.732 seconds



2023-05-11 03:16:09 (1683774969) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_update_simple) (function=3/4, repeat=1/1, global 4/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683774979.log
Execution time:  246.1093397140503
execute_postgres_query

2023-05-11 03:20:35 (1683775235) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_update_simple) (function=3/4, repeat=1/1, global 4/5) in 265.254 seconds



2023-05-11 03:20:35 (1683775235) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 4/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683775239.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-11 03:20:45 (1683775245) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 4/5) in 10.553 seconds


2023-05-11 03:20:45 (1683775245) Executed test4 (1/1, global 4/5) in 1655.434 seconds



Running test5 (global 4/5)...

2023-05-11 03:20:45 (1683775245) test started

2023-05-11 03:20:45 (1683775245) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 4/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683775246.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-11 03:20:52 (1683775252) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 4/5) in 6.978 seconds



2023-05-11 03:20:52 (1683775252) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 4/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683775262.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f2b84985e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:07, 36.26s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:17<18:50, 38.98s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:00<19:01, 40.75s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:45<19:10, 42.59s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:30<18:51, 43.53s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:14<18:12, 43.69s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:56<17:15, 43.13s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:40<16:35, 43.28s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:23<15:55, 43.41s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:05<15:00, 42.89s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:46<14:04, 42.21s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:32<13:43, 43.35s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:20<13:27, 44.83s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:05<12:42, 44.84s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:43<11:26, 42.91s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:22<10:22, 41.52s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [11:59<09:25, 40.41s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:38<08:39, 39.98s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:22<08:13, 41.13s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:05<07:39, 41.76s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:51<07:07, 42.80s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:41<06:44, 44.93s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:21<05:48, 43.60s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [16:58<04:50, 41.55s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:38<04:06, 41.01s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:19<03:25, 41.06s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:01<02:45, 41.34s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [19:41<02:03, 41.10s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:25<01:23, 41.88s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:12<00:43, 43.50s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:00<00:00, 44.89s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:00<00:00, 42.61s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.84it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.10it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.20it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.22it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:08,  3.20it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.19it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.23it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:06<00:03,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:03,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.26it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.26it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:08<00:01,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:09<00:00,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.29it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.31it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.09it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.07it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  8.49it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  8.46it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.43it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.40it/s]
postgres_copy_csv

2023-05-11 03:43:28 (1683776608) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 4/5) in 1355.586 seconds



2023-05-11 03:43:28 (1683776608) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_update_complex) (function=3/4, repeat=1/1, global 4/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683776624.log
Execution time:  91.90516591072083
execute_postgres_query

2023-05-11 03:45:25 (1683776725) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_update_complex) (function=3/4, repeat=1/1, global 4/5) in 117.420 seconds



2023-05-11 03:45:25 (1683776725) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 4/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683776735.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-11 03:45:41 (1683776741) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 4/5) in 15.801 seconds


2023-05-11 03:45:41 (1683776741) Executed test5 (1/1, global 4/5) in 1495.786 seconds



Running test6 (global 4/5)...

2023-05-11 03:45:41 (1683776741) test started

2023-05-11 03:45:41 (1683776741) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 4/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683776742.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-11 03:45:48 (1683776748) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 4/5) in 7.016 seconds



2023-05-11 03:45:48 (1683776748) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 4/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683776758.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f2b84985e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:10, 36.34s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:15<18:22, 38.03s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:01<19:26, 41.64s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:42<18:33, 41.23s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:25<18:11, 41.98s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:12<18:17, 43.89s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:57<17:35, 43.96s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:39<16:38, 43.42s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:22<15:54, 43.40s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:03<14:53, 42.53s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:44<14:05, 42.27s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:30<13:43, 43.35s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:18<13:25, 44.73s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:06<12:53, 45.51s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:46<11:43, 44.00s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:24<10:34, 42.32s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:02<09:31, 40.82s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:40<08:41, 40.15s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:23<08:11, 40.95s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:06<07:36, 41.53s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:52<07:07, 42.78s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:40<06:40, 44.53s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:23<05:51, 43.90s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:00<04:53, 41.89s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:41<04:09, 41.53s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:22<03:27, 41.48s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:04<02:46, 41.68s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [19:44<02:03, 41.26s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:29<01:24, 42.15s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:14<00:43, 43.24s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:01<00:00, 44.21s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:01<00:00, 42.63s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.94it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.13it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.22it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.22it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.27it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.26it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:07,  3.27it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:06,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.26it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:05,  3.12it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:05<00:05,  2.92it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  2.89it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:04,  2.74it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:06<00:04,  2.77it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:06<00:03,  2.76it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:03,  2.78it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:07<00:03,  2.70it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:07<00:02,  2.76it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  2.94it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:08<00:01,  3.07it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:08<00:01,  3.16it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:08<00:01,  3.19it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:09<00:00,  3.16it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:09<00:00,  3.16it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:09<00:00,  3.24it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:10<00:00,  3.30it/s]Importing vessels data: 100%|██████████| 31/31 [00:10<00:00,  3.09it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.99it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.96it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  8.10it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  8.08it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.92it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.90it/s]
postgres_copy_csv

2023-05-11 04:08:25 (1683778105) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 4/5) in 1356.944 seconds



2023-05-11 04:08:25 (1683778105) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_single) (function=3/4, repeat=1/1, global 4/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683778118.log
Execution time:  8.704303741455078
execute_postgres_query

2023-05-11 04:09:13 (1683778153) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_single) (function=3/4, repeat=1/1, global 4/5) in 48.124 seconds



2023-05-11 04:09:13 (1683778153) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 4/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683778160.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-11 04:09:27 (1683778167) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 4/5) in 13.677 seconds


2023-05-11 04:09:27 (1683778167) Executed test6 (1/1, global 4/5) in 1425.761 seconds



Running test7 (global 4/5)...

2023-05-11 04:09:27 (1683778167) test started

2023-05-11 04:09:27 (1683778167) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 4/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683778168.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-11 04:09:34 (1683778174) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 4/5) in 7.208 seconds



2023-05-11 04:09:34 (1683778174) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 4/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683778184.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f2b84985e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:07, 36.26s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:17<18:58, 39.25s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:00<19:06, 40.95s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:47<19:26, 43.20s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:32<19:06, 44.08s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:17<18:26, 44.24s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:59<17:27, 43.63s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:46<17:03, 44.50s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:31<16:23, 44.72s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:11<15:08, 43.27s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:53<14:18, 42.91s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:41<14:04, 44.46s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:28<13:31, 45.11s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:12<12:45, 45.03s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:51<11:28, 43.06s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:29<10:22, 41.53s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:08<09:29, 40.71s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:55<09:13, 42.61s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:40<08:39, 43.27s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:26<08:07, 44.30s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [15:07<07:13, 43.34s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:51<06:30, 43.43s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:29<05:35, 41.88s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:07<04:43, 40.54s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:46<04:01, 40.31s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:34<03:32, 42.44s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:24<02:58, 44.66s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [20:08<02:14, 44.68s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:56<01:31, 45.58s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:41<00:45, 45.31s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:21<00:00, 43.84s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:21<00:00, 43.28s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.96it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.19it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:02<00:06,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.49it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:05<00:03,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:07<00:01,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.43it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.42it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  8.06it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  8.04it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  8.13it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  8.11it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  8.22it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  8.19it/s]
postgres_copy_csv

2023-05-11 04:32:30 (1683779550) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 4/5) in 1376.020 seconds



2023-05-11 04:32:30 (1683779550) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_multi) (function=3/4, repeat=1/1, global 4/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683779559.log
Execution time:  143.0705418586731
execute_postgres_query

2023-05-11 04:35:12 (1683779712) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_multi) (function=3/4, repeat=1/1, global 4/5) in 162.123 seconds



2023-05-11 04:35:12 (1683779712) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 4/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683779725.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-11 04:35:30 (1683779730) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 4/5) in 18.279 seconds


2023-05-11 04:35:30 (1683779730) Executed test7 (1/1, global 4/5) in 1563.629 seconds



Running test8 (global 4/5)...

2023-05-11 04:35:30 (1683779730) test started

2023-05-11 04:35:30 (1683779730) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 4/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683779732.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-11 04:35:37 (1683779737) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 4/5) in 7.090 seconds



2023-05-11 04:35:37 (1683779737) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 4/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683779748.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f2b84985e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:10, 36.34s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:17<18:52, 39.06s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:00<19:08, 41.03s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:44<19:00, 42.24s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:31<18:59, 43.82s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:14<18:11, 43.67s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:57<17:19, 43.31s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:42<16:51, 44.00s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:26<16:06, 43.91s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:08<15:12, 43.44s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:49<14:13, 42.68s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:38<14:04, 44.43s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:25<13:35, 45.28s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:11<12:52, 45.43s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:49<11:31, 43.22s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:27<10:24, 41.63s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:06<09:31, 40.81s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:53<09:14, 42.66s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:37<08:35, 42.99s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:23<08:04, 44.08s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [15:05<07:14, 43.46s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:48<06:28, 43.17s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:26<05:33, 41.65s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:03<04:41, 40.19s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:42<04:00, 40.06s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:30<03:31, 42.33s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:19<02:57, 44.31s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [20:05<02:14, 44.83s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:52<01:31, 45.58s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:37<00:45, 45.47s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:17<00:00, 43.66s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:17<00:00, 43.14s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:09,  3.05it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:08,  3.23it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.19it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:06,  3.22it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.27it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:05<00:03,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:08<00:01,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.46it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.38it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  8.12it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  8.10it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  8.02it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  8.00it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  8.13it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  8.11it/s]
postgres_copy_csv

2023-05-11 04:58:29 (1683781109) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 4/5) in 1372.016 seconds



2023-05-11 04:58:29 (1683781109) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_aggregate) (function=3/4, repeat=1/1, global 4/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683781119.log
Execution time:  92.10563921928406
execute_postgres_query

2023-05-11 05:00:20 (1683781220) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_aggregate) (function=3/4, repeat=1/1, global 4/5) in 110.778 seconds



2023-05-11 05:00:20 (1683781220) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 4/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683781236.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-11 05:00:42 (1683781242) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 4/5) in 22.045 seconds


2023-05-11 05:00:42 (1683781242) Executed test8 (1/1, global 4/5) in 1511.929 seconds



Running test9 (global 4/5)...

2023-05-11 05:00:42 (1683781242) test started

2023-05-11 05:00:42 (1683781242) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 4/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683781244.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-11 05:00:49 (1683781249) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 4/5) in 7.047 seconds



2023-05-11 05:00:49 (1683781249) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 4/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683781260.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f2b84985e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:07, 36.26s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:15<18:25, 38.14s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:01<19:28, 41.72s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:42<18:36, 41.35s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:26<18:21, 42.38s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:14<18:22, 44.11s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:58<17:40, 44.21s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:41<16:46, 43.78s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:25<16:04, 43.83s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:05<14:57, 42.74s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:47<14:07, 42.39s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:33<13:47, 43.53s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:22<13:33, 45.21s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:08<12:53, 45.50s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:47<11:37, 43.60s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:26<10:32, 42.15s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:05<09:34, 41.03s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:43<08:43, 40.24s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:24<08:04, 40.36s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:11<07:47, 42.47s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:59<07:21, 44.11s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:48<06:51, 45.75s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:29<05:52, 44.04s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:06<04:54, 42.04s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:46<04:08, 41.48s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:29<03:29, 41.82s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:10<02:46, 41.61s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [19:51<02:04, 41.53s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:34<01:23, 41.81s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:26<00:44, 44.93s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:12<00:00, 45.36s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:12<00:00, 42.99s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.80it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.04it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.20it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.25it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:08,  3.23it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.23it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.24it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:07,  3.25it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.23it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:06,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:04<00:05,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:06<00:03,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:03,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:07<00:02,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.13it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:08<00:01,  2.92it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:08<00:01,  3.02it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.09it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.15it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:09<00:00,  3.22it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.23it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.23it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.66it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.64it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.96it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.94it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.94it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.92it/s]
postgres_copy_csv

2023-05-11 05:23:37 (1683782617) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 4/5) in 1367.760 seconds



2023-05-11 05:23:37 (1683782617) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_conditions) (function=3/4, repeat=1/1, global 4/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683782633.log
Execution time:  199.090589761734
execute_postgres_query

2023-05-11 05:27:22 (1683782842) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_conditions) (function=3/4, repeat=1/1, global 4/5) in 225.106 seconds



2023-05-11 05:27:22 (1683782842) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 4/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683782846.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-11 05:27:32 (1683782852) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 4/5) in 9.284 seconds


2023-05-11 05:27:32 (1683782852) Executed test9 (1/1, global 4/5) in 1609.198 seconds



Running test1 (global 5/5)...

2023-05-11 05:27:32 (1683782852) test started

2023-05-11 05:27:32 (1683782852) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/2, repeat=1/1, global 5/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683782853.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-11 05:27:39 (1683782859) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/2, repeat=1/1, global 5/5) in 7.002 seconds



2023-05-11 05:27:39 (1683782859) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/2, repeat=1/1, global 5/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683782869.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f2b84985e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:05, 36.18s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:17<18:49, 38.95s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:00<19:02, 40.80s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:45<19:11, 42.65s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:31<18:58, 43.79s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:16<18:23, 44.15s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:58<17:25, 43.54s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:45<17:03, 44.51s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:28<16:13, 44.23s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:08<15:01, 42.91s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:50<14:11, 42.59s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:39<14:06, 44.53s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:26<13:36, 45.36s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:11<12:48, 45.18s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:49<11:28, 43.06s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:28<10:26, 41.77s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:06<09:29, 40.69s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:50<09:02, 41.73s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:33<08:25, 42.10s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:23<08:08, 44.40s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [15:09<07:27, 44.79s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:51<06:35, 43.98s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:29<05:38, 42.31s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:06<04:45, 40.76s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:46<04:02, 40.42s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:31<03:28, 41.79s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:19<02:55, 43.81s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [20:08<02:15, 45.32s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:54<01:31, 45.56s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:40<00:45, 45.60s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:20<00:00, 43.82s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:20<00:00, 43.24s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.91it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.15it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.26it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:02<00:06,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.49it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.49it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:05<00:03,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:07<00:01,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.46it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.41it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.99it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.97it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.54it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.52it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.96it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.94it/s]
postgres_copy_csv

2023-05-11 05:50:33 (1683784233) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/2, repeat=1/1, global 5/5) in 1374.725 seconds


2023-05-11 05:50:33 (1683784233) Executed test1 (1/1, global 5/5) in 1381.727 seconds



Running test2 (global 5/5)...

2023-05-11 05:50:33 (1683784233) test started

2023-05-11 05:50:33 (1683784233) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=1/1, repeat=1/1, global 5/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683784239.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-11 05:50:45 (1683784245) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=1/1, repeat=1/1, global 5/5) in 11.266 seconds


2023-05-11 05:50:45 (1683784245) Executed test2 (1/1, global 5/5) in 11.266 seconds



Running test3 (global 5/5)...

2023-05-11 05:50:45 (1683784245) test started

2023-05-11 05:50:45 (1683784245) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=1/3, global 5/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683784246.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-11 05:50:51 (1683784251) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=1/3, global 5/5) in 6.953 seconds



2023-05-11 05:50:51 (1683784251) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=1/3, global 5/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683784262.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f2b84985e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:06, 36.21s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:16<18:33, 38.39s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:00<19:14, 41.25s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:41<18:30, 41.14s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:25<18:09, 41.91s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:11<18:10, 43.62s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:56<17:37, 44.08s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:40<16:49, 43.88s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:24<16:03, 43.80s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:05<15:03, 43.05s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:46<14:10, 42.55s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:33<13:49, 43.68s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:21<13:30, 45.04s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:07<12:49, 45.29s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:45<11:30, 43.18s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:24<10:26, 41.80s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:02<09:29, 40.70s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:40<08:39, 39.99s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:23<08:12, 41.02s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:07<07:38, 41.67s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:53<07:11, 43.10s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:41<06:41, 44.56s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:22<05:46, 43.37s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [16:58<04:49, 41.39s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:39<04:07, 41.24s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:20<03:25, 41.03s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:02<02:45, 41.38s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [19:42<02:03, 41.06s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:25<01:23, 41.62s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:11<00:42, 42.99s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [21:55<00:00, 43.22s/it]Importing basestationreport data: 100%|██████████| 31/31 [21:55<00:00, 42.44s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.99it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.19it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.24it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.27it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.23it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:06<00:03,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:03,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.26it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.25it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.26it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:08<00:01,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:09<00:00,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.34it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.30it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.84it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.82it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.14it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.12it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  8.00it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.98it/s]
postgres_copy_csv

2023-05-11 06:13:22 (1683785602) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=1/3, global 5/5) in 1350.794 seconds



2023-05-11 06:13:22 (1683785602) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=1/3, global 5/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683785611.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-11 06:13:38 (1683785618) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=1/3, global 5/5) in 15.974 seconds


2023-05-11 06:13:38 (1683785618) Executed test3 (1/3, global 5/5) in 1373.721 seconds

2023-05-11 06:13:38 (1683785618) test started

2023-05-11 06:13:38 (1683785618) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=2/3, global 5/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683785619.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-11 06:13:45 (1683785625) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=2/3, global 5/5) in 7.072 seconds



2023-05-11 06:13:45 (1683785625) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=2/3, global 5/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683785635.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f2b84985e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:02, 36.09s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:14<18:03, 37.35s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:00<19:17, 41.33s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:47<19:40, 43.73s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:31<18:57, 43.74s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:14<18:05, 43.42s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:58<17:24, 43.52s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:35<15:58, 41.66s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:18<15:22, 41.94s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:05<15:12, 43.44s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:52<14:53, 44.65s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:35<13:59, 44.17s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:16<12:54, 43.04s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [09:57<12:05, 42.67s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:42<11:31, 43.19s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:25<10:47, 43.16s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:10<10:12, 43.72s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:49<09:12, 42.47s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:30<08:22, 41.84s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:09<07:32, 41.11s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:50<06:49, 41.00s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:39<06:30, 43.39s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:22<05:47, 43.42s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:06<05:03, 43.42s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:53<04:27, 44.65s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:34<03:37, 43.55s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:16<02:52, 43.09s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [19:57<02:07, 42.41s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:36<01:22, 41.46s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:18<00:41, 41.50s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [21:58<00:00, 41.09s/it]Importing basestationreport data: 100%|██████████| 31/31 [21:58<00:00, 42.54s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.84it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.06it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.18it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.23it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.26it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.16it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.20it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:07,  3.23it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.27it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:06,  3.27it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.25it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:04<00:05,  3.27it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.24it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:06<00:03,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:03,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.24it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:07<00:02,  3.25it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:08<00:01,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:09<00:00,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.33it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.28it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.48it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.47it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.50it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.48it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.73it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.71it/s]
postgres_copy_csv

2023-05-11 06:36:19 (1683786979) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=2/3, global 5/5) in 1353.794 seconds



2023-05-11 06:36:19 (1683786979) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=2/3, global 5/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683786990.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-11 06:36:38 (1683786998) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=2/3, global 5/5) in 18.465 seconds


2023-05-11 06:36:38 (1683786998) Executed test3 (2/3, global 5/5) in 1379.331 seconds

2023-05-11 06:36:38 (1683786998) test started

2023-05-11 06:36:38 (1683786998) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=3/3, global 5/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683786999.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-11 06:36:45 (1683787005) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/3, repeat=3/3, global 5/5) in 6.975 seconds



2023-05-11 06:36:45 (1683787005) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=3/3, global 5/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683787015.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f2b84985e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:16, 36.53s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:14<18:07, 37.50s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:00<19:09, 41.06s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:47<19:32, 43.43s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:30<18:53, 43.58s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:13<18:05, 43.41s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [05:01<17:57, 44.88s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:40<16:23, 42.77s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:21<15:29, 42.23s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:02<14:39, 41.89s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:49<14:28, 43.43s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:35<14:00, 44.25s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:22<13:34, 45.25s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:05<12:34, 44.40s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:44<11:25, 42.83s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:23<10:24, 41.64s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:07<09:52, 42.29s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:55<09:32, 44.04s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:36<08:36, 43.05s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:19<07:56, 43.28s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [15:00<07:03, 42.39s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:42<06:20, 42.26s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:20<05:28, 41.03s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [16:56<04:37, 39.59s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:40<04:05, 40.90s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:32<03:40, 44.09s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:18<02:59, 44.93s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [20:06<02:16, 45.66s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:50<01:30, 45.23s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:32<00:44, 44.26s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:11<00:00, 42.54s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:11<00:00, 42.94s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:09,  3.06it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:08,  3.26it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:06,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:02<00:05,  3.50it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:04,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.49it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:04<00:03,  3.52it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.53it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.52it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:05<00:03,  3.52it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.50it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:06<00:01,  3.50it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.52it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.50it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:07<00:01,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.49it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.51it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.51it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:08<00:00,  3.53it/s]Importing vessels data: 100%|██████████| 31/31 [00:08<00:00,  3.47it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  8.16it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  8.14it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  8.04it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  8.02it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  6.86it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  6.84it/s]
postgres_copy_csv

2023-05-11 06:59:30 (1683788370) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/3, repeat=3/3, global 5/5) in 1365.438 seconds



2023-05-11 06:59:30 (1683788370) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=3/3, global 5/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683788375.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-11 06:59:41 (1683788381) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=3/3, repeat=3/3, global 5/5) in 11.250 seconds


2023-05-11 06:59:41 (1683788381) Executed test3 (3/3, global 5/5) in 1383.663 seconds



Running test4 (global 5/5)...

2023-05-11 06:59:41 (1683788381) test started

2023-05-11 06:59:41 (1683788381) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 5/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683788382.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-11 06:59:48 (1683788388) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 5/5) in 7.196 seconds



2023-05-11 06:59:48 (1683788388) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 5/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683788399.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f2b84985e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:00, 36.03s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:14<17:58, 37.19s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [01:58<18:59, 40.69s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:39<18:21, 40.81s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:23<18:10, 41.94s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:12<18:28, 44.34s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:59<18:02, 45.09s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:37<16:24, 42.82s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:21<15:48, 43.12s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:05<15:15, 43.59s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:55<15:11, 45.60s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:38<14:08, 44.67s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:19<13:02, 43.50s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:00<12:08, 42.88s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:43<11:27, 42.94s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:27<10:45, 43.01s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:12<10:10, 43.62s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:53<09:18, 42.96s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:33<08:25, 42.16s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:12<07:33, 41.21s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:53<06:50, 41.04s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:39<06:24, 42.68s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:21<05:38, 42.30s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:04<04:57, 42.47s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:51<04:24, 44.02s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:36<03:40, 44.09s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:16<02:52, 43.10s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [19:57<02:07, 42.41s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:37<01:23, 41.50s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:18<00:41, 41.61s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [21:58<00:00, 40.96s/it]Importing basestationreport data: 100%|██████████| 31/31 [21:58<00:00, 42.53s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.84it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.13it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.25it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.26it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:07,  3.25it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.27it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:06,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:06<00:03,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:08<00:01,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.41it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.34it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  8.13it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  8.11it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.94it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.92it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  8.15it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  8.13it/s]
postgres_copy_csv

2023-05-11 07:22:22 (1683789742) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 5/5) in 1353.158 seconds



2023-05-11 07:22:22 (1683789742) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_update_simple) (function=3/4, repeat=1/1, global 5/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683789758.log
Execution time:  267.0400540828705
execute_postgres_query

2023-05-11 07:27:14 (1683790034) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_update_simple) (function=3/4, repeat=1/1, global 5/5) in 292.918 seconds



2023-05-11 07:27:14 (1683790034) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 5/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683790042.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-11 07:27:29 (1683790049) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 5/5) in 14.762 seconds


2023-05-11 07:27:29 (1683790049) Executed test4 (1/1, global 5/5) in 1668.034 seconds



Running test5 (global 5/5)...

2023-05-11 07:27:29 (1683790049) test started

2023-05-11 07:27:29 (1683790049) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 5/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683790050.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-11 07:27:37 (1683790057) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 5/5) in 7.434 seconds



2023-05-11 07:27:37 (1683790057) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 5/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683790067.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f2b84985e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:35<17:56, 35.87s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:15<18:31, 38.33s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [01:58<18:49, 40.35s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:45<19:18, 42.90s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:30<18:59, 43.84s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:15<18:23, 44.12s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:57<17:21, 43.40s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:41<16:44, 43.68s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:26<16:08, 44.02s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:05<14:54, 42.59s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:47<14:06, 42.34s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:35<13:53, 43.89s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:21<13:23, 44.65s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:07<12:46, 45.07s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:46<11:31, 43.22s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:25<10:26, 41.78s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:02<09:27, 40.53s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:41<08:39, 39.95s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:23<08:07, 40.62s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:10<07:47, 42.48s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:57<07:18, 43.85s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:48<06:54, 46.03s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:26<05:49, 43.75s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:03<04:51, 41.69s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:43<04:06, 41.14s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:25<03:26, 41.38s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:07<02:45, 41.49s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [19:48<02:03, 41.27s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:30<01:23, 41.51s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:19<00:43, 43.90s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:05<00:00, 44.63s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:05<00:00, 42.77s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.95it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.16it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.26it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.21it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:08,  3.21it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.22it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.27it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:05<00:03,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:08<00:01,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.44it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.37it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  8.18it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  8.16it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.82it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.80it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  8.00it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.98it/s]
postgres_copy_csv

2023-05-11 07:50:17 (1683791417) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 5/5) in 1360.587 seconds



2023-05-11 07:50:17 (1683791417) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_update_complex) (function=3/4, repeat=1/1, global 5/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683791434.log
Execution time:  92.01092767715454
execute_postgres_query

2023-05-11 07:52:16 (1683791536) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_update_complex) (function=3/4, repeat=1/1, global 5/5) in 118.520 seconds



2023-05-11 07:52:16 (1683791536) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 5/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683791552.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-11 07:52:38 (1683791558) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 5/5) in 22.489 seconds


2023-05-11 07:52:38 (1683791558) Executed test5 (1/1, global 5/5) in 1509.031 seconds



Running test6 (global 5/5)...

2023-05-11 07:52:38 (1683791558) test started

2023-05-11 07:52:38 (1683791558) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 5/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683791559.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-11 07:52:45 (1683791565) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 5/5) in 7.132 seconds



2023-05-11 07:52:45 (1683791565) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 5/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683791576.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f2b84985e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:04, 36.14s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:13<17:47, 36.82s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [01:57<18:49, 40.34s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:40<18:37, 41.40s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:25<18:27, 42.60s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:07<17:41, 42.47s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:53<17:25, 43.57s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:36<16:35, 43.28s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:17<15:37, 42.61s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [06:59<14:47, 42.24s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:42<14:12, 42.62s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:29<13:55, 43.98s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:15<13:24, 44.69s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [09:58<12:28, 44.01s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:37<11:18, 42.40s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:15<10:16, 41.13s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [11:57<09:40, 41.43s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:44<09:21, 43.19s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:29<08:44, 43.69s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:09<07:48, 42.59s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:50<06:59, 42.00s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:31<06:17, 41.95s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:10<05:27, 40.92s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [16:50<04:44, 40.63s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:40<04:20, 43.41s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:28<03:44, 44.90s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:16<03:02, 45.63s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [20:00<02:15, 45.21s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:39<01:26, 43.45s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:21<00:42, 42.93s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:00<00:00, 41.68s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:00<00:00, 42.58s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.95it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.14it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.27it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:02<00:06,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:04,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:04<00:03,  3.51it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.52it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.51it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:05<00:03,  3.50it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:06<00:01,  3.51it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.51it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.49it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:07<00:01,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.44it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.43it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.79it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.77it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.84it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.82it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.79it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.77it/s]
postgres_copy_csv

2023-05-11 08:15:20 (1683792920) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 5/5) in 1355.030 seconds



2023-05-11 08:15:20 (1683792920) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_single) (function=3/4, repeat=1/1, global 5/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683792930.log
Execution time:  8.25973916053772
execute_postgres_query

2023-05-11 08:16:03 (1683792963) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_single) (function=3/4, repeat=1/1, global 5/5) in 43.014 seconds



2023-05-11 08:16:03 (1683792963) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 5/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683792965.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-11 08:16:11 (1683792971) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 5/5) in 7.396 seconds


2023-05-11 08:16:11 (1683792971) Executed test6 (1/1, global 5/5) in 1412.572 seconds



Running test7 (global 5/5)...

2023-05-11 08:16:11 (1683792971) test started

2023-05-11 08:16:11 (1683792971) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 5/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683792972.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-11 08:16:18 (1683792978) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 5/5) in 7.270 seconds



2023-05-11 08:16:18 (1683792978) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 5/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683792988.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f2b84985e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:00, 36.00s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:13<17:53, 37.02s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [01:58<18:59, 40.69s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:43<19:00, 42.24s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:27<18:35, 42.89s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:09<17:47, 42.71s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:56<17:36, 44.00s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:38<16:37, 43.37s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:19<15:39, 42.69s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:00<14:46, 42.22s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:43<14:09, 42.49s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:35<14:16, 45.10s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:24<13:57, 46.53s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:05<12:41, 44.79s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:43<11:25, 42.85s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:22<10:21, 41.45s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:08<10:00, 42.87s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:51<09:17, 42.86s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:37<08:45, 43.77s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:16<07:47, 42.49s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:57<06:59, 41.98s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:38<06:15, 41.72s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:17<05:27, 40.95s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [16:54<04:37, 39.60s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:37<04:04, 40.75s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:23<03:31, 42.30s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:11<02:56, 44.10s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [20:01<02:17, 45.67s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:48<01:32, 46.23s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:30<00:44, 44.90s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:09<00:00, 43.13s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:09<00:00, 42.88s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:09,  3.04it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.22it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.34it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.36it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.49it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:02<00:05,  3.51it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.51it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.49it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:04,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.49it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.52it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:04<00:03,  3.54it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.56it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.54it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:05<00:03,  3.53it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.50it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.43it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:06<00:02,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:07<00:01,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.48it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.49it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.50it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:08<00:00,  3.53it/s]Importing vessels data: 100%|██████████| 31/31 [00:08<00:00,  3.47it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  8.05it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  8.03it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.95it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.93it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.87it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.85it/s]
postgres_copy_csv

2023-05-11 08:39:02 (1683794342) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 5/5) in 1363.654 seconds



2023-05-11 08:39:02 (1683794342) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_multi) (function=3/4, repeat=1/1, global 5/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683794351.log
Execution time:  142.2966742515564
execute_postgres_query

2023-05-11 08:41:43 (1683794503) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_multi) (function=3/4, repeat=1/1, global 5/5) in 161.198 seconds



2023-05-11 08:41:43 (1683794503) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 5/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683794515.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-11 08:42:01 (1683794521) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 5/5) in 18.088 seconds


2023-05-11 08:42:01 (1683794521) Executed test7 (1/1, global 5/5) in 1550.210 seconds



Running test8 (global 5/5)...

2023-05-11 08:42:01 (1683794521) test started

2023-05-11 08:42:01 (1683794521) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 5/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683794522.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-11 08:42:08 (1683794528) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 5/5) in 6.981 seconds



2023-05-11 08:42:08 (1683794528) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 5/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683794538.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f2b84985e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:35<17:59, 35.97s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:14<18:01, 37.30s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [01:59<19:02, 40.81s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:46<19:35, 43.55s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:31<19:05, 44.07s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:14<18:10, 43.62s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:58<17:28, 43.69s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:37<16:08, 42.10s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:18<15:23, 41.97s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:06<15:19, 43.76s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:53<14:51, 44.57s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:36<13:59, 44.16s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:16<12:53, 42.95s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [09:58<12:03, 42.56s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:41<11:25, 42.84s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:24<10:44, 42.99s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:08<10:05, 43.25s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:50<09:16, 42.78s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:31<08:25, 42.11s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:10<07:34, 41.35s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:51<06:51, 41.19s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:39<06:28, 43.19s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:21<05:43, 42.95s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:03<04:58, 42.65s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:51<04:26, 44.35s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:32<03:36, 43.27s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:15<02:52, 43.01s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [19:55<02:07, 42.38s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:35<01:23, 41.57s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:17<00:41, 41.63s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [21:56<00:00, 40.83s/it]Importing basestationreport data: 100%|██████████| 31/31 [21:56<00:00, 42.46s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:09,  3.02it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:08,  3.25it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:07,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.44it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:02<00:06,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:05,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:03<00:05,  3.45it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.38it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:04,  3.39it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:04<00:04,  3.42it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:04<00:04,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:03,  3.49it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:05<00:03,  3.46it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:05<00:03,  3.47it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:02,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:06<00:02,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:06<00:02,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.41it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.40it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:07<00:01,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:07<00:01,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.33it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:08<00:00,  3.35it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:08<00:00,  3.37it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.34it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.40it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.79it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  7.77it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.80it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.78it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.79it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.77it/s]
postgres_copy_csv

2023-05-11 09:04:41 (1683795881) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 5/5) in 1352.479 seconds



2023-05-11 09:04:41 (1683795881) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_aggregate) (function=3/4, repeat=1/1, global 5/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683795896.log
Execution time:  90.36662197113037
execute_postgres_query

2023-05-11 09:06:36 (1683795996) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_aggregate) (function=3/4, repeat=1/1, global 5/5) in 115.692 seconds



2023-05-11 09:06:36 (1683795996) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 5/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683796019.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-11 09:07:06 (1683796026) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 5/5) in 30.186 seconds


2023-05-11 09:07:06 (1683796026) Executed test8 (1/1, global 5/5) in 1505.337 seconds



Running test9 (global 5/5)...

2023-05-11 09:07:06 (1683796026) test started

2023-05-11 09:07:06 (1683796026) Running capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 5/5) 

Cache cleared, starting create_postgres_tables
/home/tesztek/postgres_create_create_postgres_tables_1683796028.log
Creating table basestationreport...
Table basestationreport created.
Creating table vessels...
Table vessels created.
Creating table maritime_id...
Table maritime_id created.
Creating table vesseltypes...
Table vesseltypes created.
Creating table vesselstatus...
Table vesselstatus created.
Creating function/trigger in vessels...
Successfully created function and trigger.
Successfully created truncate function.
Successfully committed changes.
create_postgres_tables

2023-05-11 09:07:13 (1683796033) Executed capture_pidstat(postgres_functions.create_postgres_tables, logged_functions, csv_collections) (function=1/4, repeat=1/1, global 5/5) in 7.038 seconds



2023-05-11 09:07:13 (1683796033) Running capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 5/5) 

Cache cleared, starting postgres_copy_csv
/home/tesztek/postgres_copy_postgres_copy_csv_1683796044.log
basestationreport {'filepath': '/var/db/csv_store/*_basestationreport.csv.gz', 'convert': {'MMSI': <class 'int'>, 'BaseDateTime': <function <lambda> at 0x7f2b84985e50>, 'LAT': <class 'float'>, 'LON': <class 'float'>, 'SOG': <class 'float'>, 'COG': <class 'float'>, 'Heading': <class 'float'>, 'Status': <class 'int'>, 'Draft': <class 'float'>, 'Cargo': <class 'int'>}, 'fields': ['MMSI', 'BaseDateTime', 'LAT', 'LON', 'SOG', 'COG', 'Heading', 'Status', 'Draft', 'Cargo'], 'unique': None, 'index': 'BaseStationReport'}
['/var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz', '/var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz']
31
Importing basestationreport data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_basestationreport.csv.gz...
Importing basestationreport data:   3%|▎         | 1/31 [00:36<18:09, 36.32s/it]Processing /var/db/csv_store/AIS_2021_01_02_basestationreport.csv.gz...
Importing basestationreport data:   6%|▋         | 2/31 [01:15<18:25, 38.12s/it]Processing /var/db/csv_store/AIS_2021_01_03_basestationreport.csv.gz...
Importing basestationreport data:  10%|▉         | 3/31 [02:01<19:21, 41.47s/it]Processing /var/db/csv_store/AIS_2021_01_04_basestationreport.csv.gz...
Importing basestationreport data:  13%|█▎        | 4/31 [02:42<18:36, 41.34s/it]Processing /var/db/csv_store/AIS_2021_01_05_basestationreport.csv.gz...
Importing basestationreport data:  16%|█▌        | 5/31 [03:25<18:12, 42.02s/it]Processing /var/db/csv_store/AIS_2021_01_06_basestationreport.csv.gz...
Importing basestationreport data:  19%|█▉        | 6/31 [04:12<18:12, 43.71s/it]Processing /var/db/csv_store/AIS_2021_01_07_basestationreport.csv.gz...
Importing basestationreport data:  23%|██▎       | 7/31 [04:57<17:37, 44.08s/it]Processing /var/db/csv_store/AIS_2021_01_08_basestationreport.csv.gz...
Importing basestationreport data:  26%|██▌       | 8/31 [05:39<16:40, 43.50s/it]Processing /var/db/csv_store/AIS_2021_01_09_basestationreport.csv.gz...
Importing basestationreport data:  29%|██▉       | 9/31 [06:22<15:55, 43.44s/it]Processing /var/db/csv_store/AIS_2021_01_10_basestationreport.csv.gz...
Importing basestationreport data:  32%|███▏      | 10/31 [07:02<14:48, 42.33s/it]Processing /var/db/csv_store/AIS_2021_01_11_basestationreport.csv.gz...
Importing basestationreport data:  35%|███▌      | 11/31 [07:43<13:59, 41.95s/it]Processing /var/db/csv_store/AIS_2021_01_12_basestationreport.csv.gz...
Importing basestationreport data:  39%|███▊      | 12/31 [08:29<13:38, 43.07s/it]Processing /var/db/csv_store/AIS_2021_01_13_basestationreport.csv.gz...
Importing basestationreport data:  42%|████▏     | 13/31 [09:18<13:25, 44.78s/it]Processing /var/db/csv_store/AIS_2021_01_14_basestationreport.csv.gz...
Importing basestationreport data:  45%|████▌     | 14/31 [10:04<12:50, 45.33s/it]Processing /var/db/csv_store/AIS_2021_01_15_basestationreport.csv.gz...
Importing basestationreport data:  48%|████▊     | 15/31 [10:44<11:38, 43.63s/it]Processing /var/db/csv_store/AIS_2021_01_16_basestationreport.csv.gz...
Importing basestationreport data:  52%|█████▏    | 16/31 [11:22<10:30, 42.02s/it]Processing /var/db/csv_store/AIS_2021_01_17_basestationreport.csv.gz...
Importing basestationreport data:  55%|█████▍    | 17/31 [12:00<09:29, 40.68s/it]Processing /var/db/csv_store/AIS_2021_01_18_basestationreport.csv.gz...
Importing basestationreport data:  58%|█████▊    | 18/31 [12:38<08:40, 40.04s/it]Processing /var/db/csv_store/AIS_2021_01_19_basestationreport.csv.gz...
Importing basestationreport data:  61%|██████▏   | 19/31 [13:20<08:05, 40.48s/it]Processing /var/db/csv_store/AIS_2021_01_20_basestationreport.csv.gz...
Importing basestationreport data:  65%|██████▍   | 20/31 [14:05<07:41, 41.97s/it]Processing /var/db/csv_store/AIS_2021_01_21_basestationreport.csv.gz...
Importing basestationreport data:  68%|██████▊   | 21/31 [14:52<07:15, 43.51s/it]Processing /var/db/csv_store/AIS_2021_01_22_basestationreport.csv.gz...
Importing basestationreport data:  71%|███████   | 22/31 [15:42<06:47, 45.22s/it]Processing /var/db/csv_store/AIS_2021_01_23_basestationreport.csv.gz...
Importing basestationreport data:  74%|███████▍  | 23/31 [16:23<05:52, 44.03s/it]Processing /var/db/csv_store/AIS_2021_01_24_basestationreport.csv.gz...
Importing basestationreport data:  77%|███████▋  | 24/31 [17:00<04:54, 42.07s/it]Processing /var/db/csv_store/AIS_2021_01_25_basestationreport.csv.gz...
Importing basestationreport data:  81%|████████  | 25/31 [17:40<04:08, 41.36s/it]Processing /var/db/csv_store/AIS_2021_01_26_basestationreport.csv.gz...
Importing basestationreport data:  84%|████████▍ | 26/31 [18:21<03:26, 41.23s/it]Processing /var/db/csv_store/AIS_2021_01_27_basestationreport.csv.gz...
Importing basestationreport data:  87%|████████▋ | 27/31 [19:03<02:45, 41.44s/it]Processing /var/db/csv_store/AIS_2021_01_28_basestationreport.csv.gz...
Importing basestationreport data:  90%|█████████ | 28/31 [19:44<02:03, 41.22s/it]Processing /var/db/csv_store/AIS_2021_01_29_basestationreport.csv.gz...
Importing basestationreport data:  94%|█████████▎| 29/31 [20:25<01:22, 41.20s/it]Processing /var/db/csv_store/AIS_2021_01_30_basestationreport.csv.gz...
Importing basestationreport data:  97%|█████████▋| 30/31 [21:15<00:43, 44.00s/it]Processing /var/db/csv_store/AIS_2021_01_31_basestationreport.csv.gz...
Importing basestationreport data: 100%|██████████| 31/31 [22:04<00:00, 45.26s/it]Importing basestationreport data: 100%|██████████| 31/31 [22:04<00:00, 42.71s/it]
vessels {'filepath': '/var/db/csv_store/*_vessels.csv.gz', 'convert': {'MMSI': <class 'int'>, 'VesselType': <class 'int'>, 'Length': <class 'int'>, 'Width': <class 'int'>}, 'fields': ['MMSI', 'VesselName', 'IMO', 'CallSign', 'VesselType', 'Length', 'Width', 'TranscieverClass'], 'unique': 'MMSI'}
['/var/db/csv_store/AIS_2021_01_01_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_02_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_03_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_04_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_05_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_06_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_07_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_08_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_09_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_10_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_11_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_12_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_13_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_14_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_15_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_16_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_17_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_18_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_19_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_20_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_21_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_22_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_23_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_24_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_25_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_26_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_27_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_28_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_29_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_30_vessels.csv.gz', '/var/db/csv_store/AIS_2021_01_31_vessels.csv.gz']
31
Importing vessels data:   0%|          | 0/31 [00:00<?, ?it/s]Processing /var/db/csv_store/AIS_2021_01_01_vessels.csv.gz...
Importing vessels data:   3%|▎         | 1/31 [00:00<00:10,  2.82it/s]Processing /var/db/csv_store/AIS_2021_01_02_vessels.csv.gz...
Importing vessels data:   6%|▋         | 2/31 [00:00<00:09,  3.06it/s]Processing /var/db/csv_store/AIS_2021_01_03_vessels.csv.gz...
Importing vessels data:  10%|▉         | 3/31 [00:00<00:08,  3.21it/s]Processing /var/db/csv_store/AIS_2021_01_04_vessels.csv.gz...
Importing vessels data:  13%|█▎        | 4/31 [00:01<00:08,  3.26it/s]Processing /var/db/csv_store/AIS_2021_01_05_vessels.csv.gz...
Importing vessels data:  16%|█▌        | 5/31 [00:01<00:07,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_06_vessels.csv.gz...
Importing vessels data:  19%|█▉        | 6/31 [00:01<00:07,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_07_vessels.csv.gz...
Importing vessels data:  23%|██▎       | 7/31 [00:02<00:07,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_08_vessels.csv.gz...
Importing vessels data:  26%|██▌       | 8/31 [00:02<00:06,  3.32it/s]Processing /var/db/csv_store/AIS_2021_01_09_vessels.csv.gz...
Importing vessels data:  29%|██▉       | 9/31 [00:02<00:06,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_10_vessels.csv.gz...
Importing vessels data:  32%|███▏      | 10/31 [00:03<00:06,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_11_vessels.csv.gz...
Importing vessels data:  35%|███▌      | 11/31 [00:03<00:06,  3.30it/s]Processing /var/db/csv_store/AIS_2021_01_12_vessels.csv.gz...
Importing vessels data:  39%|███▊      | 12/31 [00:03<00:05,  3.28it/s]Processing /var/db/csv_store/AIS_2021_01_13_vessels.csv.gz...
Importing vessels data:  42%|████▏     | 13/31 [00:04<00:05,  3.12it/s]Processing /var/db/csv_store/AIS_2021_01_14_vessels.csv.gz...
Importing vessels data:  45%|████▌     | 14/31 [00:04<00:05,  3.01it/s]Processing /var/db/csv_store/AIS_2021_01_15_vessels.csv.gz...
Importing vessels data:  48%|████▊     | 15/31 [00:04<00:05,  2.96it/s]Processing /var/db/csv_store/AIS_2021_01_16_vessels.csv.gz...
Importing vessels data:  52%|█████▏    | 16/31 [00:05<00:05,  2.84it/s]Processing /var/db/csv_store/AIS_2021_01_17_vessels.csv.gz...
Importing vessels data:  55%|█████▍    | 17/31 [00:05<00:04,  2.84it/s]Processing /var/db/csv_store/AIS_2021_01_18_vessels.csv.gz...
Importing vessels data:  58%|█████▊    | 18/31 [00:05<00:04,  2.86it/s]Processing /var/db/csv_store/AIS_2021_01_19_vessels.csv.gz...
Importing vessels data:  61%|██████▏   | 19/31 [00:06<00:03,  3.01it/s]Processing /var/db/csv_store/AIS_2021_01_20_vessels.csv.gz...
Importing vessels data:  65%|██████▍   | 20/31 [00:06<00:03,  3.07it/s]Processing /var/db/csv_store/AIS_2021_01_21_vessels.csv.gz...
Importing vessels data:  68%|██████▊   | 21/31 [00:06<00:03,  3.09it/s]Processing /var/db/csv_store/AIS_2021_01_22_vessels.csv.gz...
Importing vessels data:  71%|███████   | 22/31 [00:07<00:02,  3.09it/s]Processing /var/db/csv_store/AIS_2021_01_23_vessels.csv.gz...
Importing vessels data:  74%|███████▍  | 23/31 [00:07<00:02,  3.12it/s]Processing /var/db/csv_store/AIS_2021_01_24_vessels.csv.gz...
Importing vessels data:  77%|███████▋  | 24/31 [00:07<00:02,  3.20it/s]Processing /var/db/csv_store/AIS_2021_01_25_vessels.csv.gz...
Importing vessels data:  81%|████████  | 25/31 [00:07<00:01,  3.24it/s]Processing /var/db/csv_store/AIS_2021_01_26_vessels.csv.gz...
Importing vessels data:  84%|████████▍ | 26/31 [00:08<00:01,  3.23it/s]Processing /var/db/csv_store/AIS_2021_01_27_vessels.csv.gz...
Importing vessels data:  87%|████████▋ | 27/31 [00:08<00:01,  3.25it/s]Processing /var/db/csv_store/AIS_2021_01_28_vessels.csv.gz...
Importing vessels data:  90%|█████████ | 28/31 [00:08<00:00,  3.29it/s]Processing /var/db/csv_store/AIS_2021_01_29_vessels.csv.gz...
Importing vessels data:  94%|█████████▎| 29/31 [00:09<00:00,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_30_vessels.csv.gz...
Importing vessels data:  97%|█████████▋| 30/31 [00:09<00:00,  3.31it/s]Processing /var/db/csv_store/AIS_2021_01_31_vessels.csv.gz...
Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.35it/s]Importing vessels data: 100%|██████████| 31/31 [00:09<00:00,  3.17it/s]
vesselstatus {'filepath': '/home/ubuntu/adatbazis/vesselstatus.csv.gz', 'convert': {'status': <class 'int'>}, 'fields': ['status', 'text'], 'unique': 'status'}
['/home/ubuntu/adatbazis/vesselstatus.csv.gz']
1
Importing vesselstatus data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesselstatus.csv.gz...
Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  8.04it/s]Importing vesselstatus data: 100%|██████████| 1/1 [00:00<00:00,  8.01it/s]
vesseltypes {'filepath': '/home/ubuntu/adatbazis/vesseltypes.csv.gz', 'convert': {'type': <class 'int'>}, 'fields': ['type', 'text'], 'unique': 'type'}
['/home/ubuntu/adatbazis/vesseltypes.csv.gz']
1
Importing vesseltypes data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/vesseltypes.csv.gz...
Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.95it/s]Importing vesseltypes data: 100%|██████████| 1/1 [00:00<00:00,  7.93it/s]
maritime_id {'filepath': '/home/ubuntu/adatbazis/maritime_id.csv.gz', 'convert': {'mid': <class 'int'>}, 'fields': ['mid', 'country', 'code'], 'unique': 'mid'}
['/home/ubuntu/adatbazis/maritime_id.csv.gz']
1
Importing maritime_id data:   0%|          | 0/1 [00:00<?, ?it/s]Processing /home/ubuntu/adatbazis/maritime_id.csv.gz...
Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.99it/s]Importing maritime_id data: 100%|██████████| 1/1 [00:00<00:00,  7.97it/s]
postgres_copy_csv

2023-05-11 09:29:53 (1683797393) Executed capture_pidstat(postgres_functions.postgres_copy_csv, logged_functions,csv_collections) (function=2/4, repeat=1/1, global 5/5) in 1359.481 seconds



2023-05-11 09:29:53 (1683797393) Running capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_conditions) (function=3/4, repeat=1/1, global 5/5) 

Cache cleared, starting execute_postgres_query
/home/tesztek/postgres_exec_query_execute_postgres_query_1683797407.log
Execution time:  222.98251676559448
execute_postgres_query

2023-05-11 09:34:00 (1683797640) Executed capture_pidstat(postgres_functions.execute_postgres_query,logged_functions,csv_collections,postgres_functions.postgres_query_conditions) (function=3/4, repeat=1/1, global 5/5) in 247.272 seconds



2023-05-11 09:34:00 (1683797640) Running capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 5/5) 

Cache cleared, starting drop_postgres_database
/home/tesztek/postgres_drop_drop_postgres_database_1683797644.log
The ais_data database has been successfully dropped.
drop_postgres_database

2023-05-11 09:34:10 (1683797650) Executed capture_pidstat(postgres_functions.drop_postgres_database, logged_functions, csv_collections) (function=4/4, repeat=1/1, global 5/5) in 9.692 seconds


2023-05-11 09:34:10 (1683797650) Executed test9 (1/1, global 5/5) in 1623.483 seconds



2023-05-11 09:34:10 (1683797650) Executed script in 73777.839 seconds
